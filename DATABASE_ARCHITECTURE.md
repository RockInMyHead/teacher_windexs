# ğŸ—ï¸ Database Architecture

## ĞŸÑ€Ğ¾Ñ„ĞµÑÑĞ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ğ°Ñ Ğ°Ñ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ° Ğ±Ğ°Ğ·Ñ‹ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ… Ğ´Ğ»Ñ Ğ¿Ğ»Ğ°Ñ‚Ñ„Ğ¾Ñ€Ğ¼Ñ‹ Teacher AI

---

## ğŸ“Š Ğ”Ğ¸Ğ°Ğ³Ñ€Ğ°Ğ¼Ğ¼Ğ° ER (Entity-Relationship)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           AUTHENTICATION & USERS                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     users        â”‚          â”‚  user_preferences    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤          â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ id (UUID) PK   â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚ â€¢ id (UUID) PK       â”‚
â”‚   email          â”‚   1:1    â”‚   user_id FK         â”‚
â”‚   username       â”‚          â”‚   theme              â”‚
â”‚   password_hash  â”‚          â”‚   language           â”‚
â”‚   full_name      â”‚          â”‚   tts_voice          â”‚
â”‚   avatar_url     â”‚          â”‚   tts_speed          â”‚
â”‚   role           â”‚          â”‚   other_settings     â”‚
â”‚   total_points   â”‚          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚   level          â”‚
â”‚   streak_days    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        COURSES & LEARNING CONTENT                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    courses       â”‚          â”‚      lessons         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤          â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ id (UUID) PK   â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚ â€¢ id (UUID) PK       â”‚
â”‚   title          â”‚   1:N    â”‚   course_id FK       â”‚
â”‚   description    â”‚          â”‚   lesson_number      â”‚
â”‚   subject        â”‚          â”‚   title              â”‚
â”‚   grade          â”‚          â”‚   topic              â”‚
â”‚   exam_type      â”‚          â”‚   description        â”‚
â”‚   difficulty     â”‚          â”‚   content            â”‚
â”‚   total_lessons  â”‚          â”‚   key_concepts JSONB â”‚
â”‚   estimated_hrs  â”‚          â”‚   homework JSONB     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          USER PROGRESS TRACKING                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                        â”‚   user_courses       â”‚
     users              â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤        courses
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚ â€¢ id (UUID) PK       â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ id           â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”‚   user_id FK         â”‚â”€â”€â”€â”€â”‚ id           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  1:N   â”‚   course_id FK       â”‚ N:1â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚   enrolled_at        â”‚
                        â”‚   current_lesson_num â”‚
                        â”‚   completed_lessons  â”‚
                        â”‚   progress_%         â”‚
                        â”‚   status             â”‚
                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                  â”‚
                                  â”‚ 1:N
                                  â–¼
                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                        â”‚   user_lessons       â”‚
                        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤        lessons
                        â”‚ â€¢ id (UUID) PK       â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                        â”‚   user_id FK         â”‚â”€â”€â”€â”€â”‚ id           â”‚
                        â”‚   lesson_id FK       â”‚ N:1â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚   user_course_id FK  â”‚
                        â”‚   status             â”‚
                        â”‚   score              â”‚
                        â”‚   time_spent_min     â”‚
                        â”‚   homework_submitted â”‚
                        â”‚   homework_content   â”‚
                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         AI LEARNING PLANS                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    users           â”‚    learning_plans        â”‚        courses
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ id       â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”‚ â€¢ id (UUID) PK           â”‚â”€â”€â”€â”€â”‚ id       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  1:N   â”‚   user_id FK             â”‚ N:1â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚   course_id FK           â”‚
                    â”‚   plan_data JSONB        â”‚
                    â”‚   lessons_structure JSONBâ”‚
                    â”‚   generated_at           â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         CHAT & MESSAGING SYSTEM                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    users           â”‚    chat_sessions         â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id       â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”‚ â€¢ id (UUID) PK           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  1:N   â”‚   user_id FK             â”‚
                    â”‚   course_id FK (optional)â”‚
                    â”‚   lesson_id FK (optional)â”‚
    courses         â”‚   session_type           â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚   started_at             â”‚
â”‚ id       â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”‚   ended_at               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  1:N   â”‚   duration_minutes       â”‚
                    â”‚   context_data JSONB     â”‚
    lessons         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚
â”‚ id       â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  1:N                â”‚ 1:N
                                 â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚    chat_messages         â”‚
                    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
                    â”‚ â€¢ id (UUID) PK           â”‚
                    â”‚   session_id FK          â”‚
                    â”‚   role                   â”‚
                    â”‚   content                â”‚
                    â”‚   tts_played             â”‚
                    â”‚   tts_audio_url          â”‚
                    â”‚   created_at             â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          EXAM PREPARATION                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    users           â”‚    exam_courses          â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id       â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”‚ â€¢ id (UUID) PK           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  1:N   â”‚   user_id FK             â”‚
                    â”‚   exam_type (Ğ•Ğ“Ğ­/ĞĞ“Ğ­)    â”‚
                    â”‚   subject                â”‚
                    â”‚   progress_%             â”‚
                    â”‚   topics_completed       â”‚
                    â”‚   total_topics           â”‚
                    â”‚   last_studied_at        â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      GAMIFICATION & ACHIEVEMENTS                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  achievements    â”‚          â”‚ user_achievements    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤          â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤      users
â”‚ â€¢ id (UUID) PK   â”‚          â”‚ â€¢ id (UUID) PK       â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   name           â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚   user_id FK         â”‚â”€â”€â”‚ id       â”‚
â”‚   title          â”‚   1:N    â”‚   achievement_id FK  â”‚1:Nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚   description    â”‚          â”‚   unlocked_at        â”‚
â”‚   icon_name      â”‚          â”‚   seen               â”‚
â”‚   criteria_type  â”‚          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚   criteria_value â”‚
â”‚   points_reward  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                             ANALYTICS                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    users           â”‚  user_activity_log       â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id       â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”‚ â€¢ id (UUID) PK           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  1:N   â”‚   user_id FK             â”‚
                    â”‚   activity_type          â”‚
                    â”‚   activity_data JSONB    â”‚
                    â”‚   course_id FK (opt)     â”‚
                    â”‚   lesson_id FK (opt)     â”‚
                    â”‚   created_at             â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”‘ Key Design Principles

### 1. **ĞĞ¾Ñ€Ğ¼Ğ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…**
- Ğ’ÑĞµ Ñ‚Ğ°Ğ±Ğ»Ğ¸Ñ†Ñ‹ Ğ² 3NF (Ñ‚Ñ€ĞµÑ‚ÑŒĞµĞ¹ Ğ½Ğ¾Ñ€Ğ¼Ğ°Ğ»ÑŒĞ½Ğ¾Ğ¹ Ñ„Ğ¾Ñ€Ğ¼Ğµ)
- ĞœĞ¸Ğ½Ğ¸Ğ¼Ğ°Ğ»ÑŒĞ½Ğ°Ñ Ğ¸Ğ·Ğ±Ñ‹Ñ‚Ğ¾Ñ‡Ğ½Ğ¾ÑÑ‚ÑŒ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…
- Ğ§ĞµÑ‚ĞºĞ¸Ğµ ÑĞ²ÑĞ·Ğ¸ Ñ‡ĞµÑ€ĞµĞ· Foreign Keys

### 2. **ĞœĞ°ÑÑˆÑ‚Ğ°Ğ±Ğ¸Ñ€ÑƒĞµĞ¼Ğ¾ÑÑ‚ÑŒ**
- UUID Ğ¿ĞµÑ€Ğ²Ğ¸Ñ‡Ğ½Ñ‹Ğµ ĞºĞ»ÑÑ‡Ğ¸ Ğ´Ğ»Ñ Ñ€Ğ°ÑĞ¿Ñ€ĞµĞ´ĞµĞ»ĞµĞ½Ğ½Ñ‹Ñ… ÑĞ¸ÑÑ‚ĞµĞ¼
- Ğ˜Ğ½Ğ´ĞµĞºÑÑ‹ Ğ½Ğ° Ğ²ÑĞµÑ… Ñ‡Ğ°ÑÑ‚Ğ¾ Ğ·Ğ°Ğ¿Ñ€Ğ°ÑˆĞ¸Ğ²Ğ°ĞµĞ¼Ñ‹Ñ… Ğ¿Ğ¾Ğ»ÑÑ…
- JSONB Ğ´Ğ»Ñ Ğ³Ğ¸Ğ±ĞºĞ¸Ñ… Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…

### 3. **Ğ¦ĞµĞ»Ğ¾ÑÑ‚Ğ½Ğ¾ÑÑ‚ÑŒ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…**
- Foreign Key constraints
- CHECK constraints Ğ´Ğ»Ñ Ğ²Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ğ¸
- Triggers Ğ´Ğ»Ñ Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ñ… Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ğ¹
- CASCADE DELETE Ğ³Ğ´Ğµ Ğ½ĞµĞ¾Ğ±Ñ…Ğ¾Ğ´Ğ¸Ğ¼Ğ¾

### 4. **ĞŸÑ€Ğ¾Ğ¸Ğ·Ğ²Ğ¾Ğ´Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ**
- Composite indexes Ğ´Ğ»Ñ ÑĞ»Ğ¾Ğ¶Ğ½Ñ‹Ñ… Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ¾Ğ²
- GIN indexes Ğ´Ğ»Ñ JSONB Ğ¿Ğ¾Ğ»ĞµĞ¹
- Connection pooling
- Prepared statements

### 5. **Ğ‘ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ğ¾ÑÑ‚ÑŒ**
- Password hashing (bcrypt)
- Prepared statements (Ğ·Ğ°Ñ‰Ğ¸Ñ‚Ğ° Ğ¾Ñ‚ SQL injection)
- Role-based access control
- Timestamps Ğ´Ğ»Ñ audit trail

---

## ğŸ“‹ Table Descriptions

### Core Tables

#### `users`
**ĞĞ°Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµ**: Ğ¦ĞµĞ½Ñ‚Ñ€Ğ°Ğ»ÑŒĞ½Ğ°Ñ Ñ‚Ğ°Ğ±Ğ»Ğ¸Ñ†Ğ° Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ĞµĞ¹ Ñ Ğ°ÑƒÑ‚ĞµĞ½Ñ‚Ğ¸Ñ„Ğ¸ĞºĞ°Ñ†Ğ¸ĞµĞ¹ Ğ¸ ÑÑ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºĞ¾Ğ¹

**ĞšĞ»ÑÑ‡ĞµĞ²Ñ‹Ğµ Ğ¿Ğ¾Ğ»Ñ**:
- `id` - UUID Ğ¿ĞµÑ€Ğ²Ğ¸Ñ‡Ğ½Ñ‹Ğ¹ ĞºĞ»ÑÑ‡
- `email` - Ğ£Ğ½Ğ¸ĞºĞ°Ğ»ÑŒĞ½Ñ‹Ğ¹ email
- `password_hash` - Ğ¥ÑÑˆ Ğ¿Ğ°Ñ€Ğ¾Ğ»Ñ (bcrypt)
- `total_lessons_completed` - Ğ’ÑĞµĞ³Ğ¾ Ğ·Ğ°Ğ²ĞµÑ€ÑˆĞµĞ½Ğ½Ñ‹Ñ… ÑƒÑ€Ğ¾ĞºĞ¾Ğ²
- `current_streak_days` - Ğ¢ĞµĞºÑƒÑ‰Ğ°Ñ ÑĞµÑ€Ğ¸Ñ Ğ´Ğ½ĞµĞ¹ Ğ¾Ğ±ÑƒÑ‡ĞµĞ½Ğ¸Ñ
- `total_points` - ĞĞ°ĞºĞ¾Ğ¿Ğ»ĞµĞ½Ğ½Ñ‹Ğµ Ğ¾Ñ‡ĞºĞ¸
- `level` - Ğ£Ñ€Ğ¾Ğ²ĞµĞ½ÑŒ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ

**Ğ˜Ğ½Ğ´ĞµĞºÑÑ‹**:
- PRIMARY KEY Ğ½Ğ° `id`
- UNIQUE Ğ½Ğ° `email`, `username`
- INDEX Ğ½Ğ° `created_at`

---

#### `courses`
**ĞĞ°Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµ**: ĞšĞ°Ñ‚Ğ°Ğ»Ğ¾Ğ³ Ğ²ÑĞµÑ… ĞºÑƒÑ€ÑĞ¾Ğ² (ÑˆĞºĞ¾Ğ»ÑŒĞ½Ñ‹Ğµ + ÑĞºĞ·Ğ°Ğ¼ĞµĞ½Ğ°Ñ†Ğ¸Ğ¾Ğ½Ğ½Ñ‹Ğµ)

**ĞšĞ»ÑÑ‡ĞµĞ²Ñ‹Ğµ Ğ¿Ğ¾Ğ»Ñ**:
- `id` - UUID Ğ¿ĞµÑ€Ğ²Ğ¸Ñ‡Ğ½Ñ‹Ğ¹ ĞºĞ»ÑÑ‡
- `subject` - ĞŸÑ€ĞµĞ´Ğ¼ĞµÑ‚ (physics, math, biology, etc.)
- `grade` - ĞšĞ»Ğ°ÑÑ (1-11) Ğ¸Ğ»Ğ¸ NULL Ğ´Ğ»Ñ ÑĞºĞ·Ğ°Ğ¼ĞµĞ½Ğ¾Ğ²
- `exam_type` - 'Ğ•Ğ“Ğ­', 'ĞĞ“Ğ­', NULL
- `difficulty_level` - easy/medium/hard
- `total_lessons` - ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸ Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ»ÑĞµÑ‚ÑÑ

**Ğ˜Ğ½Ğ´ĞµĞºÑÑ‹**:
- PRIMARY KEY Ğ½Ğ° `id`
- INDEX Ğ½Ğ° `subject`, `grade`, `exam_type`

---

#### `lessons`
**ĞĞ°Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµ**: Ğ¡Ğ¾Ğ´ĞµÑ€Ğ¶Ğ¸Ğ¼Ğ¾Ğµ ÑƒÑ€Ğ¾ĞºĞ¾Ğ² Ñ ÑÑ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ğ¼Ğ¸ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğ¼Ğ¸

**ĞšĞ»ÑÑ‡ĞµĞ²Ñ‹Ğµ Ğ¿Ğ¾Ğ»Ñ**:
- `id` - UUID Ğ¿ĞµÑ€Ğ²Ğ¸Ñ‡Ğ½Ñ‹Ğ¹ ĞºĞ»ÑÑ‡
- `course_id` - FK Ğº courses
- `lesson_number` - ĞŸĞ¾Ñ€ÑĞ´ĞºĞ¾Ğ²Ñ‹Ğ¹ Ğ½Ğ¾Ğ¼ĞµÑ€ ÑƒÑ€Ğ¾ĞºĞ°
- `learning_objectives` - JSONB Ğ¼Ğ°ÑÑĞ¸Ğ² Ñ†ĞµĞ»ĞµĞ¹
- `key_concepts` - JSONB Ğ¼Ğ°ÑÑĞ¸Ğ² ĞºĞ»ÑÑ‡ĞµĞ²Ñ‹Ñ… Ğ¿Ğ¾Ğ½ÑÑ‚Ğ¸Ğ¹
- `practice_exercises` - JSONB Ğ¼Ğ°ÑÑĞ¸Ğ² ÑƒĞ¿Ñ€Ğ°Ğ¶Ğ½ĞµĞ½Ğ¸Ğ¹
- `homework` - JSONB Ğ´Ğ¾Ğ¼Ğ°ÑˆĞ½Ğ¸Ğµ Ğ·Ğ°Ğ´Ğ°Ğ½Ğ¸Ñ

**Ğ˜Ğ½Ğ´ĞµĞºÑÑ‹**:
- PRIMARY KEY Ğ½Ğ° `id`
- UNIQUE Ğ½Ğ° `(course_id, lesson_number)`
- INDEX Ğ½Ğ° `course_id`
- GIN Ğ½Ğ° JSONB Ğ¿Ğ¾Ğ»Ñ

---

#### `user_courses`
**ĞĞ°Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµ**: ĞŸĞ¾Ğ´Ğ¿Ğ¸ÑĞºĞ¸ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ĞµĞ¹ Ğ½Ğ° ĞºÑƒÑ€ÑÑ‹ Ñ Ğ¿Ñ€Ğ¾Ğ³Ñ€ĞµÑÑĞ¾Ğ¼

**ĞšĞ»ÑÑ‡ĞµĞ²Ñ‹Ğµ Ğ¿Ğ¾Ğ»Ñ**:
- `user_id` - FK Ğº users
- `course_id` - FK Ğº courses
- `current_lesson_number` - Ğ¢ĞµĞºÑƒÑ‰Ğ¸Ğ¹ ÑƒÑ€Ğ¾Ğº
- `progress_percentage` - ĞŸÑ€Ğ¾Ñ†ĞµĞ½Ñ‚ Ğ·Ğ°Ğ²ĞµÑ€ÑˆĞµĞ½Ğ¸Ñ (0-100)
- `status` - active/completed/paused/dropped
- `total_study_time_minutes` - ĞĞ±Ñ‰ĞµĞµ Ğ²Ñ€ĞµĞ¼Ñ Ğ¾Ğ±ÑƒÑ‡ĞµĞ½Ğ¸Ñ

**Ğ˜Ğ½Ğ´ĞµĞºÑÑ‹**:
- PRIMARY KEY Ğ½Ğ° `id`
- UNIQUE Ğ½Ğ° `(user_id, course_id)`
- INDEX Ğ½Ğ° `user_id`, `course_id`, `status`
- COMPOSITE INDEX Ğ½Ğ° `(user_id, status)`

---

#### `user_lessons`
**ĞĞ°Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµ**: Ğ”ĞµÑ‚Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¹ Ğ¿Ñ€Ğ¾Ğ³Ñ€ĞµÑÑ Ğ¿Ğ¾ ĞºĞ°Ğ¶Ğ´Ğ¾Ğ¼Ñƒ ÑƒÑ€Ğ¾ĞºÑƒ

**ĞšĞ»ÑÑ‡ĞµĞ²Ñ‹Ğµ Ğ¿Ğ¾Ğ»Ñ**:
- `user_id` - FK Ğº users
- `lesson_id` - FK Ğº lessons
- `user_course_id` - FK Ğº user_courses
- `status` - not_started/in_progress/completed/reviewed
- `score` - ĞÑ†ĞµĞ½ĞºĞ° (0-100)
- `time_spent_minutes` - Ğ’Ñ€ĞµĞ¼Ñ Ğ½Ğ° ÑƒÑ€Ğ¾Ğº
- `homework_submitted` - Ğ¡Ğ´Ğ°Ğ½Ğ¾ Ğ»Ğ¸ Ğ”Ğ—
- `homework_content` - JSONB ĞºĞ¾Ğ½Ñ‚ĞµĞ½Ñ‚ Ğ”Ğ—
- `homework_feedback` - JSONB Ğ¾Ğ±Ñ€Ğ°Ñ‚Ğ½Ğ°Ñ ÑĞ²ÑĞ·ÑŒ

**Ğ˜Ğ½Ğ´ĞµĞºÑÑ‹**:
- PRIMARY KEY Ğ½Ğ° `id`
- UNIQUE Ğ½Ğ° `(user_id, lesson_id)`
- INDEX Ğ½Ğ° `user_id`, `lesson_id`, `status`

---

#### `learning_plans`
**ĞĞ°Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµ**: AI-Ğ³ĞµĞ½ĞµÑ€Ğ¸Ñ€ÑƒĞµĞ¼Ñ‹Ğµ Ğ¿ĞµÑ€ÑĞ¾Ğ½Ğ°Ğ»Ğ¸Ğ·Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ¿Ğ»Ğ°Ğ½Ñ‹ Ğ¾Ğ±ÑƒÑ‡ĞµĞ½Ğ¸Ñ

**ĞšĞ»ÑÑ‡ĞµĞ²Ñ‹Ğµ Ğ¿Ğ¾Ğ»Ñ**:
- `plan_data` - JSONB Ğ¿Ğ¾Ğ»Ğ½Ñ‹Ğ¹ Ğ¿Ğ»Ğ°Ğ½ Ğ¾Ñ‚ AI
- `lessons_structure` - JSONB ÑÑ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ° ÑƒÑ€Ğ¾ĞºĞ¾Ğ²
- `generated_at` - Ğ”Ğ°Ñ‚Ğ° Ğ³ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ğ¸
- `last_updated_at` - ĞŸĞ¾ÑĞ»ĞµĞ´Ğ½ĞµĞµ Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ğµ

**Ğ˜Ğ½Ğ´ĞµĞºÑÑ‹**:
- PRIMARY KEY Ğ½Ğ° `id`
- UNIQUE Ğ½Ğ° `(user_id, course_id)`
- GIN Ğ½Ğ° `plan_data`

---

#### `chat_sessions`
**ĞĞ°Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµ**: Ğ¡ĞµÑÑĞ¸Ğ¸ Ñ‡Ğ°Ñ‚Ğ° Ñ AI ÑƒÑ‡Ğ¸Ñ‚ĞµĞ»ĞµĞ¼

**ĞšĞ»ÑÑ‡ĞµĞ²Ñ‹Ğµ Ğ¿Ğ¾Ğ»Ñ**:
- `session_type` - lesson/interactive/voice/exam_prep
- `started_at` - Ğ’Ñ€ĞµĞ¼Ñ Ğ½Ğ°Ñ‡Ğ°Ğ»Ğ°
- `ended_at` - Ğ’Ñ€ĞµĞ¼Ñ Ğ¾ĞºĞ¾Ğ½Ñ‡Ğ°Ğ½Ğ¸Ñ
- `duration_minutes` - Ğ”Ğ»Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ
- `context_data` - JSONB ĞºĞ¾Ğ½Ñ‚ĞµĞºÑÑ‚ ÑĞµÑÑĞ¸Ğ¸

**Ğ˜Ğ½Ğ´ĞµĞºÑÑ‹**:
- PRIMARY KEY Ğ½Ğ° `id`
- INDEX Ğ½Ğ° `user_id`, `course_id`, `started_at`
- GIN Ğ½Ğ° `context_data`

---

#### `chat_messages`
**ĞĞ°Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµ**: Ğ¡Ğ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ñ Ğ² Ñ‡Ğ°Ñ‚-ÑĞµÑÑĞ¸ÑÑ…

**ĞšĞ»ÑÑ‡ĞµĞ²Ñ‹Ğµ Ğ¿Ğ¾Ğ»Ñ**:
- `session_id` - FK Ğº chat_sessions
- `role` - user/assistant/system
- `content` - Ğ¢ĞµĞºÑÑ‚ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ñ
- `tts_played` - ĞŸÑ€Ğ¾Ğ¸Ğ³Ñ€Ğ°Ğ½Ğ¾ Ğ»Ğ¸ TTS
- `tts_audio_url` - URL Ğ°ÑƒĞ´Ğ¸Ğ¾ Ñ„Ğ°Ğ¹Ğ»Ğ°

**Ğ˜Ğ½Ğ´ĞµĞºÑÑ‹**:
- PRIMARY KEY Ğ½Ğ° `id`
- INDEX Ğ½Ğ° `session_id`
- COMPOSITE INDEX Ğ½Ğ° `(session_id, created_at DESC)`

---

#### `exam_courses`
**ĞĞ°Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµ**: ĞšÑƒÑ€ÑÑ‹ Ğ¿Ğ¾Ğ´Ğ³Ğ¾Ñ‚Ğ¾Ğ²ĞºĞ¸ Ğº ÑĞºĞ·Ğ°Ğ¼ĞµĞ½Ğ°Ğ¼ (Ğ•Ğ“Ğ­/ĞĞ“Ğ­)

**ĞšĞ»ÑÑ‡ĞµĞ²Ñ‹Ğµ Ğ¿Ğ¾Ğ»Ñ**:
- `exam_type` - 'Ğ•Ğ“Ğ­' Ğ¸Ğ»Ğ¸ 'ĞĞ“Ğ­'
- `subject` - ĞŸÑ€ĞµĞ´Ğ¼ĞµÑ‚ ÑĞºĞ·Ğ°Ğ¼ĞµĞ½Ğ°
- `progress_percentage` - ĞŸÑ€Ğ¾Ğ³Ñ€ĞµÑÑ Ğ¿Ğ¾Ğ´Ğ³Ğ¾Ñ‚Ğ¾Ğ²ĞºĞ¸
- `topics_completed` - Ğ—Ğ°Ğ²ĞµÑ€ÑˆĞµĞ½Ğ½Ñ‹Ğµ Ñ‚ĞµĞ¼Ñ‹
- `total_topics` - Ğ’ÑĞµĞ³Ğ¾ Ñ‚ĞµĞ¼ (Ğ¾Ğ±Ñ‹Ñ‡Ğ½Ğ¾ 50)

**Ğ˜Ğ½Ğ´ĞµĞºÑÑ‹**:
- PRIMARY KEY Ğ½Ğ° `id`
- UNIQUE Ğ½Ğ° `(user_id, exam_type, subject)`
- INDEX Ğ½Ğ° `user_id`, `exam_type`

---

## ğŸ”„ Data Flow Examples

### 1. Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Ğ½Ğ¾Ğ²Ğ¾Ğ³Ğ¾ ÑƒÑ€Ğ¾ĞºĞ°
```
User opens course
      â†“
CourseDetail.tsx loads course data
      â†“
courseService.getCourse(courseId)
      â†“
GET /api/courses/:courseId
      â†“
Database: SELECT * FROM courses JOIN lessons
      â†“
Return course with lessons array
```

### 2. ĞĞ°Ñ‡Ğ°Ğ»Ğ¾ Ñ‡Ğ°Ñ‚-ÑĞµÑÑĞ¸Ğ¸
```
User clicks "ĞĞ°Ñ‡Ğ°Ñ‚ÑŒ Ñ‡Ğ°Ñ‚"
      â†“
Chat.tsx creates session
      â†“
chatService.createSession({userId, courseId})
      â†“
POST /api/chat/sessions
      â†“
Database: INSERT INTO chat_sessions
      â†“
Store sessionId in localStorage
      â†“
User sends message
      â†“
chatService.addMessage({sessionId, role, content})
      â†“
POST /api/chat/messages
      â†“
Database: INSERT INTO chat_messages
```

### 3. ĞĞ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ğ¿Ñ€Ğ¾Ğ³Ñ€ĞµÑÑĞ°
```
User completes lesson
      â†“
learningPlanService.saveLessonProgress()
      â†“
POST /api/learning-plans/lessons/progress
      â†“
Database: 
  - INSERT/UPDATE user_lessons
  - UPDATE user_courses (increment completed_lessons)
  - RECALCULATE progress_percentage
      â†“
Update UI with new progress
```

---

## ğŸ¯ Performance Optimizations

### 1. Connection Pooling
```javascript
const pool = new Pool({
  max: 20, // Max 20 connections
  idleTimeoutMillis: 30000,
  connectionTimeoutMillis: 2000,
});
```

### 2. Prepared Statements
All queries use parameterized queries for safety and performance.

### 3. Strategic Indexes
```sql
-- Common query patterns
CREATE INDEX idx_user_courses_user_status 
  ON user_courses(user_id, status);

CREATE INDEX idx_chat_messages_session_created 
  ON chat_messages(session_id, created_at DESC);
```

### 4. JSONB Indexing
```sql
-- Fast JSONB queries
CREATE INDEX idx_learning_plans_plan_data 
  ON learning_plans USING gin(plan_data);
```

### 5. Automatic Triggers
```sql
-- Auto-update timestamps
CREATE TRIGGER update_users_updated_at 
  BEFORE UPDATE ON users
  FOR EACH ROW 
  EXECUTE FUNCTION update_updated_at_column();
```

---

## ğŸ“ˆ Scalability Considerations

### Current Architecture
- **Single PostgreSQL instance**
- **Connection pooling** (20 connections)
- **Indexes** on hot paths
- **JSONB** for flexible data

### Future Scaling Options

#### 1. Read Replicas
```
Primary (Write) â”€â”€â”¬â”€â”€â–º Replica 1 (Read)
                  â”œâ”€â”€â–º Replica 2 (Read)
                  â””â”€â”€â–º Replica 3 (Read)
```

#### 2. Caching Layer
```
Client â”€â”€â–º Redis Cache â”€â”€â–º PostgreSQL
           (hot data)      (cold data)
```

#### 3. Sharding (if needed)
```
Users A-M â”€â”€â–º Shard 1
Users N-Z â”€â”€â–º Shard 2
```

#### 4. Microservices (future)
```
API Gateway
    â”œâ”€â”€â–º User Service (users, auth)
    â”œâ”€â”€â–º Course Service (courses, lessons)
    â”œâ”€â”€â–º Chat Service (sessions, messages)
    â””â”€â”€â–º Analytics Service (logs, stats)
```

---

## ğŸ”’ Security Best Practices

### âœ… Implemented
- Password hashing (bcrypt)
- Parameterized queries (SQL injection protection)
- Foreign key constraints
- Timestamps for audit trail

### ğŸ”œ Recommended for Production
- JWT tokens for authentication
- Rate limiting
- Input validation
- HTTPS only
- Database encryption at rest
- Regular backups
- RBAC (Role-Based Access Control)

---

## ğŸ“Š Monitoring & Maintenance

### Health Checks
```bash
# API health
curl http://localhost:3001/health

# Database health
psql -U postgres -c "SELECT NOW();"
```

### Query Performance
```sql
-- Enable query logging
ALTER DATABASE teacher_platform SET log_statement = 'all';

-- Analyze slow queries
SELECT * FROM pg_stat_statements 
ORDER BY total_exec_time DESC 
LIMIT 10;
```

### Database Size
```sql
-- Check table sizes
SELECT 
  schemaname,
  tablename,
  pg_size_pretty(pg_total_relation_size(schemaname||'.'||tablename)) AS size
FROM pg_tables
WHERE schemaname = 'public'
ORDER BY pg_total_relation_size(schemaname||'.'||tablename) DESC;
```

---

## ğŸ“ Summary

Ğ­Ñ‚Ğ° Ğ°Ñ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ° Ğ¾Ğ±ĞµÑĞ¿ĞµÑ‡Ğ¸Ğ²Ğ°ĞµÑ‚:

âœ… **ĞœĞ°ÑÑˆÑ‚Ğ°Ğ±Ğ¸Ñ€ÑƒĞµĞ¼Ğ¾ÑÑ‚ÑŒ** - Ğ³Ğ¾Ñ‚Ğ¾Ğ²Ğ° Ğº Ñ€Ğ¾ÑÑ‚Ñƒ
âœ… **ĞŸÑ€Ğ¾Ğ¸Ğ·Ğ²Ğ¾Ğ´Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ** - Ğ¾Ğ¿Ñ‚Ğ¸Ğ¼Ğ¸Ğ·Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑÑ‹ Ğ¸ Ğ¸Ğ½Ğ´ĞµĞºÑÑ‹
âœ… **ĞĞ°Ğ´ĞµĞ¶Ğ½Ğ¾ÑÑ‚ÑŒ** - Ñ†ĞµĞ»Ğ¾ÑÑ‚Ğ½Ğ¾ÑÑ‚ÑŒ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ… Ğ¸ Ñ‚Ñ€Ğ°Ğ½Ğ·Ğ°ĞºÑ†Ğ¸Ğ¸
âœ… **Ğ‘ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ğ¾ÑÑ‚ÑŒ** - Ğ·Ğ°Ñ‰Ğ¸Ñ‚Ğ° Ğ¾Ñ‚ SQL injection Ğ¸ Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ğ¾Ğµ Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ¸Ğµ Ğ¿Ğ°Ñ€Ğ¾Ğ»ĞµĞ¹
âœ… **Ğ“Ğ¸Ğ±ĞºĞ¾ÑÑ‚ÑŒ** - JSONB Ğ´Ğ»Ñ Ğ´Ğ¸Ğ½Ğ°Ğ¼Ğ¸Ñ‡ĞµÑĞºĞ¸Ñ… Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…
âœ… **ĞŸĞ¾Ğ´Ğ´ĞµÑ€Ğ¶Ğ¸Ğ²Ğ°ĞµĞ¼Ğ¾ÑÑ‚ÑŒ** - Ñ‡Ğ¸ÑÑ‚Ğ°Ñ ÑÑ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ° Ğ¸ Ğ´Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ°Ñ†Ğ¸Ñ

ĞÑ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ° ÑĞ¿Ñ€Ğ¾ĞµĞºÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ° Ğ¿Ñ€Ğ¾Ñ„ĞµÑÑĞ¸Ğ¾Ğ½Ğ°Ğ»Ğ¾Ğ¼ ÑƒÑ€Ğ¾Ğ²Ğ½Ñ top 1% Ğ¸ Ğ³Ğ¾Ñ‚Ğ¾Ğ²Ğ° Ğº production deployment! ğŸš€

