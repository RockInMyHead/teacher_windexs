#!/bin/bash

echo "üöÄ –ó–∞–ø—É—Å–∫ Windexs-–£—á–∏—Ç–µ–ª—å –Ω–∞ –ø–æ—Ä—Ç–∞—Ö 1037-1039..."

# –ó–∞–≥—Ä—É–∂–∞–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –∏–∑ .env —Ñ–∞–π–ª–∞
if [ -f .env ]; then
    export $(cat .env | grep -v '^#' | xargs)
fi

# –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –¥–ª—è –ø–æ—Ä—Ç–æ–≤
export VITE_DEV_PORT=1037
export PROXY_PORT=1038
export PORT=1039

# –î–æ–±–∞–≤–ª—è–µ–º OPENAI_API_KEY –µ—Å–ª–∏ –æ–Ω–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç
if [ -z "$OPENAI_API_KEY" ]; then
    export OPENAI_API_KEY="$VITE_OPENAI_API_KEY"
fi

echo "üì± Frontend (Vite): –ø–æ—Ä—Ç $VITE_DEV_PORT"
echo "ü§ñ Proxy (OpenAI): –ø–æ—Ä—Ç $PROXY_PORT"
echo "üåê Production: –ø–æ—Ä—Ç $PORT"
echo "OPENAI_API_KEY —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞: ${OPENAI_API_KEY:+YES}"

# –ó–∞–ø—É—Å–∫–∞–µ–º –ø—Ä–æ–∫—Å–∏-—Å–µ—Ä–≤–µ—Ä
echo "ü§ñ –ó–∞–ø—É—Å–∫ –ø—Ä–æ–∫—Å–∏-—Å–µ—Ä–≤–µ—Ä–∞..."
./start-proxy.sh &

# –ñ–¥–µ–º 3 —Å–µ–∫—É–Ω–¥—ã, —á—Ç–æ–±—ã –ø—Ä–æ–∫—Å–∏-—Å–µ—Ä–≤–µ—Ä —É—Å–ø–µ–ª –∑–∞–ø—É—Å—Ç–∏—Ç—å—Å—è
sleep 3

# –ó–∞–ø—É—Å–∫–∞–µ–º dev —Å–µ—Ä–≤–µ—Ä
echo "üì± –ó–∞–ø—É—Å–∫ Vite dev —Å–µ—Ä–≤–µ—Ä–∞..."
./start-dev.sh &

echo ""
echo "‚úÖ –í—Å–µ —Å–µ—Ä–≤–µ—Ä—ã –∑–∞–ø—É—â–µ–Ω—ã!"
echo "üåê –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–Ω–æ: http://localhost:$VITE_DEV_PORT"
echo "ü§ñ AI —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–∞–±–æ—Ç–∞—é—Ç —á–µ—Ä–µ–∑: http://localhost:$PROXY_PORT"
echo ""
echo "üìä –î–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—Ç–∞—Ç—É—Å–∞: ./check-servers.sh"
echo "üõë –î–ª—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∏: ./stop-servers.sh"
