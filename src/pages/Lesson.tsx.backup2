// Global types for Speech Recognition API
declare global {
  interface Window {
    SpeechRecognition: typeof SpeechRecognition;
    webkitSpeechRecognition: typeof SpeechRecognition;
  }
}

interface SpeechRecognitionEvent extends Event {
  readonly resultIndex: number;
  readonly results: SpeechRecognitionResultList;
}

interface SpeechRecognitionResultList {
  readonly length: number;
  item(index: number): SpeechRecognitionResult;
  [index: number]: SpeechRecognitionResult;
}

interface SpeechRecognitionResult {
  readonly length: number;
  item(index: number): SpeechRecognitionAlternative;
  [index: number]: SpeechRecognitionAlternative;
  isFinal: boolean;
}

interface SpeechRecognitionAlternative {
  transcript: string;
  confidence: number;
}

interface SpeechRecognition extends EventTarget {
  continuous: boolean;
  interimResults: boolean;
  lang: string;
  onstart: ((this: SpeechRecognition, ev: Event) => any) | null;
  onresult: ((this: SpeechRecognition, ev: SpeechRecognitionEvent) => any) | null;
  onerror: ((this: SpeechRecognition, ev: Event) => any) | null;
  onend: ((this: SpeechRecognition, ev: Event) => any) | null;
  start(): void;
  stop(): void;
}

declare var SpeechRecognition: {
  prototype: SpeechRecognition;
  new(): SpeechRecognition;
};

import React, { useState, useEffect, useRef } from 'react';
import { useParams, useNavigate, useSearchParams } from 'react-router-dom';
import { useAuth } from '@/contexts/AuthContext';
import { Button } from '@/components/ui/button';
import { OpenAITTS } from '@/lib/openaiTTS';
import { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';
import { Input } from '@/components/ui/input';
import { ScrollArea } from '@/components/ui/scroll-area';
import { Avatar, AvatarFallback } from '@/components/ui/avatar';
import { Badge } from '@/components/ui/badge';
import {
  Brain,
  ArrowLeft,
  Send,
  BookOpen,
  MessageCircle,
  MessageSquare,
  User,
  CheckCircle,
  Play,
  ArrowRight,
  Volume2,
  Mic
} from 'lucide-react';
import {
  Chart as ChartJS,
  CategoryScale,
  LinearScale,
  BarElement,
  LineElement,
  PointElement,
  ArcElement,
  Title,
  Tooltip,
  Legend,
} from 'chart.js';
import { Bar, Line, Pie, Doughnut } from 'react-chartjs-2';
import 'katex/dist/katex.min.css';
import { InlineMath, BlockMath } from 'react-katex';

// Interactive Test Component (Duolingo-style) - temporarily commented out due to syntax issues
/*
interface InteractiveTestProps {
  lesson: any;
  onComplete: () => void;
}

const InteractiveTest = ({ lesson, onComplete }: InteractiveTestProps) => {
  const [currentExercise, setCurrentExercise] = useState(0);
  const [score, setScore] = useState(0);
  const [selectedAnswer, setSelectedAnswer] = useState<string | null>(null);
  const [showResult, setShowResult] = useState(false);
  const [isCorrect, setIsCorrect] = useState(false);
  const [exercises, setExercises] = useState<any[]>([]);

  // Generate exercises based on lesson content
  useEffect(() => {
    if (lesson?.content) {
      const generatedExercises = generateExercisesFromContent(lesson.content);
      setExercises(generatedExercises);
    }
  }, [lesson]);

  const generateExercisesFromContent = (content: string) => {
    // Simple exercise generation - in real app this would use AI
    const exercises = [
      {
        type: 'multiple_choice',
        question: '–ö–∞–∫–æ–π –ø–∞–¥–µ–∂ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ —Å–ª–æ–≤–µ "—Å—Ç–æ–ª" –≤ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–∏ "–Ø –≤–∏–∂—É —Å—Ç–æ–ª"?',
        options: ['–ò–º–µ–Ω–∏—Ç–µ–ª—å–Ω—ã–π', '–†–æ–¥–∏—Ç–µ–ª—å–Ω—ã–π', '–í–∏–Ω–∏—Ç–µ–ª—å–Ω—ã–π', '–¢–≤–æ—Ä–∏—Ç–µ–ª—å–Ω—ã–π'],
        correctAnswer: '–í–∏–Ω–∏—Ç–µ–ª—å–Ω—ã–π',
        explanation: '–°–ª–æ–≤–æ "—Å—Ç–æ–ª" –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ –≤–æ–ø—Ä–æ—Å "—á—Ç–æ?" –∏ —è–≤–ª—è–µ—Ç—Å—è –ø—Ä—è–º—ã–º –¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ–º.'
      },
      {
        type: 'translation',
        question: '–ü–µ—Ä–µ–≤–µ–¥–∏—Ç–µ –Ω–∞ —Ä—É—Å—Å–∫–∏–π: "I am learning Russian"',
        correctAnswer: '–Ø –∏–∑—É—á–∞—é —Ä—É—Å—Å–∫–∏–π',
        explanation: 'Present Continuous –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –¥–µ–π—Å—Ç–≤–∏–π, –ø—Ä–æ–∏—Å—Ö–æ–¥—è—â–∏—Ö —Å–µ–π—á–∞—Å.'
      },
      {
        type: 'fill_blank',
        question: '–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –ø—Ä–æ–ø—É—Å–∫: "–Ø ___ –≤ —à–∫–æ–ª—É –∫–∞–∂–¥—ã–π –¥–µ–Ω—å."',
        options: ['–∏–¥—É', '–∏–¥—ë—Ç', '–∏–¥—ë—à—å', '–∏–¥—ë–º'],
        correctAnswer: '–∏–¥—É',
        explanation: '–î–ª—è –ø–µ—Ä–≤–æ–≥–æ –ª–∏—Ü–∞ –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ —á–∏—Å–ª–∞ –∏—Å–ø–æ–ª—å–∑—É–µ–º "–∏–¥—É".'
      },
      {
        type: 'matching',
        question: '–°–æ–æ—Ç–Ω–µ—Å–∏—Ç–µ —Å–ª–æ–≤–∞ —Å –∏—Ö –∑–Ω–∞—á–µ–Ω–∏—è–º–∏:',
        pairs: [
          { word: '–±—ã—Å—Ç—Ä—ã–π', meaning: '–¥–≤–∏–≥–∞—é—â–∏–π—Å—è —Å –±–æ–ª—å—à–æ–π —Å–∫–æ—Ä–æ—Å—Ç—å—é' },
          { word: '–º–µ–¥–ª–µ–Ω–Ω—ã–π', meaning: '–¥–≤–∏–≥–∞—é—â–∏–π—Å—è —Å –º–∞–ª–æ–π —Å–∫–æ—Ä–æ—Å—Ç—å—é' },
          { word: '–≤—ã—Å–æ–∫–∏–π', meaning: '–±–æ–ª—å—à–æ–π –ø–æ –≤—ã—Å–æ—Ç–µ' }
        ],
        explanation: '–≠—Ç–∏ –ø—Ä–∏–ª–∞–≥–∞—Ç–µ–ª—å–Ω—ã–µ –æ–ø–∏—Å—ã–≤–∞—é—Ç —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –æ–±—ä–µ–∫—Ç–æ–≤.'
      }
    ];
    return exercises;
  };

  const handleAnswerSelect = (answer: string) => {
    if (showResult) return;

    setSelectedAnswer(answer);
    const exercise = exercises[currentExercise];
    const correct = answer === exercise.correctAnswer;

    setIsCorrect(correct);
    setShowResult(true);

    if (correct) {
      setScore(score + 1);
    }
  };

  const handleNext = () => {
    if (currentExercise < exercises.length - 1) {
      setCurrentExercise(currentExercise + 1);
      setSelectedAnswer(null);
      setShowResult(false);
    } else {
      // Test completed
      onComplete();
    }
  };

  if (exercises.length === 0) {
    return (
      <div className="min-h-screen bg-gradient-to-br from-background via-secondary/30 to-background flex items-center justify-center">
        <Card className="w-full max-w-md">
          <CardContent className="p-8 text-center">
            <Brain className="w-16 h-16 mx-auto text-primary animate-pulse mb-4" />
            <h2 className="text-xl font-bold mb-2">–ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–µ—Å—Ç–∞...</h2>
            <p className="text-muted-foreground">–ü–æ–¥–æ–∂–¥–∏—Ç–µ, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞</p>
          </CardContent>
        </Card>
      </div>
    );
  }

  const exercise = exercises[currentExercise];
  const progress = ((currentExercise + 1) / exercises.length) * 100;

  return (
    <div className="min-h-screen bg-gradient-to-br from-background via-secondary/30 to-background">
      {/* Header */}
      <header className="border-b border-border/50 bg-card/50 backdrop-blur-sm">
        <div className="container mx-auto px-4 py-4">
          <div className="flex items-center justify-between">
            <div className="flex items-center gap-3">
              <Button
                variant="ghost"
                onClick={() => window.history.back()}
                className="flex items-center gap-2"
              >
                <ArrowLeft className="w-4 h-4" />
                –ù–∞–∑–∞–¥
              </Button>
            </div>
            <div className="text-center">
              <h1 className="text-lg font-semibold">–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π —Ç–µ—Å—Ç</h1>
              <p className="text-sm text-muted-foreground">
                –í–æ–ø—Ä–æ—Å {currentExercise + 1} –∏–∑ {exercises.length}
              </p>
            </div>
            <div className="text-right">
              <p className="text-sm font-medium">{score}/{exercises.length}</p>
              <p className="text-xs text-muted-foreground">–ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö</p>
            </div>
          </div>
        </div>
      </header>

      {/* Progress Bar */}
      <div className="w-full bg-secondary h-2">
        <div
          className="h-full bg-gradient-to-r from-primary to-accent transition-all duration-500"
          style={{ width: `${progress}%` }}
        />
      </div>

      {/* Main Content */}
      <div className="container mx-auto px-4 py-8 max-w-2xl">
        <Card className="text-center">
          <CardContent className="p-8">
            {/* Exercise */}
            <div className="space-y-6">
              <h2 className="text-2xl font-bold text-center mb-6">
                {exercise.question}
              </h2>

              {/* Multiple Choice */}
              {exercise.type === 'multiple_choice' && (
                <div className="grid grid-cols-1 gap-3 max-w-md mx-auto">
                  {exercise.options.map((option: string, index: number) => (
                    <Button
                      key={index}
                      onClick={() => handleAnswerSelect(option)}
                      disabled={showResult}
                      variant={
                        showResult
                          ? option === exercise.correctAnswer
                            ? "default"
                            : selectedAnswer === option
                            ? "destructive"
                            : "outline"
                          : selectedAnswer === option
                          ? "secondary"
                          : "outline"
                      }
                      className="h-12 text-left justify-start"
                    >
                      {option}
                    </Button>
                  ))}
                </div>
              )}

              {/* Translation */}
              {exercise.type === 'translation' && (
                <div className="space-y-4">
                  <Input
                    placeholder="–í–≤–µ–¥–∏—Ç–µ –ø–µ—Ä–µ–≤–æ–¥..."
                    value={selectedAnswer || ''}
                    onChange={(e) => setSelectedAnswer(e.target.value)}
                    disabled={showResult}
                    className="text-center text-lg"
                  />
                  <Button
                    onClick={() => handleAnswerSelect(selectedAnswer || '')}
                    disabled={!selectedAnswer || showResult}
                  >
                    –ü—Ä–æ–≤–µ—Ä–∏—Ç—å
                  </Button>
                </div>
              )}

              {/* Fill Blank */}
              {exercise.type === 'fill_blank' && (
                <div className="grid grid-cols-2 gap-3 max-w-md mx-auto">
                  {exercise.options.map((option: string, index: number) => (
                    <Button
                      key={index}
                      onClick={() => handleAnswerSelect(option)}
                      disabled={showResult}
                      variant={
                        showResult
                          ? option === exercise.correctAnswer
                            ? "default"
                            : selectedAnswer === option
                            ? "destructive"
                            : "outline"
                          : selectedAnswer === option
                          ? "secondary"
                          : "outline"
                      }
                      className="h-12"
                    >
                      {option}
                    </Button>
                  ))}
                </div>
              )}

              {/* Result */}
              {showResult && (
                <div className={`p-4 rounded-lg border-2 ${
                  isCorrect
                    ? 'border-green-500 bg-green-50 text-green-800'
                    : 'border-red-500 bg-red-50 text-red-800'
                }`}>
                  <div className="flex items-center gap-2 mb-2">
                    {isCorrect ? (
                      <CheckCircle className="w-5 h-5 text-green-600" />
                    ) : (
                      <span className="text-red-600">‚úó</span>
                    )}
                    <span className="font-medium">
                      {isCorrect ? '–ü—Ä–∞–≤–∏–ª—å–Ω–æ!' : '–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ'}
                    </span>
                  </div>
                  <p className="text-sm">{exercise.explanation}</p>
                  {!isCorrect && (
                    <p className="text-sm mt-2">
                      –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç: <strong>{exercise.correctAnswer}</strong>
                    </p>
                  )}
                </div>
              )}

              {/* Next Button */}
              {showResult && (
                <Button onClick={handleNext} className="w-full">
                  {currentExercise < exercises.length - 1 ? '–î–∞–ª–µ–µ' : '–ó–∞–≤–µ—Ä—à–∏—Ç—å —Ç–µ—Å—Ç'}
                  <ArrowRight className="w-4 h-4 ml-2" />
                </Button>
              )}
            </div>
          </CardContent>
        </Card>
      </div>
    </div>
  );
};
*/

// Animated Sphere Component for Lesson Communication
const AnimatedSphere = ({
  onStartChat,
  onStartVoiceChat
}: {
  onStartChat: () => void;
  onStartVoiceChat: () => void;
}) => (
  <div className="h-full bg-gradient-to-br from-background via-secondary/30 to-background flex flex-col items-center justify-center p-6">
    <div className="relative w-full max-w-sm flex-1 flex flex-col items-center justify-center">
      {/* Main sphere */}
      <div className="w-24 h-24 mx-auto bg-gradient-to-r from-blue-500 to-purple-600 rounded-full animate-pulse shadow-xl relative overflow-hidden">
        <div className="absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent animate-pulse"></div>
        <div className="absolute inset-1 bg-gradient-to-r from-purple-600 to-blue-500 rounded-full opacity-80 animate-ping"></div>
        <div className="absolute inset-2 bg-gradient-to-r from-blue-500 to-purple-600 rounded-full opacity-60 animate-bounce"></div>
      </div>

      {/* Calm orbiting elements */}
      <div className="absolute inset-0" style={{
        animation: 'gentle-orbit 8s linear infinite'
      }}>
        <div className="w-1.5 h-1.5 bg-gradient-to-br from-blue-300 to-blue-400 rounded-full absolute opacity-70 shadow-lg"
             style={{
               left: '50%',
               top: '50%',
               transform: 'translate(-50%, -50%) translateX(-60px)',
               animation: 'float-glow 4s ease-in-out infinite alternate'
             }}>
        </div>
      </div>

      <div className="absolute inset-0" style={{
        animation: 'gentle-orbit 8s linear infinite reverse'
      }}>
        <div className="w-1.3 h-1.3 bg-gradient-to-br from-purple-300 to-pink-300 rounded-full absolute opacity-60 shadow-lg"
             style={{
               left: '50%',
               top: '50%',
               transform: 'translate(-50%, -50%) translateX(55px)',
               animation: 'float-glow 3.5s ease-in-out infinite alternate reverse'
             }}>
        </div>
      </div>

      {/* Communication Button */}
      <div className="mt-6 text-center px-4">
        <div className="bg-card/80 backdrop-blur-sm rounded-lg p-4 border border-border/50 shadow-lg">
          <p className="text-sm text-foreground/90 mb-3">
            ü§ñ AI –∑–Ω–∞–µ—Ç –≤–µ—Å—å –º–∞—Ç–µ—Ä–∏–∞–ª —ç—Ç–æ–≥–æ —É—Ä–æ–∫–∞ –∏ –ø–æ–º–æ–∂–µ—Ç —Ä–∞–∑–æ–±—Ä–∞—Ç—å—Å—è –≤ –Ω—é–∞–Ω—Å–∞—Ö
          </p>
          <div className="space-y-2">
            <Button
              onClick={onStartVoiceChat}
              size="lg"
              className="w-full font-medium shadow-lg"
            >
              <MessageCircle className="w-5 h-5 mr-2" />
              –ù–∞—á–∞—Ç—å
            </Button>
            <Button
              onClick={onStartChat}
              variant="outline"
              size="lg"
              className="w-full font-medium"
            >
              üí¨ –ß–∞—Ç
            </Button>
          </div>
        </div>
      </div>
    </div>
  </div>
);

// Component for rendering LaTeX in text
const LatexText = ({ text }: { text: string }) => {
  const parts = text.split(/(\$\$[\s\S]*?\$\$|\$[\s\S]*?\$)/g);

  return (
    <>
      {parts.map((part, index) => {
        if (part.startsWith('$$') && part.endsWith('$$')) {
          // Block math
          const math = part.slice(2, -2);
          return <BlockMath key={index} math={math} settings={{ strict: false }} />;
        } else if (part.startsWith('$') && part.endsWith('$') && part.length > 2) {
          // Inline math
          const math = part.slice(1, -1);
          return <InlineMath key={index} math={math} settings={{ strict: false }} />;
        } else {
          // Regular text - convert line breaks
          return <span key={index} style={{ whiteSpace: 'pre-wrap' }}>{part}</span>;
        }
      })}
    </>
  );
};

// Function to process markdown text formatting
const processMarkdownText = (text: string): string => {
  let processedText = text;

  // Headers
  processedText = processedText.replace(/^#\s+(.+)$/gm, '<h1 class="text-3xl font-bold text-green-700 mb-4">$1</h1>');
  processedText = processedText.replace(/^##\s+(.+)$/gm, '<h2 class="text-xl font-bold text-green-700 mb-3">$1</h2>');
  processedText = processedText.replace(/^###\s+(.+)$/gm, '<h3 class="text-lg font-bold text-green-700 mb-2">$1</h3>');
  processedText = processedText.replace(/^####\s+(.+)$/gm, '<h4 class="text-xl font-bold text-green-700 mb-3">$1</h4>');

  // Bold text
  processedText = processedText.replace(/\*\*(.*?)\*\*/g, '<strong class="text-green-700 font-semibold">$1</strong>');

  // Italic text
  processedText = processedText.replace(/\*(.*?)\*/g, '<em class="italic">$1</em>');

  // Lists
  processedText = processedText.replace(/^- (.+)$/gm, '<li class="ml-4">$1</li>');

  // Line breaks
  processedText = processedText.replace(/\n/g, '<br>');

  return processedText;
};

// Component for rendering lesson content with LaTeX support
const LessonContent = ({ content, generatedImages }: { content: string, generatedImages: Record<string, string> }) => {
  // Split content by different markers
  const parts = content.split(/(<\w+[^>]*>.*?<\/\w+>|\$\$[\s\S]*?\$\$|\$[\s\S]*?\$|\[.*?\]|\[–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è.*?\]|\[–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ: .*?\])/g);

  return (
    <div className="text-sm leading-relaxed">
      {parts.map((part, index) => {
        if (part.startsWith('$$') && part.endsWith('$$')) {
          // Block math
          const math = part.slice(2, -2);
          return <BlockMath key={index} math={math} settings={{ strict: false }} />;
        } else if (part.startsWith('$') && part.endsWith('$') && part.length > 2) {
          // Inline math
          const math = part.slice(1, -1);
          return <InlineMath key={index} math={math} settings={{ strict: false }} />;
        } else if (part.startsWith('[') && part.endsWith(']')) {
          // LaTeX in square brackets (fallback for \[...\])
          const math = part.slice(1, -1);
          return <BlockMath key={index} math={math} settings={{ strict: false }} />;
        } else if (part.includes('[–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è')) {
          // Image generation placeholder
          return (
            <div key={index} className="inline-block mx-2 my-2 p-4 border-2 border-dashed border-gray-300 rounded-lg bg-gray-50">
              <div className="text-sm text-gray-500 text-center">
                <div className="animate-spin inline-block w-4 h-4 border-2 border-gray-300 border-t-blue-500 rounded-full mr-2"></div>
                –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è...
              </div>
            </div>
          );
        } else if (part.includes('[–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ:')) {
          // Generated image
          const description = part.match(/\[–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ: (.*?)\]/)?.[1] || '';
          const imageKey = `image_${Object.keys(generatedImages).length - 1}`;
          return (
            <div key={index} className="inline-block mx-2 my-2">
              <img src={generatedImages[imageKey]} alt={description} className="max-w-xs rounded-lg shadow-lg border" />
              <div className="text-xs text-gray-500 mt-1 text-center">AI Generated</div>
            </div>
          );
        } else if (part.includes('<')) {
          // HTML content (tables, charts)
          return <div key={index} dangerouslySetInnerHTML={{ __html: part }} />;
        } else if (part.includes('<br>')) {
          // Handle line breaks
          const lines = part.split('<br>');
          return (
            <span key={index}>
              {lines.map((line, lineIndex) => (
                <React.Fragment key={lineIndex}>
                  {line}
                  {lineIndex < lines.length - 1 && <br />}
                </React.Fragment>
              ))}
            </span>
          );
        } else {
          // Process markdown formatting
          const processedPart = processMarkdownText(part);
          return <span key={index} style={{ whiteSpace: 'pre-wrap' }} dangerouslySetInnerHTML={{ __html: processedPart }} />;
        }
      })}
    </div>
  );
};

// Register Chart.js components
ChartJS.register(
  CategoryScale,
  LinearScale,
  BarElement,
  LineElement,
  PointElement,
  ArcElement,
  Title,
  Tooltip,
  Legend
);

interface Message {
  id: string;
  role: 'user' | 'assistant';
  content: string;
  timestamp: Date;
}

// Function to get course and module info
const getCourseAndModuleInfo = (moduleId: number, lessonId: number) => {
  // This should match the structure in CourseDetail.tsx
  const courses = [
    { // 0 - –†—É—Å—Å–∫–∏–π —è–∑—ã–∫
      name: '–†—É—Å—Å–∫–∏–π —è–∑—ã–∫',
      modules: [
        '–†—É—Å—Å–∫–∞—è –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä–∞ XIX –≤–µ–∫–∞',
        '–°–µ—Ä–µ–±—Ä—è–Ω—ã–π –≤–µ–∫ —Ä—É—Å—Å–∫–æ–π –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä—ã',
        '–°–æ–≤–µ—Ç—Å–∫–∞—è –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä–∞',
        '–°–æ–≤—Ä–µ–º–µ–Ω–Ω–∞—è —Ä—É—Å—Å–∫–∞—è –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä–∞',
        '–§–∏–ª–æ–ª–æ–≥–∏—è –∏ –ª–∏–Ω–≥–≤–∏—Å—Ç–∏–∫–∞'
      ]
    },
    { // 1 - –ê–Ω–≥–ª–∏–π—Å–∫–∏–π —è–∑—ã–∫
      name: '–ê–Ω–≥–ª–∏–π—Å–∫–∏–π —è–∑—ã–∫',
      modules: [
        '–û—Å–Ω–æ–≤—ã –∞–Ω–≥–ª–∏–π—Å–∫–æ–≥–æ',
        '–ì—Ä–∞–º–º–∞—Ç–∏–∫–∞ –¥–ª—è –Ω–∞—á–∏–Ω–∞—é—â–∏—Ö',
        '–†–∞–∑–≤–∏—Ç–∏–µ —Å–ª–æ–≤–∞—Ä–Ω–æ–≥–æ –∑–∞–ø–∞—Å–∞',
        '–†–∞–∑–≥–æ–≤–æ—Ä–Ω–∞—è –ø—Ä–∞–∫—Ç–∏–∫–∞',
        '–ü—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è –≥—Ä–∞–º–º–∞—Ç–∏–∫–∞',
        '–ë–∏–∑–Ω–µ—Å –∞–Ω–≥–ª–∏–π—Å–∫–∏–π'
      ]
    },
    { // 2 - –ê—Ä–∞–±—Å–∫–∏–π —è–∑—ã–∫
      name: '–ê—Ä–∞–±—Å–∫–∏–π —è–∑—ã–∫',
      modules: [
        '–ê—Ä–∞–±—Å–∫–∏–π –∞–ª—Ñ–∞–≤–∏—Ç',
        '–§–æ–Ω–µ—Ç–∏–∫–∞ –∏ –ø—Ä–æ–∏–∑–Ω–æ—à–µ–Ω–∏–µ',
        '–ë–∞–∑–æ–≤–∞—è –≥—Ä–∞–º–º–∞—Ç–∏–∫–∞',
        '–†–∞–∑–≥–æ–≤–æ—Ä–Ω–∞—è –ø—Ä–∞–∫—Ç–∏–∫–∞'
      ]
    },
    { // 3 - –ö–∏—Ç–∞–π—Å–∫–∏–π —è–∑—ã–∫
      name: '–ö–∏—Ç–∞–π—Å–∫–∏–π —è–∑—ã–∫',
      modules: [
        '–ü–∏–Ω—å–∏–Ω—å –∏ —Ç–æ–Ω—ã',
        '–û—Å–Ω–æ–≤–Ω—ã–µ –∏–µ—Ä–æ–≥–ª–∏—Ñ—ã',
        '–ë–∞–∑–æ–≤–∞—è –≥—Ä–∞–º–º–∞—Ç–∏–∫–∞',
        '–†–∞–∑–≥–æ–≤–æ—Ä–Ω–∞—è –ø—Ä–∞–∫—Ç–∏–∫–∞'
      ]
    },
    { // 4 - –ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞
      name: '–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞',
      modules: [
        '–ê—Ä–∏—Ñ–º–µ—Ç–∏–∫–∞ –∏ –∞–ª–≥–µ–±—Ä–∞',
        '–ì–µ–æ–º–µ—Ç—Ä–∏—è',
        '–¢—Ä–∏–≥–æ–Ω–æ–º–µ—Ç—Ä–∏—è',
        '–ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑'
      ]
    },
    { // 5 - –§–∏–∑–∏–∫–∞
      name: '–§–∏–∑–∏–∫–∞',
      modules: [
        '–ú–µ—Ö–∞–Ω–∏–∫–∞',
        '–ú–æ–ª–µ–∫—É–ª—è—Ä–Ω–∞—è —Ñ–∏–∑–∏–∫–∞',
        '–≠–ª–µ–∫—Ç—Ä–∏—á–µ—Å—Ç–≤–æ –∏ –º–∞–≥–Ω–µ—Ç–∏–∑–º',
        '–û–ø—Ç–∏–∫–∞'
      ]
    },
    { // 6 - –ì–µ–æ–≥—Ä–∞—Ñ–∏—è
      name: '–ì–µ–æ–≥—Ä–∞—Ñ–∏—è',
      modules: [
        '–§–∏–∑–∏—á–µ—Å–∫–∞—è –≥–µ–æ–≥—Ä–∞—Ñ–∏—è',
        '–ü–æ–ª–∏—Ç–∏—á–µ—Å–∫–∞—è –∫–∞—Ä—Ç–∞ –º–∏—Ä–∞',
        '–ö–ª–∏–º–∞—Ç–æ–ª–æ–≥–∏—è',
        '–≠–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–∞—è –≥–µ–æ–≥—Ä–∞—Ñ–∏—è'
      ]
    },
    { // 7 - –ò—Å—Ç–æ—Ä–∏—è
      name: '–ò—Å—Ç–æ—Ä–∏—è',
      modules: [
        '–î—Ä–µ–≤–Ω—è—è –∏—Å—Ç–æ—Ä–∏—è',
        '–°—Ä–µ–¥–Ω–∏–µ –≤–µ–∫–∞',
        '–ù–æ–≤–æ–µ –≤—Ä–µ–º—è',
        '–ò—Å—Ç–æ—Ä–∏—è –†–æ—Å—Å–∏–∏'
      ]
    }
  ];

  const course = courses[moduleId];
  if (!course) return { courseName: '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π –∫—É—Ä—Å', moduleName: '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π –º–æ–¥—É–ª—å', lessonNumber: lessonId + 1 };

  return {
    courseName: course.name,
    moduleName: course.modules[lessonId] || `–£—Ä–æ–∫ ${lessonId + 1}`,
    lessonNumber: lessonId + 1
  };
};

const lessonContent: Record<string, any> = {
  // –ú–æ–¥—É–ª—å 1: –ü–∞–¥–µ–∂–∏ —Ä—É—Å—Å–∫–æ–≥–æ —è–∑—ã–∫–∞
  '0-0': {
    title: '–í–≤–µ–¥–µ–Ω–∏–µ –≤ –ø–∞–¥–µ–∂–∏',
    theory: `
# –í–≤–µ–¥–µ–Ω–∏–µ –≤ –ø–∞–¥–µ–∂–∏ —Ä—É—Å—Å–∫–æ–≥–æ —è–∑—ã–∫–∞

## –ì–ª–∞–≤–∞ 1: –ß—Ç–æ —Ç–∞–∫–æ–µ –ø–∞–¥–µ–∂–∏? –û—Å–Ω–æ–≤–Ω—ã–µ –ø–æ–Ω—è—Ç–∏—è

### 1.1 –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–∞–¥–µ–∂–∞

**–ü–∞–¥–µ–∂** (–ª–∞—Ç. casus - –ø–∞–¥–µ–Ω–∏–µ, —Å–ª—É—á–∞–π) - —ç—Ç–æ –≥—Ä–∞–º–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è —Å—É—â–µ—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö, –ø—Ä–∏–ª–∞–≥–∞—Ç–µ–ª—å–Ω—ã—Ö, –º–µ—Å—Ç–æ–∏–º–µ–Ω–∏–π, –ø—Ä–∏—á–∞—Å—Ç–∏–π –∏ —á–∏—Å–ª–∏—Ç–µ–ª—å–Ω—ã—Ö, –∫–æ—Ç–æ—Ä–∞—è –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫—É—é —Ä–æ–ª—å —Å–ª–æ–≤–∞ –≤ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–∏ –∏ –µ–≥–æ —Å–≤—è–∑—å —Å –¥—Ä—É–≥–∏–º–∏ —Å–ª–æ–≤–∞–º–∏.

–ü–∞–¥–µ–∂ - —ç—Ç–æ –Ω–µ –ø—Ä–æ—Å—Ç–æ –æ–∫–æ–Ω—á–∞–Ω–∏–µ —Å–ª–æ–≤–∞, –∞ —Å–ª–æ–∂–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –≥—Ä–∞–º–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –æ—Ç–Ω–æ—à–µ–Ω–∏–π, –∫–æ—Ç–æ—Ä–∞—è –ø–æ–∑–≤–æ–ª—è–µ—Ç —Ç–æ—á–Ω–æ –≤—ã—Ä–∞–∂–∞—Ç—å –º—ã—Å–ª–∏ –∏ —Å—Ç—Ä–æ–∏—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è.

### 1.2 –ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∞—è —Å–ø—Ä–∞–≤–∫–∞

–ü–∞–¥–µ–∂–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —Ä—É—Å—Å–∫–æ–≥–æ —è–∑—ã–∫–∞ —É—Ö–æ–¥–∏—Ç –∫–æ—Ä–Ω—è–º–∏ –≤ –¥—Ä–µ–≤–Ω–µ—Ä—É—Å—Å–∫–∏–π —è–∑—ã–∫, –∫–æ—Ç–æ—Ä—ã–π –±—ã–ª –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –±–æ–≥–∞—á–µ –ø–∞–¥–µ–∂–∞–º–∏ (–¥–æ 7-8 –ø–∞–¥–µ–∂–µ–π). –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π —Ä—É—Å—Å–∫–∏–π —è–∑—ã–∫ —Å–æ—Ö—Ä–∞–Ω–∏–ª 6 –ø–∞–¥–µ–∂–µ–π, —á—Ç–æ —è–≤–ª—è–µ—Ç—Å—è –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –¥–ª—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–π –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏.

–ò–Ω—Ç–µ—Ä–µ—Å–Ω—ã–π —Ñ–∞–∫—Ç: –≤ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —Å–ª–∞–≤—è–Ω—Å–∫–∏—Ö —è–∑—ã–∫–∞—Ö (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≤ –ø–æ–ª—å—Å–∫–æ–º) —Å–æ—Ö—Ä–∞–Ω–∏–ª–æ—Å—å 7 –ø–∞–¥–µ–∂–µ–π, –∞ –≤ –∞–Ω–≥–ª–∏–π—Å–∫–æ–º —è–∑—ã–∫–µ –ø–∞–¥–µ–∂–µ–π –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ –Ω–µ—Ç - –∏—Ö —Ä–æ–ª—å –≤—ã–ø–æ–ª–Ω—è—é—Ç –ø—Ä–µ–¥–ª–æ–≥–∏ –∏ –ø–æ—Ä—è–¥–æ–∫ —Å–ª–æ–≤.

### 1.3 –ó–∞—á–µ–º –Ω—É–∂–Ω—ã –ø–∞–¥–µ–∂–∏?

–ü–∞–¥–µ–∂–∏ –≤—ã–ø–æ–ª–Ω—è—é—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ –≤–∞–∂–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π:

1. **–°–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–∞—è —Ñ—É–Ω–∫—Ü–∏—è**: –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç —Ä–æ–ª—å —Å–ª–æ–≤–∞ –≤ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–∏
2. **–°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∞—è —Ñ—É–Ω–∫—Ü–∏—è**: —É—Ç–æ—á–Ω—è—é—Ç —Å–º—ã—Å–ª –≤—ã—Å–∫–∞–∑—ã–≤–∞–Ω–∏—è
3. **–ö–æ–º–º—É–Ω–∏–∫–∞—Ç–∏–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è**: –ø–æ–∑–≤–æ–ª—è—é—Ç —Å—Ç—Ä–æ–∏—Ç—å —Å–ª–æ–∂–Ω—ã–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è
4. **–°—Ç–∏–ª–∏—Å—Ç–∏—á–µ—Å–∫–∞—è —Ñ—É–Ω–∫—Ü–∏—è**: –ø–æ–º–æ–≥–∞—é—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å –≤—ã—Ä–∞–∑–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Ä–µ—á–∏

–ë–µ–∑ –ø–∞–¥–µ–∂–µ–π –Ω–∞—à–∞ —Ä–µ—á—å –±—ã–ª–∞ –±—ã –ø—Ä–∏–º–∏—Ç–∏–≤–Ω–æ–π: "–Ø –∏–¥—É –≤ –º–∞–≥–∞–∑–∏–Ω. –Ø –ø–æ–∫—É–ø–∞—é —Ö–ª–µ–± –≤ –º–∞–≥–∞–∑–∏–Ω." –í–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ –º—ã –≥–æ–≤–æ—Ä–∏–º: "–Ø –∏–¥—É –≤ –º–∞–≥–∞–∑–∏–Ω –∏ –ø–æ–∫—É–ø–∞—é —Ç–∞–º —Ö–ª–µ–±."

### 1.4 –ö–∞–∫ –ø–∞–¥–µ–∂–∏ –≤–ª–∏—è—é—Ç –Ω–∞ –ø–æ–Ω–∏–º–∞–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞

–†–∞—Å—Å–º–æ—Ç—Ä–∏–º –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ: "–°—Ç—É–¥–µ–Ω—Ç —á–∏—Ç–∞–µ—Ç –∫–Ω–∏–≥—É –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—è"

–ë–µ–∑ –∑–Ω–∞–Ω–∏—è –ø–∞–¥–µ–∂–µ–π –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ –ø–æ–Ω—è—Ç—å, –∫—Ç–æ –∫–æ–º—É –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∏—Ç –∫–Ω–∏–≥–∞. –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ –ø–æ–Ω–∏–º–∞–Ω–∏–µ –≤–æ–∑–º–æ–∂–Ω–æ —Ç–æ–ª—å–∫–æ –±–ª–∞–≥–æ–¥–∞—Ä—è –ø–∞–¥–µ–∂–∞–º:
- –°—Ç—É–¥–µ–Ω—Ç (–ò.–ø.) - –ø–æ–¥–ª–µ–∂–∞—â–µ–µ
- —á–∏—Ç–∞–µ—Ç - —Å–∫–∞–∑—É–µ–º–æ–µ
- –∫–Ω–∏–≥—É (–í.–ø.) - –ø—Ä—è–º–æ–µ –¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ
- –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—è (–†.–ø.) - –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–Ω–æ—Å—Ç—å –∫–Ω–∏–≥–∏

## –ì–ª–∞–≤–∞ 2: –®–µ—Å—Ç—å –ø–∞–¥–µ–∂–µ–π —Ä—É—Å—Å–∫–æ–≥–æ —è–∑—ã–∫–∞

### 2.1 –ò–º–µ–Ω–∏—Ç–µ–ª—å–Ω—ã–π –ø–∞–¥–µ–∂ (Nominativus)

**–í–æ–ø—Ä–æ—Å—ã:** –∫—Ç–æ? —á—Ç–æ?
**–û—Å–Ω–æ–≤–Ω–∞—è —Ä–æ–ª—å:** –ø–æ–¥–ª–µ–∂–∞—â–µ–µ, –∏–º–µ–Ω–Ω–∞—è —á–∞—Å—Ç—å —Å–∫–∞–∑—É–µ–º–æ–≥–æ, –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ, –æ–±—Ä–∞—â–µ–Ω–∏–µ

**–ü—Ä–∏–º–µ—Ä—ã:**
- –°—Ç—É–¥–µ–Ω—Ç —á–∏—Ç–∞–µ—Ç –∫–Ω–∏–≥—É. (–ø–æ–¥–ª–µ–∂–∞—â–µ–µ)
- –≠—Ç–æ –º–æ—è –∫–Ω–∏–≥–∞. (–∏–º–µ–Ω–Ω–∞—è —á–∞—Å—Ç—å)
- –ú–∞—à–∞, –ø–æ–¥–æ–π–¥–∏ —Å—é–¥–∞! (–æ–±—Ä–∞—â–µ–Ω–∏–µ)
- –ú–æ—Å–∫–≤–∞ - —Å—Ç–æ–ª–∏—Ü–∞ –†–æ—Å—Å–∏–∏. (–ø–æ–¥–ª–µ–∂–∞—â–µ–µ –≤ –Ω–∞–∑—ã–≤–Ω–æ–º –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–∏)

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- –ò—Å—Ö–æ–¥–Ω–∞—è —Ñ–æ—Ä–º–∞ —Å–ª–æ–≤–∞
- –ù–µ —Ç—Ä–µ–±—É–µ—Ç –ø—Ä–µ–¥–ª–æ–≥–æ–≤ (–∫—Ä–æ–º–µ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —Å–ª—É—á–∞–µ–≤)
- –ú–æ–∂–µ—Ç –≤—ã—Ä–∞–∂–∞—Ç—å —Ç–µ–º—É —Ä–∞–∑–≥–æ–≤–æ—Ä–∞

### 2.2 –†–æ–¥–∏—Ç–µ–ª—å–Ω—ã–π –ø–∞–¥–µ–∂ (Genitivus)

**–í–æ–ø—Ä–æ—Å—ã:** –∫–æ–≥–æ? —á–µ–≥–æ? (—á–µ–π? —á—å—è? —á—å—ë? —á—å–∏?)
**–û—Å–Ω–æ–≤–Ω–∞—è —Ä–æ–ª—å:** –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–Ω–æ—Å—Ç—å, —á–∞—Å—Ç—å –æ—Ç —Ü–µ–ª–æ–≥–æ, –æ—Ç—Ä–∏—Ü–∞–Ω–∏–µ

**–ü—Ä–∏–º–µ—Ä—ã:**
- –ö–Ω–∏–≥–∞ —Å—Ç—É–¥–µ–Ω—Ç–∞ (–ø—Ä–∏–Ω–∞–¥–ª–µ–∂–Ω–æ—Å—Ç—å)
- –ß–∞—à–∞ —á–∞—è (—á–∞—Å—Ç—å –æ—Ç —Ü–µ–ª–æ–≥–æ)
- –ù–µ—Ç –≤—Ä–µ–º–µ–Ω–∏ (–æ—Ç—Ä–∏—Ü–∞–Ω–∏–µ)
- –ë–æ—é—Å—å —Ç–µ–º–Ω–æ—Ç—ã (–æ–±—ä–µ–∫—Ç —á—É–≤—Å—Ç–≤–∞)

**–° –ø—Ä–µ–¥–ª–æ–≥–∞–º–∏:**
- –∏–∑/—Å: –≤—ã—à–µ–ª –∏–∑ –¥–æ–º–∞, –≤–µ—Ä–Ω—É–ª—Å—è —Å —Ä–∞–±–æ—Ç—ã
- —É: –±—ã–ª —É –¥—Ä—É–≥–∞, —Å–ø—Ä–æ—Å–∏–ª —É —É—á–∏—Ç–µ–ª—è
- –æ—Ç: –ø–æ–ª—É—á–∏–ª –ø–∏—Å—å–º–æ –æ—Ç –º–∞–º—ã
- –¥–æ: —Ä–∞–±–æ—Ç–∞–ª –¥–æ –≤–µ—á–µ—Ä–∞
- –¥–ª—è: –∫—É–ø–∏–ª –ø–æ–¥–∞—Ä–æ–∫ –¥–ª—è —Å–µ—Å—Ç—Ä—ã
- –±–µ–∑: –ø—Ä–∏—à–µ–ª –±–µ–∑ –∑–æ–Ω—Ç–∞
- –æ–∫–æ–ª–æ: —Å–∏–∂—É –æ–∫–æ–ª–æ –æ–∫–Ω–∞

### 2.3 –î–∞—Ç–µ–ª—å–Ω—ã–π –ø–∞–¥–µ–∂ (Dativus)

**–í–æ–ø—Ä–æ—Å—ã:** –∫–æ–º—É? —á–µ–º—É?
**–û—Å–Ω–æ–≤–Ω–∞—è —Ä–æ–ª—å:** –∫–æ—Å–≤–µ–Ω–Ω–æ–µ –¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ, –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏—è

**–ü—Ä–∏–º–µ—Ä—ã:**
- –î–∞–ª –∫–Ω–∏–≥—É –¥—Ä—É–≥—É (–∫–æ—Å–≤–µ–Ω–Ω–æ–µ –¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ)
- –ü–æ–º–æ–≥–∞—é –º–∞–º–µ (–∫–æ—Å–≤–µ–Ω–Ω–æ–µ –¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ)
- –ï–º—É 20 –ª–µ—Ç (–≤–æ–∑—Ä–∞—Å—Ç)
- –ü–æ–¥–æ—à–µ–ª –∫ –¥–æ–º—É (–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ)

**–° –ø—Ä–µ–¥–ª–æ–≥–∞–º–∏:**
- –∫: –ø–æ–¥–æ—à–µ–ª –∫ –¥–æ–º—É, –æ—Ç–Ω–æ—Å–∏—Ç—Å—è –∫ –¥–µ–ª—É
- –ø–æ: –≥—É–ª—è—é –ø–æ –ø–∞—Ä–∫—É, —Ä–∞–±–æ—Ç–∞—é –ø–æ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏
- –±–ª–∞–≥–æ–¥–∞—Ä—è: –∑–∞–∫–æ–Ω—á–∏–ª –±–ª–∞–≥–æ–¥–∞—Ä—è –ø–æ–º–æ—â–∏
- –≤–æ–ø—Ä–µ–∫–∏: —Å–¥–µ–ª–∞–ª –≤–æ–ø—Ä–µ–∫–∏ —Å–æ–≤–µ—Ç—É
- —Å–æ–≥–ª–∞—Å–Ω–æ: —Å–æ–≥–ª–∞—Å–Ω–æ –ø—Ä–∏–∫–∞–∑—É

### 2.4 –í–∏–Ω–∏—Ç–µ–ª—å–Ω—ã–π –ø–∞–¥–µ–∂ (Accusativus)

**–í–æ–ø—Ä–æ—Å—ã:** –∫–æ–≥–æ? —á—Ç–æ?
**–û—Å–Ω–æ–≤–Ω–∞—è —Ä–æ–ª—å:** –ø—Ä—è–º–æ–µ –¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ, –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –æ–±—ä–µ–∫—Ç –¥–µ–π—Å—Ç–≤–∏—è

**–ü—Ä–∏–º–µ—Ä—ã:**
- –ß–∏—Ç–∞—é –∫–Ω–∏–≥—É (–ø—Ä—è–º–æ–µ –¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ)
- –í–∏–∂—É –¥—Ä—É–≥–∞ (–ø—Ä—è–º–æ–µ –¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ)
- –õ—é–±–ª—é –º—É–∑—ã–∫—É (–æ–±—ä–µ–∫—Ç —á—É–≤—Å—Ç–≤–∞)
- –ñ–¥—É –∞–≤—Ç–æ–±—É—Å–∞ (–æ–±—ä–µ–∫—Ç –æ–∂–∏–¥–∞–Ω–∏—è)

**–í–∞–∂–Ω–æ–µ –ø—Ä–∞–≤–∏–ª–æ –æ–¥—É—à–µ–≤–ª–µ–Ω–Ω–æ—Å—Ç–∏:**
- –û–¥—É—à–µ–≤–ª–µ–Ω–Ω—ã–µ —Å—É—â–µ—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ: —Ñ–æ—Ä–º–∞ —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å –¥–∞—Ç–µ–ª—å–Ω—ã–º –ø–∞–¥–µ–∂–æ–º
- –ù–µ–æ–¥—É—à–µ–≤–ª–µ–Ω–Ω—ã–µ —Å—É—â–µ—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ: —Ñ–æ—Ä–º–∞ —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å –∏–º–µ–Ω–∏—Ç–µ–ª—å–Ω—ã–º –ø–∞–¥–µ–∂–æ–º

**–ò—Å–∫–ª—é—á–µ–Ω–∏—è:** –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ —Å–ª–æ–≤–∞ —Ç–∏–ø–∞ "–º–∞—Ç—å", "–¥–æ—á—å" –∏–º–µ—é—Ç –æ—Å–æ–±—ã–µ —Ñ–æ—Ä–º—ã –≤ –≤–∏–Ω–∏—Ç–µ–ª—å–Ω–æ–º –ø–∞–¥–µ–∂–µ.

### 2.5 –¢–≤–æ—Ä–∏—Ç–µ–ª—å–Ω—ã–π –ø–∞–¥–µ–∂ (Instrumentalis)

**–í–æ–ø—Ä–æ—Å—ã:** –∫–µ–º? —á–µ–º?
**–û—Å–Ω–æ–≤–Ω–∞—è —Ä–æ–ª—å:** –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–µ–π—Å—Ç–≤–∏—è, —Å–ø–æ—Å–æ–±, —Å–æ–≤–º–µ—Å—Ç–Ω–æ—Å—Ç—å

**–ü—Ä–∏–º–µ—Ä—ã:**
- –ü–∏—à—É —Ä—É—á–∫–æ–π (–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç)
- –ì–æ–≤–æ—Ä—é —à–µ–ø–æ—Ç–æ–º (—Å–ø–æ—Å–æ–±)
- –ì—É–ª—è—é —Å –¥—Ä—É–≥–æ–º (—Å–æ–≤–º–µ—Å—Ç–Ω–æ—Å—Ç—å)
- –†–∞–±–æ—Ç–∞—é –≤—Ä–∞—á–æ–º (–ø—Ä–æ—Ñ–µ—Å—Å–∏—è)

**–° –ø—Ä–µ–¥–ª–æ–≥–∞–º–∏:**
- —Å/—Å–æ: –ø—å—é —á–∞–π —Å –ª–∏–º–æ–Ω–æ–º, –ø—Ä–∏—à–µ–ª —Å —Ä–∞–±–æ—Ç—ã
- –∑–∞: —Å–∏–∂—É –∑–∞ —Å—Ç–æ–ª–æ–º, –æ—Ç–≤–µ—á–∞—é –∑–∞ —Ä–∞–±–æ—Ç—É
- –ø–æ–¥: –ª–µ–∂—É –ø–æ–¥ –æ–¥–µ—è–ª–æ–º, —Å–∏–∂—É –ø–æ–¥ –¥–µ—Ä–µ–≤–æ–º
- –Ω–∞–¥: –≤–∏—à—É –Ω–∞–¥ –ø—Ä–æ–ø–∞—Å—Ç—å—é, –¥—É–º–∞—é –Ω–∞–¥ –∑–∞–¥–∞—á–µ–π
- –º–µ–∂–¥—É: —Å–∏–∂—É –º–µ–∂–¥—É –¥—Ä—É–∑—å—è–º–∏
- –ø–µ—Ä–µ–¥: —Å—Ç–æ—é –ø–µ—Ä–µ–¥ –¥–æ–º–æ–º

### 2.6 –ü—Ä–µ–¥–ª–æ–∂–Ω—ã–π –ø–∞–¥–µ–∂ (Locativus/Prepositionalis)

**–í–æ–ø—Ä–æ—Å—ã:** –æ –∫–æ–º? –æ —á—ë–º? (–≤ –∫–æ–º? –≤ —á—ë–º? –Ω–∞ –∫–æ–º? –Ω–∞ —á—ë–º?)
**–û—Å–Ω–æ–≤–Ω–∞—è —Ä–æ–ª—å:** –æ–±—Å—Ç–æ—è—Ç–µ–ª—å—Å—Ç–≤–æ –º–µ—Å—Ç–∞, –≤—Ä–µ–º–µ–Ω–∏, —Ç–µ–º–∞ —Ä–∞–∑–≥–æ–≤–æ—Ä–∞

**–ü—Ä–∏–º–µ—Ä—ã:**
- –ñ–∏–≤—É –≤ –¥–æ–º–µ (–º–µ—Å—Ç–æ)
- –ü—Ä–∏–µ—Ö–∞–ª –≤ –º–∞–µ (–≤—Ä–µ–º—è)
- –ì–æ–≤–æ—Ä—é –æ –∫–Ω–∏–≥–µ (—Ç–µ–º–∞)
- –î—É–º–∞—é –æ –±—É–¥—É—â–µ–º (—Ç–µ–º–∞)

**–í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å –ø—Ä–µ–¥–ª–æ–≥–∞–º–∏:**
- –≤/–≤–æ: –∂–∏–≤—É –≤ –≥–æ—Ä–æ–¥–µ, –≤–µ—Ä—é –≤ —É—Å–ø–µ—Ö
- –Ω–∞: –ª–µ–∂—É –Ω–∞ –¥–∏–≤–∞–Ω–µ, —É—á—É—Å—å –Ω–∞ –æ—Ç–ª–∏—á–Ω–æ
- –æ/–æ–±: –≥–æ–≤–æ—Ä—é –æ —Ä–∞–±–æ—Ç–µ, –¥—É–º–∞—é –æ–± –æ—Ç–¥—ã—Ö–µ
- –ø—Ä–∏: —Ä–∞–±–æ—Ç–∞—é –ø—Ä–∏ —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç–µ, —Å–ª—É—á–∏–ª–æ—Å—å –ø—Ä–∏ —Ü–∞—Ä–µ

## –ì–ª–∞–≤–∞ 3: –ü–∞–¥–µ–∂–Ω—ã–µ –æ–∫–æ–Ω—á–∞–Ω–∏—è

### 3.1 –û–±—â–∏–µ –ø—Ä–∞–≤–∏–ª–∞ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –ø–∞–¥–µ–∂–µ–π

#### –î–ª—è —Å—É—â–µ—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö:

**–ò–º–µ–Ω–∏—Ç–µ–ª—å–Ω—ã–π –ø–∞–¥–µ–∂** - –∏—Å—Ö–æ–¥–Ω–∞—è —Ñ–æ—Ä–º–∞:
- —Å—Ç–æ–ª, –∫–Ω–∏–≥–∞, –º–æ—Ä–µ, –æ–∫–Ω–æ

**–†–æ–¥–∏—Ç–µ–ª—å–Ω—ã–π –ø–∞–¥–µ–∂:**
- –ú—É–∂—Å–∫–æ–π —Ä–æ–¥: -–∞/-—è (—Å—Ç–æ–ª–∞, –º—É–∑–µ—è), -–æ–≤/-–µ–≤ (—Å—Ç–æ–ª–æ–≤, –º—É–∑–µ–µ–≤)
- –ñ–µ–Ω—Å–∫–∏–π —Ä–æ–¥: -—ã/-–∏ (–∫–Ω–∏–≥–∏, —Ç–µ—Ç—Ä–∞–¥–∏), -–µ–π (–ø–µ—Å–µ–Ω)
- –°—Ä–µ–¥–Ω–∏–π —Ä–æ–¥: -–∞/-—è (–æ–∫–Ω–∞, –º–æ—Ä—è)

**–î–∞—Ç–µ–ª—å–Ω—ã–π –ø–∞–¥–µ–∂:**
- –ú—É–∂—Å–∫–æ–π/—Å—Ä–µ–¥–Ω–∏–π: -—É/-—é (—Å—Ç–æ–ª—É, –º–æ—Ä—é)
- –ñ–µ–Ω—Å–∫–∏–π: -–µ/-–µ (–∫–Ω–∏–≥–µ, —Ç–µ—Ç—Ä–∞–¥–∏)
- –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ: -–∞–º/-—è–º (—Å—Ç–æ–ª–∞–º, –º—É–∑–µ—è–º)

**–í–∏–Ω–∏—Ç–µ–ª—å–Ω—ã–π –ø–∞–¥–µ–∂:**
- –û–¥—É—à–µ–≤–ª–µ–Ω–Ω—ã–µ: –∫–∞–∫ –¥–∞—Ç–µ–ª—å–Ω—ã–π –ø–∞–¥–µ–∂
- –ù–µ–æ–¥—É—à–µ–≤–ª–µ–Ω–Ω—ã–µ: –∫–∞–∫ –∏–º–µ–Ω–∏—Ç–µ–ª—å–Ω—ã–π –ø–∞–¥–µ–∂

**–¢–≤–æ—Ä–∏—Ç–µ–ª—å–Ω—ã–π –ø–∞–¥–µ–∂:**
- –ú—É–∂—Å–∫–æ–π/—Å—Ä–µ–¥–Ω–∏–π: -–æ–º/-–µ–º (—Å—Ç–æ–ª–æ–º, –º–æ—Ä–µ–º)
- –ñ–µ–Ω—Å–∫–∏–π: -–æ–π/-–µ–π (–∫–Ω–∏–≥–æ–π, —Ç–µ—Ç—Ä–∞–¥—å—é)
- –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ: -–∞–º–∏/-—è–º–∏ (—Å—Ç–æ–ª–∞–º–∏, –º—É–∑–µ—è–º–∏)

**–ü—Ä–µ–¥–ª–æ–∂–Ω—ã–π –ø–∞–¥–µ–∂:**
- –ú—É–∂—Å–∫–æ–π/—Å—Ä–µ–¥–Ω–∏–π: -–µ/-–µ (–≤ —Å—Ç–æ–ª–µ, –æ –º–æ—Ä–µ)
- –ñ–µ–Ω—Å–∫–∏–π: -–µ/-–µ (–≤ –∫–Ω–∏–≥–µ, –æ —Ç–µ—Ç—Ä–∞–¥–∏)
- –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ: -–∞—Ö/-—è—Ö (–≤ —Å—Ç–æ–ª–∞—Ö, –æ –º—É–∑–µ—è—Ö)

### 3.2 –û—Å–æ–±—ã–µ —Å–ª—É—á–∞–∏

#### –°—É—â–µ—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ –Ω–∞ -–∏—è, -–∏–µ, -–∏–π:
- –∞—Ä–º–∏—è ‚Üí –∞—Ä–º–∏–∏ (–Ω–µ –∞—Ä–º–∏–π!)
- —Å–∞–Ω–∞—Ç–æ—Ä–∏–π ‚Üí —Å–∞–Ω–∞—Ç–æ—Ä–∏—é (–Ω–µ —Å–∞–Ω–∞—Ç–æ—Ä–∏—é!)

#### –°—É—â–µ—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ –Ω–∞ -–º—è:
- –≤—Ä–µ–º—è ‚Üí –≤—Ä–µ–º–µ–Ω–∏ (–Ω–µ –≤—Ä–µ–º—ë–Ω!)
- –ø–ª–µ–º—è ‚Üí –ø–ª–µ–º–µ–Ω–∏

#### –ù–µ–∏–∑–º–µ–Ω—è–µ–º—ã–µ —Å—É—â–µ—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ:
- –ø–∞–ª—å—Ç–æ, –º–µ—Ç—Ä–æ, –∫–∏–Ω–æ - –Ω–µ –∏–∑–º–µ–Ω—è—é—Ç—Å—è –ø–æ –ø–∞–¥–µ–∂–∞–º
- –∫–æ—Ñ–µ, —Ä–∞–¥–∏–æ - –º–æ–≥—É—Ç –∏–º–µ—Ç—å —Ä–∞–∑–≥–æ–≤–æ—Ä–Ω—ã–µ —Ñ–æ—Ä–º—ã

## –ì–ª–∞–≤–∞ 4: –ü–∞–¥–µ–∂–∏ –∏ –¥—Ä—É–≥–∏–µ —á–∞—Å—Ç–∏ —Ä–µ—á–∏

### 4.1 –ü—Ä–∏–ª–∞–≥–∞—Ç–µ–ª—å–Ω—ã–µ –≤ –ø–∞–¥–µ–∂–∞—Ö

–ü—Ä–∏–ª–∞–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Å–æ–≥–ª–∞—Å—É—é—Ç—Å—è —Å —Å—É—â–µ—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–º–∏ –≤–æ –≤—Å–µ—Ö –ø–∞–¥–µ–∂–∞—Ö:

**–ò.–ø.:** –∫—Ä–∞—Å–Ω—ã–π —à–∞—Ä
**–†.–ø.:** –∫—Ä–∞—Å–Ω–æ–≥–æ —à–∞—Ä–∞
**–î.–ø.:** –∫—Ä–∞—Å–Ω–æ–º—É —à–∞—Ä—É
**–í.–ø.:** –∫—Ä–∞—Å–Ω—ã–π —à–∞—Ä
**–¢.–ø.:** –∫—Ä–∞—Å–Ω—ã–º —à–∞—Ä–æ–º
**–ü.–ø.:** –æ –∫—Ä–∞—Å–Ω–æ–º —à–∞—Ä–µ

### 4.2 –ú–µ—Å—Ç–æ–∏–º–µ–Ω–∏—è

–ú–µ—Å—Ç–æ–∏–º–µ–Ω–∏—è –∏–º–µ—é—Ç —Å–≤–æ–∏ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –≤ –ø–∞–¥–µ–∂–∞—Ö:

**—è ‚Üí –º–µ–Ω—è, –º–Ω–µ, –º–Ω–æ–π, –æ–±–æ –º–Ω–µ**
**—Ç—ã ‚Üí —Ç–µ–±—è, —Ç–µ–±–µ, —Ç–æ–±–æ–π, –æ —Ç–µ–±–µ**
**–æ–Ω ‚Üí –µ–≥–æ, –µ–º—É, –∏–º, –æ –Ω—ë–º**
**–æ–Ω–∞ ‚Üí –µ—ë, –µ–π, –µ—é, –æ –Ω–µ–π**
**–æ–Ω–æ ‚Üí –µ–≥–æ, –µ–º—É, –∏–º, –æ –Ω—ë–º**
**–º—ã ‚Üí –Ω–∞—Å, –Ω–∞–º, –Ω–∞–º–∏, –æ –Ω–∞—Å**
**–≤—ã ‚Üí –≤–∞—Å, –≤–∞–º, –≤–∞–º–∏, –æ –≤–∞—Å**
**–æ–Ω–∏ ‚Üí –∏—Ö, –∏–º, –∏–º–∏, –æ –Ω–∏—Ö**

### 4.3 –ß–∏—Å–ª–∏—Ç–µ–ª—å–Ω—ã–µ

–ö–æ–ª–∏—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —á–∏—Å–ª–∏—Ç–µ–ª—å–Ω—ã–µ –∏–º–µ—é—Ç –æ—Å–æ–±—ã–µ —Ñ–æ—Ä–º—ã:

**–¥–≤–∞ ‚Üí –¥–≤—É—Ö, –¥–≤–æ–∏–º, –¥–≤—É–º—è, –æ –¥–≤–æ–∏—Ö**
**—Ç—Ä–∏, —á–µ—Ç—ã—Ä–µ ‚Üí —Ç—Ä—ë—Ö, —Ç—Ä–æ–∏–º, —Ç—Ä–µ–º—è, –æ —Ç—Ä—ë—Ö**
**–ø—è—Ç—å-–¥–µ—Å—è—Ç—å ‚Üí –ø—è—Ç–∏, –ø—è—Ç–∏, –ø—è—Ç—å—é, –æ –ø—è—Ç–∏**

## –ì–ª–∞–≤–∞ 5: –¢–∏–ø–∏—á–Ω—ã–µ –æ—à–∏–±–∫–∏ –∏ –∫–∞–∫ –∏—Ö –∏–∑–±–µ–∂–∞—Ç—å

### 5.1 –°–º–µ—à–µ–Ω–∏–µ –ø–∞–¥–µ–∂–µ–π

**–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ:** "–Ø –∏–Ω—Ç–µ—Ä–µ—Å—É—é—Å—å –æ –º—É–∑—ã–∫–µ"
**–ü—Ä–∞–≤–∏–ª—å–Ω–æ:** "–Ø –∏–Ω—Ç–µ—Ä–µ—Å—É—é—Å—å –º—É–∑—ã–∫–æ–π" (–¢.–ø. –±–µ–∑ –ø—Ä–µ–¥–ª–æ–≥–∞)

**–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ:** "–ü—Ä–∏–µ—Ö–∞–ª –Ω–∞ –≤–æ–∫–∑–∞–ª"
**–ü—Ä–∞–≤–∏–ª—å–Ω–æ:** "–ü—Ä–∏–µ—Ö–∞–ª –Ω–∞ –≤–æ–∫–∑–∞–ª" (–í.–ø. —Å –ø—Ä–µ–¥–ª–æ–≥–æ–º "–Ω–∞")

### 5.2 –û—à–∏–±–∫–∏ –≤ –æ–∫–æ–Ω—á–∞–Ω–∏—è—Ö

**–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ:** "–£ –º–æ–µ–≥–æ –¥—Ä—É–≥–∞" (–Ω—É–∂–µ–Ω –†.–ø.)
**–ü—Ä–∞–≤–∏–ª—å–Ω–æ:** "–£ –º–æ–µ–≥–æ –¥—Ä—É–≥–∞" ‚úì

**–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ:** "–ë–ª–∞–≥–æ–¥–∞—Ä–µ–Ω –ø–æ–¥—Ä—É–≥–µ" (–Ω—É–∂–µ–Ω –î.–ø.)
**–ü—Ä–∞–≤–∏–ª—å–Ω–æ:** "–ë–ª–∞–≥–æ–¥–∞—Ä–µ–Ω –ø–æ–¥—Ä—É–≥–µ" ‚úì

### 5.3 –ü—Ä–µ–¥–ª–æ–≥–∏ –∏ –ø–∞–¥–µ–∂–∏

**–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ:** "–°–æ–≥–ª–∞—Å–Ω–æ –≥—Ä–∞—Ñ–∏–∫–∞" (–Ω—É–∂–µ–Ω –†.–ø.)
**–ü—Ä–∞–≤–∏–ª—å–Ω–æ:** "–°–æ–≥–ª–∞—Å–Ω–æ –≥—Ä–∞—Ñ–∏–∫—É" ‚úì

**–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ:** "–ë–ª–∞–≥–æ–¥–∞—Ä—è –¥–æ–∂–¥—é" (–î.–ø.)
**–ü—Ä–∞–≤–∏–ª—å–Ω–æ:** "–ë–ª–∞–≥–æ–¥–∞—Ä—è –¥–æ–∂–¥—é" ‚úì

## –ì–ª–∞–≤–∞ 6: –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è

### –£–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ 1: –û–ø—Ä–µ–¥–µ–ª–∏—Ç–µ –ø–∞–¥–µ–∂–∏

1. –°—Ç—É–¥–µ–Ω—Ç —á–∏—Ç–∞–µ—Ç –∫–Ω–∏–≥—É. (–ò.–ø., –í.–ø.)
2. –Ø –¥–∞–ª –ø–æ–¥–∞—Ä–æ–∫ —Å–µ—Å—Ç—Ä–µ. (–í.–ø., –î.–ø.)
3. –ú—ã –∂–∏–≤–µ–º –≤ –±–æ–ª—å—à–æ–º –≥–æ—Ä–æ–¥–µ. (–ü.–ø.)
4. –û–Ω —Ä–∞–±–æ—Ç–∞–µ—Ç –≤—Ä–∞—á–æ–º. (–¢.–ø.)
5. –£ –º–µ–Ω—è –Ω–µ—Ç –≤—Ä–µ–º–µ–Ω–∏. (–†.–ø.)

### –£–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ 2: –ò–∑–º–µ–Ω–∏—Ç–µ –ø–æ –ø–∞–¥–µ–∂–∞–º

**–î–æ–º** (–ò.–ø.)
- –†.–ø.: –¥–æ–º–∞
- –î.–ø.: –¥–æ–º—É
- –í.–ø.: –¥–æ–º
- –¢.–ø.: –¥–æ–º–æ–º
- –ü.–ø.: –æ –¥–æ–º–µ

**–ö–Ω–∏–≥–∞** (–ò.–ø.)
- –†.–ø.: –∫–Ω–∏–≥–∏
- –î.–ø.: –∫–Ω–∏–≥–µ
- –í.–ø.: –∫–Ω–∏–≥—É
- –¢.–ø.: –∫–Ω–∏–≥–æ–π
- –ü.–ø.: –æ –∫–Ω–∏–≥–µ

### –£–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ 3: –í—Å—Ç–∞–≤—å—Ç–µ –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã–µ –æ–∫–æ–Ω—á–∞–Ω–∏—è

1. –Ø –∂–∏–≤—É –≤ –Ω–æ–≤__ –¥–æ–º__. (–ü.–ø.)
2. –û–Ω –ø–æ–¥–∞—Ä–∏–ª —Ü–≤–µ—Ç__ —Å–µ—Å—Ç—Ä__. (–í.–ø., –î.–ø.)
3. –ú—ã –≥—É–ª—è–ª–∏ –ø–æ —à–∏—Ä–æ–∫__ —É–ª–∏—Ü__. (–î.–ø.)
4. –û–Ω–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ –±–æ–ª—å—à__ –∫–æ–º–ø–∞–Ω__. (–ü.–ø.)
5. –Ø –¥—É–º–∞—é –æ —Å–≤–æ__ –±—É–¥—É—â__. (–ü.–ø.)

### –£–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ 4: –í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç

1. –Ø –∏–Ω—Ç–µ—Ä–µ—Å—É—é—Å—å (–æ –º—É–∑—ã–∫–µ/–º—É–∑—ã–∫–æ–π/–º—É–∑—ã–∫–∏)
2. –ü—Ä–∏–µ—Ö–∞–ª (–Ω–∞ –≤–æ–∫–∑–∞–ª/–Ω–∞ –≤–æ–∫–∑–∞–ª–µ/–≤ –≤–æ–∫–∑–∞–ª)
3. –ë–ª–∞–≥–æ–¥–∞—Ä–µ–Ω (—Ä–æ–¥–∏—Ç–µ–ª—è–º/—Ä–æ–¥–∏—Ç–µ–ª—è–º–∏/–æ —Ä–æ–¥–∏—Ç–µ–ª—è—Ö)
4. –°–æ–≥–ª–∞—Å–Ω–æ (–ø—Ä–∏–∫–∞–∑—É/–ø—Ä–∏–∫–∞–∑–æ–º/–ø—Ä–∏–∫–∞–∑–∞)
5. –í–æ–ø—Ä–µ–∫–∏ (—Å–æ–≤–µ—Ç—É/—Å–æ–≤–µ—Ç–æ–º/—Å–æ–≤–µ—Ç–∞)

## –ì–ª–∞–≤–∞ 7: –ü–∞–¥–µ–∂–∏ –≤ —Ö—É–¥–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–æ–π –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä–µ

### 7.1 –°—Ç–∏–ª–∏—Å—Ç–∏—á–µ—Å–∫–∞—è —Ä–æ–ª—å –ø–∞–¥–µ–∂–µ–π

–ü–∞–¥–µ–∂–∏ –º–æ–≥—É—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å –æ—Å–æ–±—É—é –≤—ã—Ä–∞–∑–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:

**–ò–Ω–≤–µ—Ä—Å–∏—è:** "–ù–µ –≤–µ—Ç–µ—Ä –±—É—à—É–µ—Ç –Ω–∞–¥ –±–æ—Ä–æ–º" (–ò.–ø. –≤–º–µ—Å—Ç–æ –†.–ø.)
**–ú–Ω–æ–≥–æ—Å—Ç—É–ø–µ–Ω—á–∞—Ç—ã–µ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏:** "–î—Ä—É–≥ –º–æ–µ–≥–æ –æ—Ç—Ü–∞" (—Ü–µ–ø–æ—á–∫–∞ –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–Ω–æ—Å—Ç–∏)
**–ü–æ—ç—Ç–∏—á–µ—Å–∫–∏–µ –æ–±–æ—Ä–æ—Ç—ã:** "–û –≤—Ä–µ–º–µ–Ω–∏ –∏ –æ —Å–µ–±–µ" (–ü.–ø. –¥–ª—è —Ñ–∏–ª–æ—Å–æ—Ñ—Å–∫–∏—Ö —Ä–∞–∑–º—ã—à–ª–µ–Ω–∏–π)

### 7.2 –ü–∞–¥–µ–∂–∏ –≤ –ø–æ—Å–ª–æ–≤–∏—Ü–∞—Ö –∏ –ø–æ–≥–æ–≤–æ—Ä–∫–∞—Ö

- "–í–µ–∫ –∂–∏–≤–∏ - –≤–µ–∫ —É—á–∏—Å—å" (–ò.–ø. –¥–ª—è –≤–µ—á–Ω–æ—Å—Ç–∏)
- "–ë–µ–∑ —Ç—Ä—É–¥–∞ –Ω–µ—Ç –ø–ª–æ–¥–∞" (–†.–ø. –¥–ª—è –æ—Ç—Ä–∏—Ü–∞–Ω–∏—è)
- "–î–µ–ª—É –≤—Ä–µ–º—è, –ø–æ—Ç–µ—Ö–µ —á–∞—Å" (–î.–ø. –¥–ª—è –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è)
- "–í–∑—è–ª—Å—è –∑–∞ –≥—É–∂ - –Ω–µ –≥–æ–≤–æ—Ä–∏, —á—Ç–æ –Ω–µ –¥—é–∂" (–í.–ø. –¥–ª—è –æ–±—ä–µ–∫—Ç–∞)
- "–¢–∏—à–µ –µ–¥–µ—à—å - –¥–∞–ª—å—à–µ –±—É–¥–µ—à—å" (–¢.–ø. –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è)
- "–í–∑—è—Ç–æ —Å –±–æ—é" (–ü.–ø. –¥–ª—è –æ–±—Å—Ç–æ—è—Ç–µ–ª—å—Å—Ç–≤–∞)

## –ì–ª–∞–≤–∞ 8: –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ç–µ–Ω–¥–µ–Ω—Ü–∏–∏ –≤ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ –ø–∞–¥–µ–∂–µ–π

### 8.1 –†–∞–∑–≥–æ–≤–æ—Ä–Ω—ã–π —Å—Ç–∏–ª—å

–í —Ä–∞–∑–≥–æ–≤–æ—Ä–Ω–æ–π —Ä–µ—á–∏ –ø–∞–¥–µ–∂–∏ —á–∞—Å—Ç–æ —É–ø—Ä–æ—â–∞—é—Ç—Å—è:
- "–£ –º–æ–µ–π –º–∞–º—ã" ‚Üí "–£ –º–∞–º—ã"
- "–í –±–æ–ª—å—à–æ–º –≥–æ—Ä–æ–¥–µ" ‚Üí "–í –≥–æ—Ä–æ–¥–µ"
- "–° –º–æ–∏–º –¥—Ä—É–≥–æ–º" ‚Üí "–° –¥—Ä—É–≥–æ–º"

### 8.2 –ò–Ω—Ç–µ—Ä–Ω–µ—Ç-–∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è

–í —Å–æ—Ü—Å–µ—Ç—è—Ö –∏ –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä–∞—Ö:
- –≠–∫–æ–Ω–æ–º–∏—è –ø–∞–¥–µ–∂–µ–π: "–í—Å—Ç—Ä–µ—Ç–∏–º—Å—è –∑–∞–≤—Ç—Ä–∞?"
- –°–º–∞–π–ª–∏–∫–∏ –≤–º–µ—Å—Ç–æ –ø–∞–¥–µ–∂–Ω—ã—Ö –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–π
- –ê–Ω–≥–ª–∏–π—Å–∫–∏–µ –∑–∞–∏–º—Å—Ç–≤–æ–≤–∞–Ω–∏—è –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è

### 8.3 –ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π —è–∑—ã–∫

–í –Ω–∞—É—á–Ω–æ–π –∏ –¥–µ–ª–æ–≤–æ–π —Ä–µ—á–∏ –ø–∞–¥–µ–∂–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Å—Ç—Ä–æ–≥–æ:
- "–í —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å –¥–æ–≥–æ–≤–æ—Ä–æ–º" (–¢.–ø.)
- "–°–æ–≥–ª–∞—Å–Ω–æ —Ä–∞—Å–ø–æ—Ä—è–∂–µ–Ω–∏—é" (–î.–ø.)
- "–í–æ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏–µ –ø—Ä–∏–∫–∞–∑–∞" (–í.–ø.)

## –ì–ª–∞–≤–∞ 9: –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–ü–∞–¥–µ–∂–∏ - —ç—Ç–æ —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç —Ä—É—Å—Å–∫–æ–≥–æ —è–∑—ã–∫–∞, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∑–≤–æ–ª—è–µ—Ç —Ç–æ—á–Ω–æ –∏ –∫—Ä–∞—Å–∏–≤–æ –≤—ã—Ä–∞–∂–∞—Ç—å –º—ã—Å–ª–∏. –û—Å–≤–æ–∏–≤ –ø–∞–¥–µ–∂–∏, –≤—ã —Å–º–æ–∂–µ—Ç–µ:

1. –°—Ç—Ä–æ–∏—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è
2. –ü–æ–Ω–∏–º–∞—Ç—å —Å–ª–æ–∂–Ω—ã–µ —Ç–µ–∫—Å—Ç—ã
3. –ü–∏—Å–∞—Ç—å –≥—Ä–∞–º–æ—Ç–Ω–æ –∏ —Å—Ç–∏–ª—å–Ω–æ
4. –û–±—â–∞—Ç—å—Å—è –±–µ–∑ —è–∑—ã–∫–æ–≤—ã—Ö –±–∞—Ä—å–µ—Ä–æ–≤

–ü–æ–º–Ω–∏—Ç–µ: –ø–∞–¥–µ–∂–∏ - —ç—Ç–æ –Ω–µ —Å–∫—É—á–Ω–∞—è –≥—Ä–∞–º–º–∞—Ç–∏–∫–∞, –∞ –∫–ª—é—á –∫ –±–æ–≥–∞—Ç—Å—Ç–≤—É —Ä—É—Å—Å–∫–æ–≥–æ —è–∑—ã–∫–∞!

## –ì–ª–∞–≤–∞ 10: –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã

### 10.1 –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏
- "–†—É—Å—Å–∫–∞—è –≥—Ä–∞–º–º–∞—Ç–∏–∫–∞" –ø–æ–¥ —Ä–µ–¥–∞–∫—Ü–∏–µ–π –ù.–Æ. –®–≤–µ–¥–æ–≤–æ–π
- "–°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π —Ä—É—Å—Å–∫–∏–π —è–∑—ã–∫" –ø–æ–¥ —Ä–µ–¥–∞–∫—Ü–∏–µ–π –õ.–ê. –ù–æ–≤–∏–∫–æ–≤–∞
- –û–Ω–ª–∞–π–Ω-—Ç–µ—Å—Ç—ã –ø–æ –ø–∞–¥–µ–∂–∞–º –Ω–∞ —Å–∞–π—Ç–µ gramota.ru

### 10.2 –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–∞—è –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä–∞
1. –†–æ–∑–µ–Ω—Ç–∞–ª—å –î.–≠. "–†—É—Å—Å–∫–∏–π —è–∑—ã–∫"
2. –í–∞–ª–≥–∏–Ω–∞ –ù.–°. "–°–∏–Ω—Ç–∞–∫—Å–∏—Å —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ —Ä—É—Å—Å–∫–æ–≥–æ —è–∑—ã–∫–∞"
3. –ë–µ–ª–æ—à–∞–ø–∫–æ–≤–∞ –í.–ê. "–°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π —Ä—É—Å—Å–∫–∏–π —è–∑—ã–∫"

### 10.3 –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —Å–æ–≤–µ—Ç—ã
1. –ß–∏—Ç–∞–π—Ç–µ –≤—Å–ª—É—Ö, –ø—Ä–æ–≥–æ–≤–∞—Ä–∏–≤–∞—è –æ–∫–æ–Ω—á–∞–Ω–∏—è
2. –í–µ–¥–∏—Ç–µ –¥–Ω–µ–≤–Ω–∏–∫ —Å –ø–∞–¥–µ–∂–Ω—ã–º–∏ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è–º–∏
3. –ò–≥—Ä–∞–π—Ç–µ –≤ –∏–≥—Ä—ã —Ç–∏–ø–∞ "–ø–∞–¥–µ–∂–Ω—ã–π –¥–æ–º–∏–Ω–æ"
4. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –º–æ–±–∏–ª—å–Ω—ã–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –¥–ª—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏

–£—Å–ø–µ—Ö–æ–≤ –≤ –∏–∑—É—á–µ–Ω–∏–∏ –ø–∞–¥–µ–∂–µ–π —Ä—É—Å—Å–∫–æ–≥–æ —è–∑—ã–∫–∞!
    `,
    examples: [
      '–ö–Ω–∏–≥–∞ (–ò.–ø.) –ª–µ–∂–∏—Ç –Ω–∞ —Å—Ç–æ–ª–µ.',
      '–£ —Å—Ç—É–¥–µ–Ω—Ç–∞ (–†.–ø.) –µ—Å—Ç—å –∫–Ω–∏–≥–∞.',
      '–î–∞–ª –∫–Ω–∏–≥—É –¥—Ä—É–≥—É (–î.–ø.).',
      '–í–∏–∂—É –∫–Ω–∏–≥—É (–í.–ø.) –Ω–∞ —Å—Ç–æ–ª–µ.',
      '–ü–∏—à—É —Ä—É—á–∫–æ–π (–¢.–ø.).',
      '–ì–æ–≤–æ—Ä—é –æ –∫–Ω–∏–≥–µ (–ü.–ø.).',
      '–ú–æ—Å–∫–≤–∞ - —Å—Ç–æ–ª–∏—Ü–∞ –†–æ—Å—Å–∏–∏ (–ò.–ø. –≤ –Ω–∞–∑—ã–≤–Ω–æ–º –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–∏)',
      '–ù–µ—Ç –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞ —Ä–∞–∑–º—ã—à–ª–µ–Ω–∏—è (–†.–ø. –æ—Ç—Ä–∏—Ü–∞–Ω–∏—è)',
      '–ü–æ–¥–æ—à–µ–ª –∫ –æ–∫–Ω—É (–î.–ø. —Å –ø—Ä–µ–¥–ª–æ–≥–æ–º)',
      '–õ—é–±–ª—é –∫–ª–∞—Å—Å–∏—á–µ—Å–∫—É—é –º—É–∑—ã–∫—É (–í.–ø. –æ–±—ä–µ–∫—Ç–∞ —á—É–≤—Å—Ç–≤–∞)',
      '–†–∞–±–æ—Ç–∞—é —É—á–∏—Ç–µ–ª–µ–º (–¢.–ø. –ø—Ä–æ—Ñ–µ—Å—Å–∏–∏)',
      '–î—É–º–∞—é –æ –±—É–¥—É—â–µ–º (–ü.–ø. —Ç–µ–º—ã)',
      '–í —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å –ø–ª–∞–Ω–æ–º (–¢.–ø. —Å –ø—Ä–µ–¥–ª–æ–≥–æ–º)',
      '–ë–ª–∞–≥–æ–¥–∞—Ä—è –ø–æ–¥–¥–µ—Ä–∂–∫–µ (–î.–ø. —Å –ø—Ä–µ–¥–ª–æ–≥–æ–º)',
      '–í–æ–ø—Ä–µ–∫–∏ –æ–∂–∏–¥–∞–Ω–∏—è–º (–î.–ø. —Å –ø—Ä–µ–¥–ª–æ–≥–æ–º)',
      '–°–æ–≥–ª–∞—Å–Ω–æ –¥–æ–≥–æ–≤–æ—Ä—É (–î.–ø. —Å –ø—Ä–µ–¥–ª–æ–≥–æ–º)',
      '–í–æ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏–µ —Ä–∞—Å–ø–æ—Ä—è–∂–µ–Ω–∏—è (–í.–ø. —Å –ø—Ä–µ–¥–ª–æ–≥–æ–º)',
      '–û –≤—Ä–µ–º–µ–Ω–∏ –∏ –æ —Å–µ–±–µ (–ü.–ø. —Ñ–∏–ª–æ—Å–æ—Ñ—Å–∫–∏–π)',
      '–í–µ–∫ –∂–∏–≤–∏ - –≤–µ–∫ —É—á–∏—Å—å (–ò.–ø. –¥–ª—è –≤–µ—á–Ω–æ—Å—Ç–∏)',
      '–ë–µ–∑ —Ç—Ä—É–¥–∞ –Ω–µ—Ç –ø–ª–æ–¥–∞ (–†.–ø. –¥–ª—è –æ—Ç—Ä–∏—Ü–∞–Ω–∏—è)',
      '–î–µ–ª—É –≤—Ä–µ–º—è, –ø–æ—Ç–µ—Ö–µ —á–∞—Å (–î.–ø. –¥–ª—è –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è)',
      '–í–∑—è–ª—Å—è –∑–∞ –≥—É–∂ - –Ω–µ –≥–æ–≤–æ—Ä–∏, —á—Ç–æ –Ω–µ –¥—é–∂ (–í.–ø. –¥–ª—è –æ–±—ä–µ–∫—Ç–∞)',
      '–¢–∏—à–µ –µ–¥–µ—à—å - –¥–∞–ª—å—à–µ –±—É–¥–µ—à—å (–¢.–ø. –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è)',
      '–í–∑—è—Ç–æ —Å –±–æ—é (–ü.–ø. –¥–ª—è –æ–±—Å—Ç–æ—è—Ç–µ–ª—å—Å—Ç–≤–∞)',
      '–°—Ç—É–¥–µ–Ω—Ç (–ò.–ø.) —á–∏—Ç–∞–µ—Ç –∏–Ω—Ç–µ—Ä–µ—Å–Ω—É—é –∫–Ω–∏–≥—É (–í.–ø.) –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—è (–†.–ø.)',
      '–Ø (–ò.–ø.) –ø–æ–º–æ–≥–∞—é (–î.–ø.) —Å–≤–æ–µ–º—É –¥—Ä—É–≥—É (–î.–ø.) –≤ —Ç—Ä—É–¥–Ω—É—é –º–∏–Ω—É—Ç—É (–í.–ø.)',
      '–ú—ã (–ò.–ø.) –≥—É–ª—è–µ–º (–¢.–ø.) –ø–æ –∫—Ä–∞—Å–∏–≤–æ–º—É –ø–∞—Ä–∫—É (–î.–ø.) —Å —Å–æ–±–∞–∫–∞–º–∏ (–¢.–ø.)',
      '–û–Ω–∞ (–ò.–ø.) –¥—É–º–∞–µ—Ç (–ü.–ø.) –æ —Å–≤–æ–µ–º –±—É–¥—É—â–µ–º (–ü.–ø.) –∏ –º–µ—á—Ç–∞–µ—Ç (–ü.–ø.) –æ –ø—É—Ç–µ—à–µ—Å—Ç–≤–∏—è—Ö (–ü.–ø.)',
      '–í—Ä–∞—á (–ò.–ø.) –ª–µ—á–∏—Ç (–í.–ø.) –ø–∞—Ü–∏–µ–Ω—Ç–∞ (–í.–ø.) –≤ –±–æ–ª—å–Ω–∏—Ü–µ (–ü.–ø.) –ª–µ–∫–∞—Ä—Å—Ç–≤–∞–º–∏ (–¢.–ø.)',
      '–£—á–∏—Ç–µ–ª—å (–ò.–ø.) –æ–±—ä—è—Å–Ω—è–µ—Ç (–í.–ø.) —É—Ä–æ–∫ (–í.–ø.) —É—á–µ–Ω–∏–∫–∞–º (–î.–ø.) –º–µ–ª–æ–º (–¢.–ø.)',
      '–ü—Ç–∏—Ü–∞ (–ò.–ø.) —Å–∏–¥–∏—Ç (–ü.–ø.) –Ω–∞ –≤–µ—Ç–∫–µ (–ü.–ø.) –¥–µ—Ä–µ–≤–∞ (–†.–ø.) –≤ —Å–∞–¥—É (–ü.–ø.)',
      '–†–µ–±–µ–Ω–æ–∫ (–ò.–ø.) –∏–≥—Ä–∞–µ—Ç (–¢.–ø.) —Å –º—è—á–æ–º (–¢.–ø.) –Ω–∞ –ø–ª–æ—â–∞–¥–∫–µ (–ü.–ø.) —Å –¥—Ä—É–∑—å—è–º–∏ (–¢.–ø.)',
      '–ü–æ–≤–∞—Ä (–ò.–ø.) –≥–æ—Ç–æ–≤–∏—Ç (–í.–ø.) –æ–±–µ–¥ (–í.–ø.) –∏–∑ —Å–≤–µ–∂–∏—Ö –ø—Ä–æ–¥—É–∫—Ç–æ–≤ (–†.–ø.) –Ω–∞ –∫—É—Ö–Ω–µ (–ü.–ø.)',
      '–•—É–¥–æ–∂–Ω–∏–∫ (–ò.–ø.) —Ä–∏—Å—É–µ—Ç (–í.–ø.) –∫–∞—Ä—Ç–∏–Ω—É (–í.–ø.) –º–∞—Å–ª–æ–º (–¢.–ø.) –≤ –º–∞—Å—Ç–µ—Ä—Å–∫–æ–π (–ü.–ø.)',
      '–°–ø–æ—Ä—Ç—Å–º–µ–Ω (–ò.–ø.) —Ç—Ä–µ–Ω–∏—Ä—É–µ—Ç—Å—è (–¢.–ø.) –∫–∞–∂–¥—ã–π –¥–µ–Ω—å (–í.–ø.) –≤ –∑–∞–ª–µ (–ü.–ø.) —Å —Ç—Ä–µ–Ω–µ—Ä–æ–º (–¢.–ø.)',
      '–°—Ç—É–¥–µ–Ω—Ç–∫–∞ (–ò.–ø.) —É—á–∏—Ç—Å—è (–î.–ø.) —Ä—É—Å—Å–∫–æ–º—É —è–∑—ã–∫—É (–î.–ø.) –≤ —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç–µ (–ü.–ø.) —Å —ç–Ω—Ç—É–∑–∏–∞–∑–º–æ–º (–¢.–ø.)',
      '–ü—É—Ç–µ—à–µ—Å—Ç–≤–µ–Ω–Ω–∏–∫ (–ò.–ø.) –∏—Å—Å–ª–µ–¥—É–µ—Ç (–í.–ø.) –¥—Ä–µ–≤–Ω–∏–µ –≥–æ—Ä–æ–¥–∞ (–í.–ø.) —Å —Ä—é–∫–∑–∞–∫–æ–º (–¢.–ø.) –ø–æ –º–∏—Ä—É (–î.–ø.)',
      '–ú—É–∑—ã–∫–∞–Ω—Ç (–ò.–ø.) –∏–≥—Ä–∞–µ—Ç (–í.–ø.) –º–µ–ª–æ–¥–∏—é (–í.–ø.) –Ω–∞ —Å–∫—Ä–∏–ø–∫–µ (–ü.–ø.) –¥–ª—è –ø—É–±–ª–∏–∫–∏ (–î.–ø.)',
      '–°–∞–¥–æ–≤–Ω–∏–∫ (–ò.–ø.) —É—Ö–∞–∂–∏–≤–∞–µ—Ç (–í.–ø.) –∑–∞ —Ü–≤–µ—Ç–∞–º–∏ (–¢.–ø.) –≤ —Å–∞–¥—É (–ü.–ø.) —Å –ª—é–±–æ–≤—å—é (–¢.–ø.)',
      '–ü—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç (–ò.–ø.) –ø–∏—à–µ—Ç (–í.–ø.) –∫–æ–¥ (–í.–ø.) –Ω–∞ –∫–æ–º–ø—å—é—Ç–µ—Ä–µ (–ü.–ø.) –≤—Å—é –Ω–æ—á—å (–í.–ø.)',
      '–ñ—É—Ä–Ω–∞–ª–∏—Å—Ç (–ò.–ø.) –ø–∏—à–µ—Ç (–í.–ø.) —Å—Ç–∞—Ç—å—é (–í.–ø.) –æ —Å–æ–±—ã—Ç–∏–∏ (–ü.–ø.) –¥–ª—è –≥–∞–∑–µ—Ç—ã (–†.–ø.)',
      '–í–æ–¥–∏—Ç–µ–ª—å (–ò.–ø.) –≤–µ–¥–µ—Ç (–í.–ø.) –º–∞—à–∏–Ω—É (–í.–ø.) –ø–æ –¥–æ—Ä–æ–≥–µ (–î.–ø.) –æ—Å—Ç–æ—Ä–æ–∂–Ω–æ (–¢.–ø.)',
      '–§–æ—Ç–æ–≥—Ä–∞—Ñ (–ò.–ø.) —Å–Ω–∏–º–∞–µ—Ç (–í.–ø.) –ø–µ–π–∑–∞–∂ (–í.–ø.) —Ñ–æ—Ç–æ–∞–ø–ø–∞—Ä–∞—Ç–æ–º (–¢.–ø.) –Ω–∞ —Ä–∞—Å—Å–≤–µ—Ç–µ (–ü.–ø.)',
      '–£—á–µ–Ω—ã–π (–ò.–ø.) –ø—Ä–æ–≤–æ–¥–∏—Ç (–í.–ø.) —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç (–í.–ø.) –≤ –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–∏–∏ (–ü.–ø.) —Å –∫–æ–ª–ª–µ–≥–∞–º–∏ (–¢.–ø.)',
      '–ê–∫—Ç–µ—Ä (–ò.–ø.) –∏–≥—Ä–∞–µ—Ç (–í.–ø.) —Ä–æ–ª—å (–í.–ø.) –≤ —Å–ø–µ–∫—Ç–∞–∫–ª–µ (–ü.–ø.) —Å —Ç–∞–ª–∞–Ω—Ç–æ–º (–¢.–ø.)',
      '–ü—Ä–æ–¥–∞–≤–µ—Ü (–ò.–ø.) –æ–±—Å–ª—É–∂–∏–≤–∞–µ—Ç (–í.–ø.) –ø–æ–∫—É–ø–∞—Ç–µ–ª—è (–í.–ø.) –≤ –º–∞–≥–∞–∑–∏–Ω–µ (–ü.–ø.) –≤–µ–∂–ª–∏–≤–æ (–¢.–ø.)',
      '–ê—Ä—Ö–∏—Ç–µ–∫—Ç–æ—Ä (–ò.–ø.) –ø—Ä–æ–µ–∫—Ç–∏—Ä—É–µ—Ç (–í.–ø.) –∑–¥–∞–Ω–∏–µ (–í.–ø.) –¥–ª—è –≥–æ—Ä–æ–¥–∞ (–†.–ø.) —Å —Ñ–∞–Ω—Ç–∞–∑–∏–µ–π (–¢.–ø.)',
      '–ü—Å–∏—Ö–æ–ª–æ–≥ (–ò.–ø.) –ø–æ–º–æ–≥–∞–µ—Ç (–î.–ø.) –ª—é–¥—è–º (–î.–ø.) —Ä–µ—à–∞—Ç—å –ø—Ä–æ–±–ª–µ–º—ã (–í.–ø.) –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ (–¢.–ø.)',
      '–ò—Å—Ç–æ—Ä–∏–∫ (–ò.–ø.) –∏–∑—É—á–∞–µ—Ç (–í.–ø.) –ø—Ä–æ—à–ª–æ–µ (–í.–ø.) –ø–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞–º (–î.–ø.) –≤ –∞—Ä—Ö–∏–≤–µ (–ü.–ø.)',
      '–ë–∏–æ–ª–æ–≥ (–ò.–ø.) –Ω–∞–±–ª—é–¥–∞–µ—Ç (–í.–ø.) –∑–∞ –∂–∏–≤–æ—Ç–Ω—ã–º–∏ (–¢.–ø.) –≤ –ª–µ—Å—É (–ü.–ø.) —Å –±–∏–Ω–æ–∫–ª–µ–º (–¢.–ø.)',
      '–≠–∫–æ–Ω–æ–º–∏—Å—Ç (–ò.–ø.) –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç (–í.–ø.) —Ä—ã–Ω–æ–∫ (–í.–ø.) —Å –ø–æ–º–æ—â—å—é –≥—Ä–∞—Ñ–∏–∫–æ–≤ (–†.–ø.) –≤ –æ—Ñ–∏—Å–µ (–ü.–ø.)',
      '–§–∏–ª–æ—Å–æ—Ñ (–ò.–ø.) —Ä–∞–∑–º—ã—à–ª—è–µ—Ç (–í.–ø.) –æ —Å–º—ã—Å–ª–µ –∂–∏–∑–Ω–∏ (–ü.–ø.) —Å–∏–¥—è (–¢.–ø.) –≤ –∫—Ä–µ—Å–ª–µ (–ü.–ø.)',
      '–ü–æ—ç—Ç (–ò.–ø.) –ø–∏—à–µ—Ç (–í.–ø.) —Å—Ç–∏—Ö–∏ (–í.–ø.) –æ –ª—é–±–≤–∏ (–ü.–ø.) –≤–¥–æ—Ö–Ω–æ–≤–µ–Ω–Ω–æ (–¢.–ø.)',
      '–ò–Ω–∂–µ–Ω–µ—Ä (–ò.–ø.) —Å—Ç—Ä–æ–∏—Ç (–í.–ø.) –º–æ—Å—Ç (–í.–ø.) —á–µ—Ä–µ–∑ —Ä–µ–∫—É (–í.–ø.) —Å —Ä–∞—Å—á–µ—Ç–∞–º–∏ (–¢.–ø.)',
      '–Æ—Ä–∏—Å—Ç (–ò.–ø.) –∑–∞—â–∏—â–∞–µ—Ç (–í.–ø.) –∏–Ω—Ç–µ—Ä–µ—Å—ã –∫–ª–∏–µ–Ω—Ç–∞ (–†.–ø.) –≤ —Å—É–¥–µ (–ü.–ø.) –∞—Ä–≥—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ (–¢.–ø.)',
      '–ú–µ–¥—Å–µ—Å—Ç—Ä–∞ (–ò.–ø.) —É—Ö–∞–∂–∏–≤–∞–µ—Ç (–í.–ø.) –∑–∞ –±–æ–ª—å–Ω—ã–º (–¢.–ø.) –≤ –ø–∞–ª–∞—Ç–µ (–ü.–ø.) –∑–∞–±–æ—Ç–ª–∏–≤–æ (–¢.–ø.)',
      '–ü–µ—Ä–µ–≤–æ–¥—á–∏–∫ (–ò.–ø.) –ø–µ—Ä–µ–≤–æ–¥–∏—Ç (–í.–ø.) —Ç–µ–∫—Å—Ç (–í.–ø.) —Å —Ä—É—Å—Å–∫–æ–≥–æ –Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫–∏–π (–í.–ø.) —Ç–æ—á–Ω–æ (–¢.–ø.)',
      '–°–∫—É–ª—å–ø—Ç–æ—Ä (–ò.–ø.) –≤–∞—è–µ—Ç (–í.–ø.) —Å—Ç–∞—Ç—É—é (–í.–ø.) –∏–∑ –º—Ä–∞–º–æ—Ä–∞ (–†.–ø.) –≤ —Å—Ç—É–¥–∏–∏ (–ü.–ø.)',
      '–î–∏—Ä–µ–∫—Ç–æ—Ä (–ò.–ø.) —Ä—É–∫–æ–≤–æ–¥–∏—Ç (–¢.–ø.) –∫–æ–º–ø–∞–Ω–∏–µ–π (–¢.–ø.) —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ (–¢.–ø.) —Å –∫–æ–º–∞–Ω–¥–æ–π (–¢.–ø.)',
      '–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞—Ä—å (–ò.–ø.) —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç (–í.–ø.) –∫–Ω–∏–≥–∏ (–í.–ø.) —á–∏—Ç–∞—Ç–µ–ª—è–º (–î.–ø.) –ø–æ –∏–Ω—Ç–µ—Ä–µ—Å–∞–º (–î.–ø.)',
      '–ü–∏–ª–æ—Ç (–ò.–ø.) —É–ø—Ä–∞–≤–ª—è–µ—Ç (–¢.–ø.) —Å–∞–º–æ–ª–µ—Ç–æ–º (–¢.–ø.) –≤ –Ω–µ–±–µ (–ü.–ø.) —É–≤–µ—Ä–µ–Ω–Ω–æ (–¢.–ø.)',
      '–î–∏–∑–∞–π–Ω–µ—Ä (–ò.–ø.) —Å–æ–∑–¥–∞–µ—Ç (–í.–ø.) –ª–æ–≥–æ—Ç–∏–ø (–í.–ø.) –¥–ª—è –±—Ä–µ–Ω–¥–∞ (–†.–ø.) –≤ –ø—Ä–æ–≥—Ä–∞–º–º–µ (–ü.–ø.)',
      '–í–µ—Ç–µ—Ä–∏–Ω–∞—Ä (–ò.–ø.) –ª–µ—á–∏—Ç (–í.–ø.) –∂–∏–≤–æ—Ç–Ω—ã—Ö (–í.–ø.) –≤ –∫–ª–∏–Ω–∏–∫–µ (–ü.–ø.) –ø—Ä–µ–ø–∞—Ä–∞—Ç–∞–º–∏ (–¢.–ø.)',
      '–ì–µ–æ–ª–æ–≥ (–ò.–ø.) –∏—Å—Å–ª–µ–¥—É–µ—Ç (–í.–ø.) –ø–æ—Ä–æ–¥—ã (–í.–ø.) –≥–æ—Ä–Ω—ã—Ö –ø–æ—Ä–æ–¥ (–†.–ø.) –≤ –ø–æ–ª–µ (–ü.–ø.)',
      '–ú–∞—Ç–µ–º–∞—Ç–∏–∫ (–ò.–ø.) —Ä–µ—à–∞–µ—Ç (–í.–ø.) –∑–∞–¥–∞—á–∏ (–í.–ø.) —Å —Ñ–æ—Ä–º—É–ª–∞–º–∏ (–¢.–ø.) –Ω–∞ –¥–æ—Å–∫–µ (–ü.–ø.)',
      '–õ–∏–Ω–≥–≤–∏—Å—Ç (–ò.–ø.) –∏–∑—É—á–∞–µ—Ç (–í.–ø.) —è–∑—ã–∫–∏ (–í.–ø.) –Ω–∞—Ä–æ–¥–æ–≤ –º–∏—Ä–∞ (–†.–ø.) —Å –∏–Ω—Ç–µ—Ä–µ—Å–æ–º (–¢.–ø.)',
      '–≠–∫–æ–ª–æ–≥ (–ò.–ø.) –∑–∞—â–∏—â–∞–µ—Ç (–í.–ø.) –æ–∫—Ä—É–∂–∞—é—â—É—é —Å—Ä–µ–¥—É (–í.–ø.) –æ—Ç –∑–∞–≥—Ä—è–∑–Ω–µ–Ω–∏—è (–†.–ø.) –∞–∫—Ç–∏–≤–Ω–æ (–¢.–ø.)',
      '–ê—Å—Ç—Ä–æ–Ω–æ–º (–ò.–ø.) –Ω–∞–±–ª—é–¥–∞–µ—Ç (–í.–ø.) –∑–≤–µ–∑–¥—ã (–í.–ø.) —á–µ—Ä–µ–∑ —Ç–µ–ª–µ—Å–∫–æ–ø (–í.–ø.) –Ω–æ—á—å—é (–¢.–ø.)',
      '–•–∏–º–∏–∫ (–ò.–ø.) –ø—Ä–æ–≤–æ–¥–∏—Ç (–í.–ø.) —Ä–µ–∞–∫—Ü–∏–∏ (–í.–ø.) –≤ –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–∏–∏ (–ü.–ø.) —Å —Ä–µ–∞–∫—Ç–∏–≤–∞–º–∏ (–¢.–ø.)',
      '–§–∏–∑–∏–∫ (–ò.–ø.) –∏–∑—É—á–∞–µ—Ç (–í.–ø.) –∑–∞–∫–æ–Ω—ã –ø—Ä–∏—Ä–æ–¥—ã (–†.–ø.) —Å —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–º–∏ (–¢.–ø.) –≤ –∏–Ω—Å—Ç–∏—Ç—É—Ç–µ (–ü.–ø.)'
    ]
  },
  '0-1': {
    title: '–ò–º–µ–Ω–∏—Ç–µ–ª—å–Ω—ã–π –ø–∞–¥–µ–∂',
    theory: `
# –ò–º–µ–Ω–∏—Ç–µ–ª—å–Ω—ã–π –ø–∞–¥–µ–∂

## –ß—Ç–æ —ç—Ç–æ —Ç–∞–∫–æ–µ?

**–ò–º–µ–Ω–∏—Ç–µ–ª—å–Ω—ã–π –ø–∞–¥–µ–∂** - –ø–µ—Ä–≤—ã–π –∏ –æ—Å–Ω–æ–≤–Ω–æ–π –ø–∞–¥–µ–∂ –≤ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ. –û–Ω –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã **–∫—Ç–æ? —á—Ç–æ?**

## –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è?

- **–ü–æ–¥–ª–µ–∂–∞—â–µ–µ** –≤ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–∏: *–°—Ç—É–¥–µ–Ω—Ç —á–∏—Ç–∞–µ—Ç –∫–Ω–∏–≥—É.*
- **–ò–º–µ–Ω–Ω–∞—è —á–∞—Å—Ç—å —Å–∫–∞–∑—É–µ–º–æ–≥–æ**: *–≠—Ç–æ –º–æ—è –∫–Ω–∏–≥–∞.*
- **–û–±—Ä–∞—â–µ–Ω–∏–µ**: *–ú–∞—à–∞, –ø–æ–¥–æ–π–¥–∏ —Å—é–¥–∞.*
- **–ù–∞–∑–≤–∞–Ω–∏–µ**: *–ú–æ—Å–∫–≤–∞ - —Å—Ç–æ–ª–∏—Ü–∞ –†–æ—Å—Å–∏–∏.*

## –§–æ—Ä–º—ã —Å–ª–æ–≤ –≤ –∏–º–µ–Ω–∏—Ç–µ–ª—å–Ω–æ–º –ø–∞–¥–µ–∂–µ

### –°—É—â–µ—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ:
- **–ú—É–∂—Å–∫–æ–π —Ä–æ–¥**: —Å—Ç–æ–ª, –¥–æ–º, –∫–∞—Ä–∞–Ω–¥–∞—à
- **–ñ–µ–Ω—Å–∫–∏–π —Ä–æ–¥**: –∫–Ω–∏–≥–∞, –º–∞–º–∞, —Ç–µ—Ç—Ä–∞–¥—å
- **–°—Ä–µ–¥–Ω–∏–π —Ä–æ–¥**: –æ–∫–Ω–æ, –º–æ—Ä–µ, –∑–¥–∞–Ω–∏–µ
- **–ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ —á–∏—Å–ª–æ**: —Å—Ç–æ–ª—ã, –∫–Ω–∏–≥–∏, –æ–∫–Ω–∞

### –ü—Ä–∏–ª–∞–≥–∞—Ç–µ–ª—å–Ω—ã–µ:
- **–ú—É–∂—Å–∫–æ–π**: —Ö–æ—Ä–æ—à–∏–π, –±–æ–ª—å—à–æ–π, –∫—Ä–∞—Å–Ω—ã–π
- **–ñ–µ–Ω—Å–∫–∏–π**: —Ö–æ—Ä–æ—à–∞—è, –±–æ–ª—å—à–∞—è, –∫—Ä–∞—Å–Ω–∞—è
- **–°—Ä–µ–¥–Ω–∏–π**: —Ö–æ—Ä–æ—à–µ–µ, –±–æ–ª—å—à–æ–µ, –∫—Ä–∞—Å–Ω–æ–µ
- **–ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ**: —Ö–æ—Ä–æ—à–∏–µ, –±–æ–ª—å—à–∏–µ, –∫—Ä–∞—Å–Ω—ã–µ

## –í–∞–∂–Ω–æ –∑–∞–ø–æ–º–Ω–∏—Ç—å!

–ò–º–µ–Ω–∏—Ç–µ–ª—å–Ω—ã–π –ø–∞–¥–µ–∂ - —ç—Ç–æ **–∏—Å—Ö–æ–¥–Ω–∞—è —Ñ–æ—Ä–º–∞** —Å–ª–æ–≤–∞. –í—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ –ø–∞–¥–µ–∂–∏ –æ–±—Ä–∞–∑—É—é—Ç—Å—è –æ—Ç –∏–º–µ–Ω–∏—Ç–µ–ª—å–Ω–æ–≥–æ –ø–∞–¥–µ–∂–∞.

## –ü—Ä–∏–º–µ—Ä—ã:

**–ü–æ–¥–ª–µ–∂–∞—â–µ–µ:** –°–æ–±–∞–∫–∞ –ª–∞–µ—Ç. –ö–Ω–∏–≥–∞ –ª–µ–∂–∏—Ç –Ω–∞ —Å—Ç–æ–ª–µ.
**–ò–º–µ–Ω–Ω–∞—è —á–∞—Å—Ç—å:** –≠—Ç–æ –º–æ–π –±—Ä–∞—Ç. –û–Ω–∞ —Å—Ç—É–¥–µ–Ω—Ç–∫–∞.
**–û–±—Ä–∞—â–µ–Ω–∏–µ:** –°–∞—à–∞, –∏–¥–∏ –¥–æ–º–æ–π!
    `,
    examples: [
      '–°—Ç—É–¥–µ–Ω—Ç (–ø–æ–¥–ª–µ–∂–∞—â–µ–µ) —á–∏—Ç–∞–µ—Ç –∫–Ω–∏–≥—É.',
      '–≠—Ç–æ –º–æ—è (–∏–º–µ–Ω–Ω–∞—è —á–∞—Å—Ç—å) –∫–Ω–∏–≥–∞.',
      '–ú–∞—à–∞ (–æ–±—Ä–∞—â–µ–Ω–∏–µ), –ø–æ–¥–æ–π–¥–∏ —Å—é–¥–∞.',
      '–ú–æ—Å–∫–≤–∞ (–Ω–∞–∑–≤–∞–Ω–∏–µ) - —Å—Ç–æ–ª–∏—Ü–∞ –†–æ—Å—Å–∏–∏.'
    ]
  },
  '0-2': {
    title: '–†–æ–¥–∏—Ç–µ–ª—å–Ω—ã–π –ø–∞–¥–µ–∂',
    theory: `
# –†–æ–¥–∏—Ç–µ–ª—å–Ω—ã–π –ø–∞–¥–µ–∂

## –ß—Ç–æ —ç—Ç–æ —Ç–∞–∫–æ–µ?

**–†–æ–¥–∏—Ç–µ–ª—å–Ω—ã–π –ø–∞–¥–µ–∂** - –≤—Ç–æ—Ä–æ–π –ø–∞–¥–µ–∂ –≤ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ. –û–Ω –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã **–∫–æ–≥–æ? —á–µ–≥–æ?**

## –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è?

### –ë–µ–∑ –ø—Ä–µ–¥–ª–æ–≥–æ–≤:
- **–ü—Ä–∏–Ω–∞–¥–ª–µ–∂–Ω–æ—Å—Ç—å**: –∫–Ω–∏–≥–∞ **—Å—Ç—É–¥–µ–Ω—Ç–∞**, –¥–æ–º **–æ—Ç—Ü–∞**
- **–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ**: –º–Ω–æ–≥–æ **–∫–Ω–∏–≥**, –º–∞–ª–æ **–≤—Ä–µ–º–µ–Ω–∏**
- **–û—Ç—Ä–∏—Ü–∞–Ω–∏–µ**: –Ω–µ—Ç **–∫–Ω–∏–≥–∏**, –Ω–µ –≤–∏–∂—É **–¥—Ä—É–≥–∞**

### –° –ø—Ä–µ–¥–ª–æ–≥–∞–º–∏:
- **–∏–∑/—Å**: –≤—ã—à–µ–ª **–∏–∑ –¥–æ–º–∞**, –≤–µ—Ä–Ω—É–ª—Å—è **—Å —Ä–∞–±–æ—Ç—ã**
- **—É**: –±—ã–ª **—É –¥—Ä—É–≥–∞**, —Å–ø—Ä–æ—Å–∏–ª **—É —É—á–∏—Ç–µ–ª—è**
- **–æ—Ç**: –ø–æ–ª—É—á–∏–ª –ø–∏—Å—å–º–æ **–æ—Ç –º–∞–º—ã**
- **–¥–æ**: —Ä–∞–±–æ—Ç–∞–ª **–¥–æ –≤–µ—á–µ—Ä–∞**
- **–¥–ª—è**: –∫—É–ø–∏–ª –ø–æ–¥–∞—Ä–æ–∫ **–¥–ª—è —Å–µ—Å—Ç—Ä—ã**

## –§–æ—Ä–º—ã —Å–ª–æ–≤

### –û–∫–æ–Ω—á–∞–Ω–∏—è —Å—É—â–µ—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö:

**–ú—É–∂—Å–∫–æ–π —Ä–æ–¥:**
- –ü–æ—Å–ª–µ —Å–æ–≥–ª–∞—Å–Ω—ã—Ö: -–∞ (—Å—Ç–æ–ª–∞, –¥–æ–º–∞)
- –ü–æ—Å–ª–µ –≥–ª–∞—Å–Ω—ã—Ö: -—è (–º—É–∑–µ—è, –≥–µ—Ä–æ—è)

**–ñ–µ–Ω—Å–∫–∏–π —Ä–æ–¥:**
- -—ã/-–∏ (–∫–Ω–∏–≥–∏, —Ç–µ—Ç—Ä–∞–¥–∏)
- -–∏ –ø–æ—Å–ª–µ –∂/—à/—â/—á/—â: (–º—ã—à–∏, –¥—É—à–∏)

**–°—Ä–µ–¥–Ω–∏–π —Ä–æ–¥:**
- -–∞ (–æ–∫–Ω–∞, –º–æ—Ä—è)

**–ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ —á–∏—Å–ª–æ:**
- -–æ–≤/-–µ–≤ (—Å—Ç–æ–ª–æ–≤, –º—É–∑–µ–µ–≤)
- -–µ–π (–∫–Ω–∏–≥, —Ç–µ—Ç—Ä–∞–¥–µ–π)

## –ü—Ä–∏–º–µ—Ä—ã:

**–ü—Ä–∏–Ω–∞–¥–ª–µ–∂–Ω–æ—Å—Ç—å:** –∫–Ω–∏–≥–∞ **—Å—Ç—É–¥–µ–Ω—Ç–∞**, –¥–æ–º **—Ä–æ–¥–∏—Ç–µ–ª–µ–π**
**–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ:** —Å—Ç–∞–∫–∞–Ω **–≤–æ–¥—ã**, –ø–∞—á–∫–∞ **–º–∞—Å–ª–∞**
**–û—Ç—Ä–∏—Ü–∞–Ω–∏–µ:** –Ω–µ—Ç **–≤—Ä–µ–º–µ–Ω–∏**, –Ω–µ –≤–∏–∂—É **–¥–æ—Ä–æ–≥–∏**
    `,
    examples: [
      '–ö–Ω–∏–≥–∞ —Å—Ç—É–¥–µ–Ω—Ç–∞ (–ø—Ä–∏–Ω–∞–¥–ª–µ–∂–Ω–æ—Å—Ç—å)',
      '–ú–Ω–æ–≥–æ –∫–Ω–∏–≥ (–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ)',
      '–ù–µ—Ç –≤—Ä–µ–º–µ–Ω–∏ (–æ—Ç—Ä–∏—Ü–∞–Ω–∏–µ)',
      '–í—ã—à–µ–ª –∏–∑ –¥–æ–º–∞ (–ø—Ä–µ–¥–ª–æ–≥ –∏–∑)',
      '–ë—ã–ª —É –¥—Ä—É–≥–∞ (–ø—Ä–µ–¥–ª–æ–≥ —É)'
    ]
  },
  '0-3': {
    title: '–î–∞—Ç–µ–ª—å–Ω—ã–π –ø–∞–¥–µ–∂',
    theory: `
# –î–∞—Ç–µ–ª—å–Ω—ã–π –ø–∞–¥–µ–∂

## –ß—Ç–æ —ç—Ç–æ —Ç–∞–∫–æ–µ?

**–î–∞—Ç–µ–ª—å–Ω—ã–π –ø–∞–¥–µ–∂** - —Ç—Ä–µ—Ç–∏–π –ø–∞–¥–µ–∂ –≤ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ. –û–Ω –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã **–∫–æ–º—É? —á–µ–º—É?**

## –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è?

### –ë–µ–∑ –ø—Ä–µ–¥–ª–æ–≥–æ–≤:
- **–ö–æ—Å–≤–µ–Ω–Ω–æ–µ –¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ**: –¥–∞–ª **–∫–Ω–∏–≥—É –¥—Ä—É–≥—É**, –ø–æ–º–æ–≥–∞—é **–º–∞–º–µ**
- **–í–æ–∑—Ä–∞—Å—Ç**: –µ–º—É **20 –ª–µ—Ç**, –µ–π **15 –ª–µ—Ç**

### –° –ø—Ä–µ–¥–ª–æ–≥–∞–º–∏:
- **–∫**: –ø–æ–¥–æ—à–µ–ª **–∫ –¥–æ–º—É**, –æ—Ç–Ω–æ—à—É—Å—å **–∫ –¥—Ä—É–≥—É**
- **–ø–æ**: –≥—É–ª—è—é **–ø–æ –ø–∞—Ä–∫—É**, —Ä–∞–±–æ—Ç–∞—é **–ø–æ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏**
- **–±–ª–∞–≥–æ–¥–∞—Ä—è**: –∑–∞–∫–æ–Ω—á–∏–ª –±–ª–∞–≥–æ–¥–∞—Ä—è **–ø–æ–º–æ—â–∏**

## –§–æ—Ä–º—ã —Å–ª–æ–≤

### –û–∫–æ–Ω—á–∞–Ω–∏—è —Å—É—â–µ—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö:

**–ú—É–∂—Å–∫–æ–π —Ä–æ–¥:**
- –ü–æ—Å–ª–µ —Å–æ–≥–ª–∞—Å–Ω—ã—Ö: -—É (—Å—Ç–æ–ª—É, –¥–æ–º—É)
- –ü–æ—Å–ª–µ –≥–ª–∞—Å–Ω—ã—Ö: -—é (–º—É–∑–µ—é, –≥–µ—Ä–æ—é)

**–ñ–µ–Ω—Å–∫–∏–π —Ä–æ–¥:**
- -–µ (–∫–Ω–∏–≥–µ, —Ç–µ—Ç—Ä–∞–¥–∏)
- -–µ –ø–æ—Å–ª–µ –∂/—à/—â/—á/—â: (–º—ã—à–µ, –¥—É—à–µ)

**–°—Ä–µ–¥–Ω–∏–π —Ä–æ–¥:**
- -—É (–æ–∫–Ω—É, –º–æ—Ä—é)

**–ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ —á–∏—Å–ª–æ:**
- -–∞–º/-—è–º (—Å—Ç–æ–ª–∞–º, –º—É–∑–µ—è–º)

## –ü—Ä–∏–º–µ—Ä—ã:

**–ö–æ—Å–≤–µ–Ω–Ω–æ–µ –¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ:** –î–∞–ª –∫–Ω–∏–≥—É **–¥—Ä—É–≥—É**. –ü–æ–º–æ–≥–∞—é **–º–∞–º–µ**.
**–í–æ–∑—Ä–∞—Å—Ç:** –ï–º—É **–¥–≤–∞–¥—Ü–∞—Ç—å** –ª–µ—Ç.
**–ü—Ä–µ–¥–ª–æ–≥–∏:** –ü–æ–¥–æ—à–µ–ª **–∫ –¥–æ–º—É**. –ì—É–ª—è—é **–ø–æ –ø–∞—Ä–∫—É**.
    `,
    examples: [
      '–î–∞–ª –∫–Ω–∏–≥—É –¥—Ä—É–≥—É (–∫–æ—Å–≤–µ–Ω–Ω–æ–µ –¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ)',
      '–ï–º—É 20 –ª–µ—Ç (–≤–æ–∑—Ä–∞—Å—Ç)',
      '–ü–æ–¥–æ—à–µ–ª –∫ –¥–æ–º—É (–ø—Ä–µ–¥–ª–æ–≥ –∫)',
      '–ì—É–ª—è—é –ø–æ –ø–∞—Ä–∫—É (–ø—Ä–µ–¥–ª–æ–≥ –ø–æ)',
      '–ë–ª–∞–≥–æ–¥–∞—Ä—è –ø–æ–º–æ—â–∏ (–ø—Ä–µ–¥–ª–æ–≥ –±–ª–∞–≥–æ–¥–∞—Ä—è)'
    ]
  },
  '0-4': {
    title: '–í–∏–Ω–∏—Ç–µ–ª—å–Ω—ã–π –ø–∞–¥–µ–∂',
    theory: `
# –í–∏–Ω–∏—Ç–µ–ª—å–Ω—ã–π –ø–∞–¥–µ–∂

## –ß—Ç–æ —ç—Ç–æ —Ç–∞–∫–æ–µ?

**–í–∏–Ω–∏—Ç–µ–ª—å–Ω—ã–π –ø–∞–¥–µ–∂** - —á–µ—Ç–≤–µ—Ä—Ç—ã–π –ø–∞–¥–µ–∂ –≤ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ. –û–Ω –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã **–∫–æ–≥–æ? —á—Ç–æ?**

## –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è?

- **–ü—Ä—è–º–æ–µ –¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ**: –≤–∏–∂—É **–∫–Ω–∏–≥—É**, —á–∏—Ç–∞—é **–≥–∞–∑–µ—Ç—É**
- **–î–≤–∏–∂–µ–Ω–∏–µ –∫—É–¥–∞?**: –∏–¥—É **–≤ –º–∞–≥–∞–∑–∏–Ω**, –µ–¥—É **–≤ –ú–æ—Å–∫–≤—É**
- **–í—Ä–µ–º—è**: –ø—Ä–∏—à–µ–ª **–≤–µ—á–µ—Ä–æ–º**, —É–µ—Ö–∞–ª **—É—Ç—Ä–æ–º**
- **–û—Ç—Ä–∏—Ü–∞–Ω–∏–µ**: –Ω–µ –≤–∏–∂—É **–∫–∞—Ä—Ç–∏–Ω—ã**

## –§–æ—Ä–º—ã —Å–ª–æ–≤

### –û–∫–æ–Ω—á–∞–Ω–∏—è —Å—É—â–µ—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö:

**–ú—É–∂—Å–∫–æ–π —Ä–æ–¥ (–æ–¥—É—à–µ–≤–ª–µ–Ω–Ω—ã–µ):**
- = –î–∞—Ç–µ–ª—å–Ω—ã–π –ø–∞–¥–µ–∂: –≤–∏–∂—É **–¥—Ä—É–≥–∞**, –≤—Å—Ç—Ä–µ—á–∞—é **–æ—Ç—Ü–∞**

**–ú—É–∂—Å–∫–æ–π —Ä–æ–¥ (–Ω–µ–æ–¥—É—à–µ–≤–ª–µ–Ω–Ω—ã–µ):**
- = –ò–º–µ–Ω–∏—Ç–µ–ª—å–Ω—ã–π –ø–∞–¥–µ–∂: —á–∏—Ç–∞—é **–∂—É—Ä–Ω–∞–ª**, –ø—å—é **—á–∞–π**

**–ñ–µ–Ω—Å–∫–∏–π —Ä–æ–¥:**
- -—É (–∫–Ω–∏–≥—É, —Ç–µ—Ç—Ä–∞–¥—å)
- –ü–æ—Å–ª–µ –∂/—à/—â/—á/—â: -—É (–º—ã—à—å, –¥—É—à)

**–°—Ä–µ–¥–Ω–∏–π —Ä–æ–¥:**
- = –ò–º–µ–Ω–∏—Ç–µ–ª—å–Ω—ã–π –ø–∞–¥–µ–∂: –≤–∏–∂—É **–æ–∫–Ω–æ**, –ª—é–±–ª—é **–º–æ—Ä–µ**

**–ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ —á–∏—Å–ª–æ:**
- -–æ–≤/-–µ–≤ –¥–ª—è –æ–¥—É—à–µ–≤–ª–µ–Ω–Ω—ã—Ö (–≤–∏–∂—É **–±—Ä–∞—Ç—å–µ–≤**)
- = –ò–º–µ–Ω–∏—Ç–µ–ª—å–Ω—ã–π –¥–ª—è –Ω–µ–æ–¥—É—à–µ–≤–ª–µ–Ω–Ω—ã—Ö (—á–∏—Ç–∞—é **–∂—É—Ä–Ω–∞–ª—ã**)

## –í–∞–∂–Ω–æ–µ –ø—Ä–∞–≤–∏–ª–æ!

**–û–¥—É—à–µ–≤–ª–µ–Ω–Ω—ã–µ —Å—É—â–µ—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ** –≤ –≤–∏–Ω–∏—Ç–µ–ª—å–Ω–æ–º –ø–∞–¥–µ–∂–µ –∏–º–µ—é—Ç —Ñ–æ—Ä–º—É **–¥–∞—Ç–µ–ª—å–Ω–æ–≥–æ –ø–∞–¥–µ–∂–∞**.
**–ù–µ–æ–¥—É—à–µ–≤–ª–µ–Ω–Ω—ã–µ —Å—É—â–µ—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ** –≤ –≤–∏–Ω–∏—Ç–µ–ª—å–Ω–æ–º –ø–∞–¥–µ–∂–µ –∏–º–µ—é—Ç —Ñ–æ—Ä–º—É **–∏–º–µ–Ω–∏—Ç–µ–ª—å–Ω–æ–≥–æ –ø–∞–¥–µ–∂–∞**.

## –ü—Ä–∏–º–µ—Ä—ã:

**–ü—Ä—è–º–æ–µ –¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ:** –ß–∏—Ç–∞—é **–∫–Ω–∏–≥—É**. –í–∏–∂—É **–¥—Ä—É–≥–∞**.
**–î–≤–∏–∂–µ–Ω–∏–µ:** –ò–¥—É **–≤ –º–∞–≥–∞–∑–∏–Ω**. –ï–¥—É **–≤ –ú–æ—Å–∫–≤—É**.
**–í—Ä–µ–º—è:** –ü—Ä–∏—à–µ–ª **–≤–µ—á–µ—Ä–æ–º**.
    `,
    examples: [
      '–ß–∏—Ç–∞—é –∫–Ω–∏–≥—É (–ø—Ä—è–º–æ–µ –¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ)',
      '–í–∏–∂—É –¥—Ä—É–≥–∞ (–æ–¥—É—à–µ–≤–ª–µ–Ω–Ω–æ–µ —Å—É—â–µ—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ–µ)',
      '–ò–¥—É –≤ –º–∞–≥–∞–∑–∏–Ω (–¥–≤–∏–∂–µ–Ω–∏–µ)',
      '–ü—Ä–∏—à–µ–ª –≤–µ—á–µ—Ä–æ–º (–≤—Ä–µ–º—è)',
      '–ù–µ –≤–∏–∂—É –∫–∞—Ä—Ç–∏–Ω—ã (–æ—Ç—Ä–∏—Ü–∞–Ω–∏–µ)'
    ]
  },
  '0-5': {
    title: '–¢–≤–æ—Ä–∏—Ç–µ–ª—å–Ω—ã–π –ø–∞–¥–µ–∂',
    theory: `
# –¢–≤–æ—Ä–∏—Ç–µ–ª—å–Ω—ã–π –ø–∞–¥–µ–∂

## –ß—Ç–æ —ç—Ç–æ —Ç–∞–∫–æ–µ?

**–¢–≤–æ—Ä–∏—Ç–µ–ª—å–Ω—ã–π –ø–∞–¥–µ–∂** - –ø—è—Ç—ã–π –ø–∞–¥–µ–∂ –≤ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ. –û–Ω –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã **–∫–µ–º? —á–µ–º?**

## –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è?

### –ë–µ–∑ –ø—Ä–µ–¥–ª–æ–≥–æ–≤:
- **–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–µ–π—Å—Ç–≤–∏—è**: –ø–∏—à—É **—Ä—É—á–∫–æ–π**, —Ä–µ–∂—É **–Ω–æ–∂–æ–º**
- **–°–ø–æ—Å–æ–± –¥–µ–π—Å—Ç–≤–∏—è**: –≥–æ–≤–æ—Ä—é **—à–µ–ø–æ—Ç–æ–º**, –¥–≤–∏–≥–∞—é—Å—å **–ø–µ—à–∫–æ–º**

### –° –ø—Ä–µ–¥–ª–æ–≥–∞–º–∏:
- **—Å**: –≥—É–ª—è—é **—Å –¥—Ä—É–≥–æ–º**, –ø—å—é —á–∞–π **—Å –ª–∏–º–æ–Ω–æ–º**
- **–∑–∞**: —Å–∏–∂—É **–∑–∞ —Å—Ç–æ–ª–æ–º**, —Å—Ç–æ—é **–∑–∞ –¥–≤–µ—Ä—å—é**
- **–ø–æ–¥**: –ª–µ–∂—É **–ø–æ–¥ –æ–¥–µ—è–ª–æ–º**, —Å–∏–∂—É **–ø–æ–¥ –¥–µ—Ä–µ–≤–æ–º**
- **–Ω–∞–¥**: –≤–∏—à—É **–Ω–∞–¥ –ø—Ä–æ–ø–∞—Å—Ç—å—é**, –ª–µ—Ç–∞—é **–Ω–∞–¥ –≥–æ—Ä–æ–¥–æ–º**
- **–º–µ–∂–¥—É**: —Å–∏–∂—É **–º–µ–∂–¥—É –¥—Ä—É–∑—å—è–º–∏**
- **–ø–µ—Ä–µ–¥**: —Å—Ç–æ—é **–ø–µ—Ä–µ–¥ –¥–æ–º–æ–º**

## –§–æ—Ä–º—ã —Å–ª–æ–≤

### –û–∫–æ–Ω—á–∞–Ω–∏—è —Å—É—â–µ—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö:

**–ú—É–∂—Å–∫–æ–π —Ä–æ–¥:**
- -–æ–º/-–µ–º (—Å—Ç–æ–ª–æ–º, –º—É–∑–µ–µ–º)

**–ñ–µ–Ω—Å–∫–∏–π —Ä–æ–¥:**
- -–æ–π/-–µ–π (–∫–Ω–∏–≥–æ–π, —Ç–µ—Ç—Ä–∞–¥—å—é)
- –ü–æ—Å–ª–µ –∂/—à/—â/—á/—â: -–æ–π/-–µ–π (–º—ã—à–æ–π, –¥—É—à–æ–π)

**–°—Ä–µ–¥–Ω–∏–π —Ä–æ–¥:**
- -–æ–º/-–µ–º (–æ–∫–Ω–æ–º, –º–æ—Ä–µ–º)

**–ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ —á–∏—Å–ª–æ:**
- -–∞–º–∏/-—è–º–∏ (—Å—Ç–æ–ª–∞–º–∏, –º—É–∑–µ—è–º–∏)

## –ü—Ä–∏–º–µ—Ä—ã:

**–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç:** –ü–∏—à—É **—Ä—É—á–∫–æ–π**. –†–µ–∂—É **–Ω–æ–∂–æ–º**.
**–°–ø–æ—Å–æ–±:** –ì–æ–≤–æ—Ä—é **—à–µ–ø–æ—Ç–æ–º**. –î–≤–∏–≥–∞—é—Å—å **–ø–µ—à–∫–æ–º**.
**–ü—Ä–µ–¥–ª–æ–≥–∏:** –ì—É–ª—è—é **—Å –¥—Ä—É–≥–æ–º**. –°–∏–∂—É **–∑–∞ —Å—Ç–æ–ª–æ–º**.
    `,
    examples: [
      '–ü–∏—à—É —Ä—É—á–∫–æ–π (–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç)',
      '–ì–æ–≤–æ—Ä—é —à–µ–ø–æ—Ç–æ–º (—Å–ø–æ—Å–æ–±)',
      '–ì—É–ª—è—é —Å –¥—Ä—É–≥–æ–º (–ø—Ä–µ–¥–ª–æ–≥ —Å)',
      '–°–∏–∂—É –∑–∞ —Å—Ç–æ–ª–æ–º (–ø—Ä–µ–¥–ª–æ–≥ –∑–∞)',
      '–°—Ç–æ—é –ø–µ—Ä–µ–¥ –¥–æ–º–æ–º (–ø—Ä–µ–¥–ª–æ–≥ –ø–µ—Ä–µ–¥)'
    ]
  },
  '0-6': {
    title: '–ü—Ä–µ–¥–ª–æ–∂–Ω—ã–π –ø–∞–¥–µ–∂',
    theory: `
# –ü—Ä–µ–¥–ª–æ–∂–Ω—ã–π –ø–∞–¥–µ–∂

## –ß—Ç–æ —ç—Ç–æ —Ç–∞–∫–æ–µ?

**–ü—Ä–µ–¥–ª–æ–∂–Ω—ã–π –ø–∞–¥–µ–∂** - —à–µ—Å—Ç–æ–π –∏ –ø–æ—Å–ª–µ–¥–Ω–∏–π –ø–∞–¥–µ–∂ –≤ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ. –û–Ω –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã **–æ –∫–æ–º? –æ —á—ë–º?**

## –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è?

### –¢–æ–ª—å–∫–æ —Å –ø—Ä–µ–¥–ª–æ–≥–∞–º–∏:
- **–æ/–æ–±**: –≥–æ–≤–æ—Ä—é **–æ –∫–Ω–∏–≥–µ**, –¥—É–º–∞—é **–æ–± —É—á–µ–±–µ**
- **–≤**: –∂–∏–≤—É **–≤ –¥–æ–º–µ**, —É—á—É—Å—å **–≤ —à–∫–æ–ª–µ**
- **–Ω–∞**: –ª–µ–∂—É **–Ω–∞ –¥–∏–≤–∞–Ω–µ**, —Ä–∞–±–æ—Ç–∞—é **–Ω–∞ –∑–∞–≤–æ–¥–µ**
- **–ø—Ä–∏**: –±—ã–ª **–ø—Ä–∏ –¥–≤–æ—Ä–µ**, —Ä–∞–±–æ—Ç–∞—é **–ø—Ä–∏ —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç–µ**

## –§–æ—Ä–º—ã —Å–ª–æ–≤

### –û–∫–æ–Ω—á–∞–Ω–∏—è —Å—É—â–µ—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö:

**–ú—É–∂—Å–∫–æ–π —Ä–æ–¥:**
- -–µ/-—ë (–≤ —Å—Ç–æ–ª–µ, –Ω–∞ –º–æ—Ä–µ)

**–ñ–µ–Ω—Å–∫–∏–π —Ä–æ–¥:**
- -–µ/-—ë (–≤ –∫–Ω–∏–≥–µ, –Ω–∞ —Ç–µ—Ç—Ä–∞–¥–∏)
- –ü–æ—Å–ª–µ –∂/—à/—â/—á/—â: -–µ (–Ω–∞ –¥—É—à–µ)

**–°—Ä–µ–¥–Ω–∏–π —Ä–æ–¥:**
- -–µ/-—ë (–≤ –æ–∫–Ω–µ, –Ω–∞ –º–æ—Ä–µ)

**–ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ —á–∏—Å–ª–æ:**
- -–∞—Ö/-—è—Ö (–≤ —Å—Ç–æ–ª–∞—Ö, –æ –º—É–∑–µ—è—Ö)

## –í–∞–∂–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞!

1. –ü—Ä–µ–¥–ª–æ–∂–Ω—ã–π –ø–∞–¥–µ–∂ **–≤—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å –ø—Ä–µ–¥–ª–æ–≥–∞–º–∏**.
2. –ë–µ–∑ –ø—Ä–µ–¥–ª–æ–≥–æ–≤ —ç—Ç–æ—Ç –ø–∞–¥–µ–∂ **–Ω–µ —É–ø–æ—Ç—Ä–µ–±–ª—è–µ—Ç—Å—è**.
3. –û–∫–æ–Ω—á–∞–Ω–∏–µ **-–µ** –ø–æ—Å–ª–µ —Å–æ–≥–ª–∞—Å–Ω—ã—Ö, **-—ë** –ø–æ—Å–ª–µ –º—è–≥–∫–∏—Ö —Å–æ–≥–ª–∞—Å–Ω—ã—Ö.

## –ü—Ä–∏–º–µ—Ä—ã:

**–ü—Ä–µ–¥–ª–æ–≥ –æ/–æ–±:** –ì–æ–≤–æ—Ä—é **–æ –∫–Ω–∏–≥–µ**. –î—É–º–∞—é **–æ–± —É—á–µ–±–µ**.
**–ü—Ä–µ–¥–ª–æ–≥ –≤:** –ñ–∏–≤—É **–≤ –¥–æ–º–µ**. –£—á—É—Å—å **–≤ —à–∫–æ–ª–µ**.
**–ü—Ä–µ–¥–ª–æ–≥ –Ω–∞:** –õ–µ–∂—É **–Ω–∞ –¥–∏–≤–∞–Ω–µ**. –†–∞–±–æ—Ç–∞—é **–Ω–∞ –∑–∞–≤–æ–¥–µ**.
**–ü—Ä–µ–¥–ª–æ–≥ –ø—Ä–∏:** –†–∞–±–æ—Ç–∞—é **–ø—Ä–∏ —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç–µ**.
    `,
    examples: [
      '–ì–æ–≤–æ—Ä—é –æ –∫–Ω–∏–≥–µ (–ø—Ä–µ–¥–ª–æ–≥ –æ)',
      '–ñ–∏–≤—É –≤ –¥–æ–º–µ (–ø—Ä–µ–¥–ª–æ–≥ –≤)',
      '–õ–µ–∂—É –Ω–∞ –¥–∏–≤–∞–Ω–µ (–ø—Ä–µ–¥–ª–æ–≥ –Ω–∞)',
      '–†–∞–±–æ—Ç–∞—é –ø—Ä–∏ —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç–µ (–ø—Ä–µ–¥–ª–æ–≥ –ø—Ä–∏)',
      '–î—É–º–∞—é –æ–± —É—á–µ–±–µ (–ø—Ä–µ–¥–ª–æ–≥ –æ–±)'
    ]
  },
  '0-7': {
    title: '–ü—Ä–∞–∫—Ç–∏–∫–∞ –ø–∞–¥–µ–∂–µ–π –≤ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è—Ö',
    theory: `
# –ü—Ä–∞–∫—Ç–∏–∫–∞ –ø–∞–¥–µ–∂–µ–π –≤ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è—Ö

## –ö–∞–∫ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –ø–∞–¥–µ–∂?

–ß—Ç–æ–±—ã –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –ø–∞–¥–µ–∂ —Å—É—â–µ—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ–≥–æ, –Ω—É–∂–Ω–æ:

1. **–ó–∞–¥–∞—Ç—å –≤–æ–ø—Ä–æ—Å—ã**: –∫—Ç–æ? —á—Ç–æ? –∫–æ–≥–æ? —á–µ–≥–æ? –∫–æ–º—É? —á–µ–º—É? –∏ —Ç.–¥.
2. **–ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –Ω–∞ –æ–∫–æ–Ω—á–∞–Ω–∏–µ** —Å–ª–æ–≤–∞
3. **–£—á–µ—Å—Ç—å –ø—Ä–µ–¥–ª–æ–≥–∏** (–¥–ª—è –ø—Ä–µ–¥–ª–æ–∂–Ω–æ–≥–æ –ø–∞–¥–µ–∂–∞)

## –ü–∞–º—è—Ç–∫–∞ –ø–æ –≤–æ–ø—Ä–æ—Å–∞–º:

- **–ò.–ø.** - –∫—Ç–æ? —á—Ç–æ? (–æ—Å–Ω–æ–≤–Ω–æ–π)
- **–†.–ø.** - –∫–æ–≥–æ? —á–µ–≥–æ? (–ø—Ä–∏–Ω–∞–¥–ª–µ–∂–Ω–æ—Å—Ç—å, –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ)
- **–î.–ø.** - –∫–æ–º—É? —á–µ–º—É? (–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ)
- **–í.–ø.** - –∫–æ–≥–æ? —á—Ç–æ? (–æ–±—ä–µ–∫—Ç –¥–µ–π—Å—Ç–≤–∏—è)
- **–¢.–ø.** - –∫–µ–º? —á–µ–º? (–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç, —Å–ø–æ—Å–æ–±)
- **–ü.–ø.** - –æ –∫–æ–º? –æ —á—ë–º? (—Ç–µ–º–∞ —Ä–∞–∑–≥–æ–≤–æ—Ä–∞)

## –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –∑–∞–¥–∞–Ω–∏—è:

### –ó–∞–¥–∞–Ω–∏–µ 1: –û–ø—Ä–µ–¥–µ–ª–∏—Ç–µ –ø–∞–¥–µ–∂–∏
1. –ö–Ω–∏–≥–∞ –ª–µ–∂–∏—Ç **–Ω–∞ —Å—Ç–æ–ª–µ**. (–Ω–∞ —á–µ–º?)
2. –Ø –¥–∞–ª –∫–Ω–∏–≥—É **–¥—Ä—É–≥—É**. (–∫–æ–º—É?)
3. –Ø –≤–∏–∂—É **—Å–æ–±–∞–∫—É**. (—á—Ç–æ?)
4. –Ø –ø–∏—à—É **—Ä—É—á–∫–æ–π**. (—á–µ–º?)

### –ó–∞–¥–∞–Ω–∏–µ 2: –ò–∑–º–µ–Ω–∏—Ç–µ –ø–∞–¥–µ–∂–∏
- –î–æ–º (–ò.–ø.) ‚Üí –≤ –¥–æ–º–µ (–ü.–ø.)
- –ö–Ω–∏–≥–∞ (–ò.–ø.) ‚Üí –∫–Ω–∏–≥–∏ (–†.–ø.)
- –î—Ä—É–≥ (–ò.–ø.) ‚Üí –¥—Ä—É–≥—É (–î.–ø.)

### –ó–∞–¥–∞–Ω–∏–µ 3: –ü–æ—Å—Ç—Ä–æ–π—Ç–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è
–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–ª–æ–≤–∞ –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –ø–∞–¥–µ–∂–µ:
- –Ø, –∏–¥—Ç–∏, –º–∞–≥–∞–∑–∏–Ω (–í.–ø.)
- –ö–Ω–∏–≥–∞, –ª–µ–∂–∞—Ç—å, —Å—Ç–æ–ª (–ü.–ø.)
- –Ø, –ø–∏—Å–∞—Ç—å, —Ä—É—á–∫–∞ (–¢.–ø.)
    `,
    examples: [
      '–ö–Ω–∏–≥–∞ –ª–µ–∂–∏—Ç –Ω–∞ —Å—Ç–æ–ª–µ. (–ü—Ä–µ–¥–ª–æ–∂–Ω—ã–π –ø–∞–¥–µ–∂)',
      '–Ø –¥–∞–ª –∫–Ω–∏–≥—É –¥—Ä—É–≥—É. (–î–∞—Ç–µ–ª—å–Ω—ã–π –ø–∞–¥–µ–∂)',
      '–Ø –≤–∏–∂—É —Å–æ–±–∞–∫—É. (–í–∏–Ω–∏—Ç–µ–ª—å–Ω—ã–π –ø–∞–¥–µ–∂)',
      '–Ø –ø–∏—à—É —Ä—É—á–∫–æ–π. (–¢–≤–æ—Ä–∏—Ç–µ–ª—å–Ω—ã–π –ø–∞–¥–µ–∂)'
    ]
  }
};

const Lesson = () => {
  const { courseId, moduleId, lessonId } = useParams<{ courseId: string; moduleId: string; lessonId: string }>();
  const [searchParams] = useSearchParams();
  const { user, completeLesson, updateAchievementProgress, updatePerformanceMetrics } = useAuth();
  const navigate = useNavigate();

  const lessonType = searchParams.get('type') || 'notes'; // 'notes' –∏–ª–∏ 'test'

  const [messages, setMessages] = useState<Message[]>([]);
  const [inputMessage, setInputMessage] = useState('');
  const [isLoading, setIsLoading] = useState(false);
  const [lessonStartTime, setLessonStartTime] = useState<Date>(new Date());
  const [aiAvatarPosition, setAiAvatarPosition] = useState(50); // –ù–∞—á–∞–ª—å–Ω–∞—è –ø–æ–∑–∏—Ü–∏—è –≤ —Ü–µ–Ω—Ç—Ä–µ
  const [lessonData, setLessonData] = useState<any>(null);
  const [isGeneratingContent, setIsGeneratingContent] = useState(false);
  const [showChat, setShowChat] = useState(false); // –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å —á–∞—Ç –∏–ª–∏ —Å—Ñ–µ—Ä—É
  const [autoStartVoice, setAutoStartVoice] = useState(false); // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø—É—Å–∫–∞—Ç—å –≥–æ–ª–æ—Å–æ–≤–æ–π —á–∞—Ç
  const [isVoiceChatActive, setIsVoiceChatActive] = useState(false);
  const [isListening, setIsListening] = useState(false);
  const [isLessonPlaying, setIsLessonPlaying] = useState(false); // –û–∑–≤—É—á–∫–∞ —É—Ä–æ–∫–∞
  const [generatedImages, setGeneratedImages] = useState<{[key: string]: string}>({});
  const recognitionRef = useRef<SpeechRecognition | null>(null);
  const chatScrollRef = useRef<HTMLDivElement>(null);
  const ttsContinueRef = useRef<boolean>(true);

  const lessonKey = `${courseId}-${moduleId}-${lessonId}`;
  const baseLesson = lessonContent[lessonKey];

  // –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤–∞–ª–∏–¥–Ω–æ—Å—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
  const moduleIndex = parseInt(moduleId || '0');
  const lessonIndex = parseInt(lessonId || '0');
  const isValidParams = !isNaN(moduleIndex) && !isNaN(lessonIndex) && moduleIndex >= 0 && lessonIndex >= 0;

  // –ü–æ–ª—É—á–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∫—É—Ä—Å–µ –∏ –º–æ–¥—É–ª–µ
  const courseInfo = getCourseAndModuleInfo(moduleIndex.toString(), lessonIndex.toString());

  // –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ç–µ–º—É —É—Ä–æ–∫–∞
  let lessonTopic = baseLesson ? baseLesson.title : courseInfo.moduleName;

  // –î–ª—è –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∫—É—Ä—Å–æ–≤ –±–µ—Ä–µ–º –Ω–∞–∑–≤–∞–Ω–∏–µ —É—Ä–æ–∫–∞ –∏–∑ –º–∞—Å—Å–∏–≤–∞
  if (user?.personalizedCourse && courseId === user.personalizedCourse.id) {
    const module = user.personalizedCourse.modules[moduleIndex];
    if (module && module.lessons && module.lessons[lessonIndex]) {
      lessonTopic = module.lessons[lessonIndex];
    }
  }


  // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —á–µ—Ä–µ–∑ DALL-E 3
  const generateImage = async (description: string): Promise<string | null> => {
    try {
      console.log('üñºÔ∏è  Requesting image generation for:', description);

      const response = await fetch('https://api.openai.com/v1/images/generations', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          'Authorization': `Bearer ${import.meta.env.VITE_OPENAI_API_KEY}`,
        },
        body: JSON.stringify({
          model: 'dall-e-3',
          prompt: `Educational illustration for a lesson: ${description}. Create a clear, professional, educational image suitable for learning. High quality, detailed, informative.`,
          size: '1024x1024',
          quality: 'standard',
          n: 1,
        }),
      });

      if (!response.ok) {
        const errorData = await response.json().catch(() => ({ error: 'Unknown error' }));
        console.error('‚ùå Image generation failed:', response.status, errorData);
        throw new Error(`Failed to generate image: ${response.status} - ${JSON.stringify(errorData)}`);
      }

      const data = await response.json();
      console.log('‚úÖ Image generated successfully:', data.data[0].url);
      return data.data[0].url;
    } catch (error) {
      console.error('‚ùå Error generating image:', error);
      return null;
    }
  };

  // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞ —Ç–∞–±–ª–∏—Ü—ã
  const renderTable = (tableData: string) => {
    try {
      const parts = tableData.split(' | ');
      const title = parts[0];
      const headers = parts[1].split(',');
      const rows = parts.slice(2).map(row => row.split(','));

      return `
        <div class="my-4 overflow-x-auto">
          <h4 class="font-semibold mb-2 text-center">${title}</h4>
          <table class="min-w-full border-collapse border border-gray-300 rounded-lg overflow-hidden">
            <thead>
              <tr class="bg-gray-50">
                ${headers.map(header => `<th class="border border-gray-300 px-4 py-2 text-left font-medium">${header.trim()}</th>`).join('')}
              </tr>
            </thead>
            <tbody>
              ${rows.map((row, index) => `
                <tr class="${index % 2 === 0 ? 'bg-white' : 'bg-gray-50'}">
                  ${row.map(cell => `<td class="border border-gray-300 px-4 py-2">${cell.trim()}</td>`).join('')}
                </tr>
              `).join('')}
            </tbody>
          </table>
        </div>
      `;
    } catch (error) {
      console.error('Error rendering table:', error);
      return `<div class="text-red-500">–û—à–∏–±–∫–∞ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ç–∞–±–ª–∏—Ü—ã</div>`;
    }
  };

  // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞ –¥–∏–∞–≥—Ä–∞–º–º—ã
  const renderChart = (chartData: string, chartId: string) => {
    try {
      const parts = chartData.split(' | ');
      const chartType = parts[0].toLowerCase();
      const title = parts[1];
      const labels = parts[2].split(',');
      const dataValues = parts[3].split(',').map(v => parseFloat(v.trim()));

      const data = {
        labels: labels.map(l => l.trim()),
        datasets: [{
          label: title,
          data: dataValues,
          backgroundColor: [
            'rgba(59, 130, 246, 0.8)',
            'rgba(16, 185, 129, 0.8)',
            'rgba(245, 158, 11, 0.8)',
            'rgba(239, 68, 68, 0.8)',
            'rgba(139, 92, 246, 0.8)',
            'rgba(236, 72, 153, 0.8)',
          ],
          borderColor: [
            'rgba(59, 130, 246, 1)',
            'rgba(16, 185, 129, 1)',
            'rgba(245, 158, 11, 1)',
            'rgba(239, 68, 68, 1)',
            'rgba(139, 92, 246, 1)',
            'rgba(236, 72, 153, 1)',
          ],
          borderWidth: 2,
        }],
      };

      const options = {
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
          legend: {
            position: 'top' as const,
          },
          title: {
            display: true,
            text: title,
          },
        },
      };

      // –°–æ–∑–¥–∞–µ–º —É–Ω–∏–∫–∞–ª—å–Ω—ã–π ID –¥–ª—è –¥–∏–∞–≥—Ä–∞–º–º—ã
      const uniqueId = `chart-${chartId}-${Date.now()}`;

      // –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ —Å–æ–∑–¥–∞–µ–º –¥–∏–∞–≥—Ä–∞–º–º—É
      setTimeout(() => {
        const canvas = document.getElementById(uniqueId) as HTMLCanvasElement;
        if (canvas && canvas.getContext) {
          const ctx = canvas.getContext('2d');
          if (ctx) {
            let chart;
            switch (chartType) {
              case 'bar':
                chart = new ChartJS(ctx, { type: 'bar', data, options });
                break;
              case 'line':
                chart = new ChartJS(ctx, { type: 'line', data, options });
                break;
              case 'pie':
                chart = new ChartJS(ctx, { type: 'pie', data, options });
                break;
              case 'doughnut':
                chart = new ChartJS(ctx, { type: 'doughnut', data, options });
                break;
              default:
                chart = new ChartJS(ctx, { type: 'bar', data, options });
            }
          }
        }
      }, 100);

      return `<div class="my-4">
                <div class="h-64">
                  <canvas id="${uniqueId}"></canvas>
                </div>
              </div>`;

    } catch (error) {
      console.error('Error rendering chart:', error);
      return `<div class="text-red-500">–û—à–∏–±–∫–∞ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–∏–∞–≥—Ä–∞–º–º—ã</div>`;
    }
  };

  // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞ —É—Ä–æ–∫–∞ —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π ### –±–ª–æ–∫–æ–≤, –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π, —Ç–∞–±–ª–∏—Ü –∏ –¥–∏–∞–≥—Ä–∞–º–º
  const formatLessonContent = (content: string) => {
    let chartCounter = 0;

    return content
      // –û–±—Ä–∞–±–æ—Ç–∫–∞ –º–∞—Ä–∫–µ—Ä–æ–≤ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π **[IMAGE: –æ–ø–∏—Å–∞–Ω–∏–µ]**
      .replace(/\*\*\[IMAGE:\s*(.+?)\]\*\*/g, (match, description) => {
        const imageKey = `image_${Object.keys(generatedImages).length}`;
        // –ï—Å–ª–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –µ—â–µ –Ω–µ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–æ, –∑–∞–ø—É—Å–∫–∞–µ–º –≥–µ–Ω–µ—Ä–∞—Ü–∏—é
        if (!generatedImages[imageKey]) {
          generateImage(description.trim()).then(imageUrl => {
            if (imageUrl) {
              setGeneratedImages(prev => ({
                ...prev,
                [imageKey]: imageUrl
              }));
            }
          }).catch(error => {
            console.error('Error generating inline image:', error);
          });
          // –ü–æ–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä
          return '[–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è...]';
        } else {
          // –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —É–∂–µ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–æ, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –µ–≥–æ
          return `[–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ: ${description.trim()}]`;
        }
      })
      // –û–±—Ä–∞–±–æ—Ç–∫–∞ –º–∞—Ä–∫–µ—Ä–æ–≤ —Ç–∞–±–ª–∏—Ü **[TABLE: ...]**
      .replace(/\*\*\[TABLE:\s*(.+?)\]\*\*/g, (match, tableData) => {
        return renderTable(tableData);
      })
      // –û–±—Ä–∞–±–æ—Ç–∫–∞ –º–∞—Ä–∫–µ—Ä–æ–≤ –¥–∏–∞–≥—Ä–∞–º–º **[CHART: ...]**
      .replace(/\*\*\[CHART:\s*(.+?)\]\*\*/g, (match, chartData) => {
        chartCounter++;
        return renderChart(chartData, chartCounter.toString());
      })
      // –û–±—Ä–∞–±–æ—Ç–∫–∞ markdown —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è (–∑–∞–≥–æ–ª–æ–≤–∫–∏, –≤—ã–¥–µ–ª–µ–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç)
      .replace(/^###\s+(.+)$/gm, '<h3 class="text-lg font-bold text-green-700 mb-2">$1</h3>')
      .replace(/^##\s+(.+)$/gm, '<h2 class="text-xl font-bold text-green-700 mb-3">$1</h2>')
      .replace(/^#\s+(.+)$/gm, '<h1 class="text-3xl font-bold text-green-700 mb-4">$1</h1>')
      .replace(/^####\s+(.+)$/gm, '<h4 class="text-xl font-bold text-green-700 mb-3">$1</h4>')
      .replace(/\*\*(.*?)\*\*/g, '<strong class="text-green-700 font-semibold">$1</strong>')
      // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø–µ—Ä–µ–Ω–æ—Å–æ–≤ —Å—Ç—Ä–æ–∫
      .replace(/\n/g, '<br>');
  };

  // –§—É–Ω–∫—Ü–∏—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ —É—Ä–æ–∫–∞
  const generateLessonContent = async (topic: string, userLevel: string, weakTopics: string[] = []) => {
    // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –Ω–∞–∑–≤–∞–Ω–∏–µ –∫—É—Ä—Å–∞ –¥–ª—è –ø—Ä–æ–º–ø—Ç–∞
    let courseName = courseInfo.courseName;
    if (user?.personalizedCourse && courseId === user.personalizedCourse.id) {
      // –î–ª—è –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∫—É—Ä—Å–æ–≤ –∏—Å–ø–æ–ª—å–∑—É–µ–º –∏—Ö –Ω–∞–∑–≤–∞–Ω–∏–µ
      courseName = user.personalizedCourse.title;
    }

    try {
      const prompt = `
–¢—ã - –æ–ø—ã—Ç–Ω—ã–π –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—å ${courseName}. –°–æ–∑–¥–∞–π –ø–æ–¥—Ä–æ–±–Ω—ã–π —É—Ä–æ–∫ –ø–æ —Ç–µ–º–µ "${topic}" –¥–ª—è —É—á–µ–Ω–∏–∫–∞ —É—Ä–æ–≤–Ω—è "${userLevel}".

–í–ê–ñ–ù–´–ï –ò–ù–°–¢–†–£–ö–¶–ò–ò:
- –°—Ç—Ä–æ–≥–æ –ø—Ä–∏–¥–µ—Ä–∂–∏–≤–∞–π—Å—è —Ç–µ–º—ã "${topic}" - –Ω–µ –¥–æ–±–∞–≤–ª—è–π –∫–æ–Ω—Ç–µ–Ω—Ç –∏–∑ —Ä—É—Å—Å–∫–æ–≥–æ —è–∑—ã–∫–∞, –≥—Ä–∞–º–º–∞—Ç–∏–∫–∏ –∏–ª–∏ –¥—Ä—É–≥–∏—Ö –ø—Ä–µ–¥–º–µ—Ç–æ–≤
- –°–æ–∑–¥–∞–≤–∞–π –∫–æ–Ω—Ç–µ–Ω—Ç, —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–π –∏–º–µ–Ω–Ω–æ —ç—Ç–æ–π —Ç–µ–º–µ
- –ï—Å–ª–∏ —Ç–µ–º–∞ –Ω–µ —Å–≤—è–∑–∞–Ω–∞ —Å —è–∑—ã–∫–æ–º, –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–π –ø—Ä–∏–º–µ—Ä—ã —Å –ø–∞–¥–µ–∂–∞–º–∏, —Å–∫–ª–æ–Ω–µ–Ω–∏–µ–º –∏–ª–∏ –≥—Ä–∞–º–º–∞—Ç–∏—á–µ—Å–∫–∏–º–∏ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º–∏
- –§–æ–∫—É—Å–∏—Ä—É–π—Å—è –Ω–∞ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏—Ö –∞—Å–ø–µ–∫—Ç–∞—Ö —Ç–µ–º—ã
- –ê–¥–∞–ø—Ç–∏—Ä—É–π —Ç–∏–ø —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π –ø–æ–¥ —Ç–µ–º—É:
  * –î–ª—è —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö —Ç–µ–º (—Ä–µ–º–æ–Ω—Ç, –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ): –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –∑–∞–¥–∞–Ω–∏—è, –ø–æ—à–∞–≥–æ–≤—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏, –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–±–ª–µ–º
  * –î–ª—è —è–∑—ã–∫–æ–≤—ã—Ö —Ç–µ–º: —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è –Ω–∞ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –ø—Ä–∞–≤–∏–ª, —Å–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–æ–≤
  * –î–ª—è –Ω–∞—É—á–Ω—ã—Ö —Ç–µ–º: —Ä–∞—Å—á–µ—Ç—ã, –∞–Ω–∞–ª–∏–∑, –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Ñ–æ—Ä–º—É–ª
  * –î–ª—è —Ç–≤–æ—Ä—á–µ—Å–∫–∏—Ö —Ç–µ–º: –ø—Ä–æ–µ–∫—Ç—ã, —Å–æ–∑–¥–∞–Ω–∏–µ –∫–æ–Ω—Ç–µ–Ω—Ç–∞

${weakTopics.length > 0 ? `–£—á–µ–Ω–∏–∫ –∏–º–µ–µ—Ç —Å–ª–∞–±—ã–µ –º–µ—Å—Ç–∞ –≤ —Å–ª–µ–¥—É—é—â–∏—Ö —Ç–µ–º–∞—Ö: ${weakTopics.join(', ')}. –£–¥–µ–ª–∏—Ç–µ –æ—Å–æ–±–æ–µ –≤–Ω–∏–º–∞–Ω–∏–µ —ç—Ç–∏–º –∞—Å–ø–µ–∫—Ç–∞–º.` : ''}

–°—Ç—Ä—É–∫—Ç—É—Ä–∞ —É—Ä–æ–∫–∞ –¥–æ–ª–∂–Ω–∞ –≤–∫–ª—é—á–∞—Ç—å:

# ${topic}

## –í–≤–µ–¥–µ–Ω–∏–µ –≤ —Ç–µ–º—É

## –û—Å–Ω–æ–≤–Ω—ã–µ –ø–æ–Ω—è—Ç–∏—è –∏ –ø—Ä–∞–≤–∏–ª–∞

## –ü–æ–¥—Ä–æ–±–Ω—ã–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏—è —Å –ø—Ä–∏–º–µ—Ä–∞–º–∏

## –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è

–°–æ–∑–¥–∞–π —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–µ –∏–º–µ—é—Ç –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫—É—é —Ü–µ–Ω–Ω–æ—Å—Ç—å –¥–ª—è —Ç–µ–º—ã "${topic}". –ù–µ –∏—Å–ø–æ–ª—å–∑—É–π –∞–±—Å—Ç—Ä–∞–∫—Ç–Ω—ã–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è —Ç–∏–ø–∞ "–Ω–∞–ø–∏—à–∏—Ç–µ —Ç—Ä–∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è" –∏–ª–∏ "–ø–µ—Ä–µ—á–∏—Å–ª–∏—Ç–µ –ø—Ä–∏–∑–Ω–∞–∫–∏". –°–¥–µ–ª–∞–π —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º–∏ –∏ –ø–æ–ª–µ–∑–Ω—ã–º–∏ –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –∑–Ω–∞–Ω–∏–π –Ω–∞ –ø—Ä–∞–∫—Ç–∏–∫–µ.

## –¢–∏–ø–∏—á–Ω—ã–µ –æ—à–∏–±–∫–∏ –∏ –∫–∞–∫ –∏—Ö –∏–∑–±–µ–∂–∞—Ç—å

## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã

–ò—Å–ø–æ–ª—å–∑—É–π markdown —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ. –ö–æ–Ω—Ç–µ–Ω—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –ø–æ–¥—Ä–æ–±–Ω—ã–º, –ø–æ–Ω—è—Ç–Ω—ã–º –∏ –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–º –ø–æ–¥ —É—Ä–æ–≤–µ–Ω—å —É—á–µ–Ω–∏–∫–∞.

–ï—Å–ª–∏ —Ç–µ–º–∞ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –≤–∏–∑—É–∞–ª—å–Ω–æ–≥–æ –æ–±—ä—è—Å–Ω–µ–Ω–∏—è, –≤—Å—Ç–∞–≤–ª—è–π –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è, —Ç–∞–±–ª–∏—Ü—ã –∏ –¥–∏–∞–≥—Ä–∞–º–º—ã –Ω–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ –≤ —Ç–µ–∫—Å—Ç —Å –ø–æ–º–æ—â—å—é —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã—Ö –º–∞—Ä–∫–µ—Ä–æ–≤:

**–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è:**
- –ú–∞—Ä–∫–µ—Ä: **[IMAGE: –æ–ø–∏—Å–∞–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è]**
- –î–ª—è —Å—Ö–µ–º, —á–µ—Ä—Ç–µ–∂–µ–π, –∏–ª–ª—é—Å—Ç—Ä–∞—Ü–∏–π –≤–Ω–µ—à–Ω–µ–≥–æ –≤–∏–¥–∞

**–¢–∞–±–ª–∏—Ü—ã:**
- –ú–∞—Ä–∫–µ—Ä: **[TABLE: –∑–∞–≥–æ–ª–æ–≤–æ–∫ —Ç–∞–±–ª–∏—Ü—ã | –∫–æ–ª–æ–Ω–∫–∞1,–∫–æ–ª–æ–Ω–∫–∞2,–∫–æ–ª–æ–Ω–∫–∞3 | —Å—Ç—Ä–æ–∫–∞1_–∑–Ω–∞—á1,—Å—Ç—Ä–æ–∫–∞1_–∑–Ω–∞—á2,—Å—Ç—Ä–æ–∫–∞1_–∑–Ω–∞—á3 | —Å—Ç—Ä–æ–∫–∞2_–∑–Ω–∞—á1,...]**
- –î–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö, —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫, —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–π

**–î–∏–∞–≥—Ä–∞–º–º—ã:**
- –ú–∞—Ä–∫–µ—Ä: **[CHART: —Ç–∏–ø_–¥–∏–∞–≥—Ä–∞–º–º—ã | –∑–∞–≥–æ–ª–æ–≤–æ–∫ | –º–µ—Ç–∫–∏_—á–µ—Ä–µ–∑_–∑–∞–ø—è—Ç—É—é | –∑–Ω–∞—á–µ–Ω–∏—è_—á–µ—Ä–µ–∑_–∑–∞–ø—è—Ç—É—é]**
- –¢–∏–ø—ã: bar, line, pie, doughnut
- –î–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö, —Ç—Ä–µ–Ω–¥–æ–≤, —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–π

–ü—Ä–∏–º–µ—Ä—ã:
- –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ: **[IMAGE: –¥–∏–∞–≥—Ä–∞–º–º–∞ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –Ω–∞—É—à–Ω–∏–∫–æ–≤]**
- –¢–∞–±–ª–∏—Ü–∞: **[TABLE: –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –ø—Ä–æ–≤–æ–¥–æ–≤ | –ú–∞—Ç–µ—Ä–∏–∞–ª,–ü—Ä–æ—á–Ω–æ—Å—Ç—å,–¶–µ–Ω–∞ | –ú–µ–¥—å,–í—ã—Å–æ–∫–∞—è,–î–æ—Ä–æ–≥–æ | –ê–ª—é–º–∏–Ω–∏–π,–°—Ä–µ–¥–Ω—è—è,–î–µ—à–µ–≤–æ]**
- –î–∏–∞–≥—Ä–∞–º–º–∞: **[CHART: bar | –ü–æ–ø—É–ª—è—Ä–Ω–æ—Å—Ç—å —Ç–∏–ø–æ–≤ –Ω–∞—É—à–Ω–∏–∫–æ–≤ | –ë–µ—Å–ø—Ä–æ–≤–æ–¥–Ω—ã–µ,–ü—Ä–æ–≤–æ–¥–Ω—ã–µ,–°–ø–æ—Ä—Ç–∏–≤–Ω—ã–µ | 65,25,10]**

–í–µ—Ä–Ω–∏ –æ—Ç–≤–µ—Ç –≤ —Ñ–æ—Ä–º–∞—Ç–µ JSON:
{
  "title": "–ù–∞–∑–≤–∞–Ω–∏–µ —É—Ä–æ–∫–∞",
  "theory": "–ü–æ–ª–Ω—ã–π —Ç–µ–∫—Å—Ç —Ç–µ–æ—Ä–∏–∏ –≤ markdown —Å –º–∞—Ä–∫–µ—Ä–∞–º–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π",
  "examples": ["–º–∞—Å—Å–∏–≤ –ø—Ä–∏–º–µ—Ä–æ–≤ –∏ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π –ø–æ —Ç–µ–º–µ"]
}
`;

      const response = await fetch('https://api.openai.com/v1/chat/completions', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          'Authorization': `Bearer ${import.meta.env.VITE_OPENAI_API_KEY}`,
        },
        body: JSON.stringify({
          model: 'gpt-4o-mini',
          messages: [
            {
              role: 'system',
              content: `–¢—ã - –æ–ø—ã—Ç–Ω—ã–π –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—å ${courseName}. –°–æ–∑–¥–∞–≤–∞–π –ø–æ–¥—Ä–æ–±–Ω—ã–µ, –ø–æ–Ω—è—Ç–Ω—ã–µ —É—Ä–æ–∫–∏ —Å –º–Ω–æ–∂–µ—Å—Ç–≤–æ–º –ø—Ä–∏–º–µ—Ä–æ–≤ –∏ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π. –°—Ç—Ä–æ–≥–æ –ø—Ä–∏–¥–µ—Ä–∂–∏–≤–∞–π—Å—è —Ç–µ–º—ã "${topic}" –∏ –Ω–µ –¥–æ–±–∞–≤–ª—è–π –∫–æ–Ω—Ç–µ–Ω—Ç –∏–∑ –¥—Ä—É–≥–∏—Ö –ø—Ä–µ–¥–º–µ—Ç–æ–≤.

${topic.toLowerCase().includes('—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ') || topic.toLowerCase().includes('—Ç–µ—Å—Ç') || topic.toLowerCase().includes('–∫–æ–Ω—Ç—Ä–æ–ª—å') ?
'–í–ê–ñ–ù–û: –î–ª—è —Ç–µ–º, —Å–≤—è–∑–∞–Ω–Ω—ã—Ö —Å —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º, —Å–æ–∑–¥–∞–≤–∞–π –ù–ï –æ–ø–∏—Å–∞–Ω–∏–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è, –∞ –°–ê–ú –ü–†–ê–ö–¢–ò–ß–ï–°–ö–ò–ô –¢–ï–°–¢! –í —É—Ä–æ–∫–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —Ä–µ–∞–ª—å–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã —Ç–µ—Å—Ç–∞ —Å –≤–∞—Ä–∏–∞–Ω—Ç–∞–º–∏ –æ—Ç–≤–µ—Ç–æ–≤, –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–º–∏ –∑–∞–¥–∞–Ω–∏—è–º–∏ –∏ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è–º–∏ –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è. –ù–µ –æ–ø–∏—Å—ã–≤–∞–π —Ç–µ–æ—Ä–∏—é —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è, –∞ —Å–æ–∑–¥–∞–≤–∞–π –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π —Ç–µ—Å—Ç –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∑–Ω–∞–Ω–∏–π.' :
'–î–ª—è –æ–±—ã—á–Ω—ã—Ö —É—á–µ–±–Ω—ã—Ö —Ç–µ–º —Å–æ–∑–¥–∞–≤–∞–π –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–µ —É—Ä–æ–∫–∏ —Å —Ç–µ–æ—Ä–∏–µ–π, –ø—Ä–∏–º–µ—Ä–∞–º–∏ –∏ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è–º–∏.'}

–§–æ—Ä–º–∞—Ç —É—Ä–æ–∫–∞ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –ø–æ–Ω—è—Ç–Ω—ã–º –∏ –≤–∫–ª—é—á–∞—Ç—å –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã –¥–ª—è –æ–±—É—á–µ–Ω–∏—è.`,
            },
            {
              role: 'user',
              content: prompt,
            },
          ],
          max_tokens: 15000,
          temperature: 0.7,
        }),
      });

      if (!response.ok) {
        throw new Error('Failed to generate lesson content');
      }

      const data = await response.json();
      const generatedContent = JSON.parse(data.choices[0].message.content.replace(/```json\n?|\n?```/g, ''));

      // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ localStorage –¥–ª—è –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è
      const cacheKey = `lesson_${lessonKey}_${user?.id || 'guest'}`;
      localStorage.setItem(cacheKey, JSON.stringify({
        ...generatedContent,
        generatedAt: Date.now(),
        userLevel,
        weakTopics
      }));

      return generatedContent;
    } catch (error) {
      console.error('Error generating lesson content:', error);
      // –í–æ–∑–≤—Ä–∞—â–∞–µ–º –±–∞–∑–æ–≤—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç –≤ —Å–ª—É—á–∞–µ –æ—à–∏–±–∫–∏
      return baseLesson;
    }
  };

  // –ó–∞–≥—Ä—É–∑–∫–∞ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ —É—Ä–æ–∫–∞
  useEffect(() => {
    const loadLessonContent = async () => {
      setIsGeneratingContent(true);

      try {
        const cacheKey = `lesson_${lessonKey}_${user?.id || 'guest'}`;
        const cachedData = localStorage.getItem(cacheKey);

        if (cachedData) {
          const parsedCache = JSON.parse(cachedData);
          const cacheAge = Date.now() - parsedCache.generatedAt;
          const isCacheFresh = cacheAge < 24 * 60 * 60 * 1000; // 24 —á–∞—Å–∞

          // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —Å–æ–≤–ø–∞–¥–∞—é—Ç –ª–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
          const userLevel = user?.knowledgeLevel || 'beginner';
          const weakTopics = user?.assessmentResult?.weakTopics || [];

          const paramsMatch = parsedCache.userLevel === userLevel &&
                            JSON.stringify(parsedCache.weakTopics) === JSON.stringify(weakTopics);

          if (isCacheFresh && paramsMatch) {
            setLessonData(parsedCache);
            setIsGeneratingContent(false);
            return;
          }
        }

        // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –Ω–æ–≤—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç
        const generatedContent = await generateLessonContent(
          lessonTopic,
          user?.knowledgeLevel || 'beginner',
          user?.assessmentResult?.weakTopics || []
        );

        setLessonData(generatedContent);
      } catch (error) {
        console.error('Error loading lesson content:', error);
        // –í —Å–ª—É—á–∞–µ –æ—à–∏–±–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–µ–º –±–∞–∑–æ–≤—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç, –µ—Å–ª–∏ –æ–Ω —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
        if (baseLesson) {
          setLessonData(baseLesson);
        } else {
          // –ï—Å–ª–∏ –±–∞–∑–æ–≤–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –Ω–µ—Ç, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ
          setLessonData({
            title: lessonTopic,
            theory: `# ${lessonTopic}\n\n–ò–∑–≤–∏–Ω–∏—Ç–µ, –ø—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ —É—Ä–æ–∫–∞. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É.`,
            examples: []
          });
        }
      } finally {
        setIsGeneratingContent(false);
      }
    };

    loadLessonContent();
  }, [lessonKey, user?.id, user?.knowledgeLevel, user?.assessmentResult?.weakTopics, lessonTopic, navigate]);

  // –ï—Å–ª–∏ –∫–æ–Ω—Ç–µ–Ω—Ç –µ—â–µ –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –±–∞–∑–æ–≤—ã–π –∏–ª–∏ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º—ã–π
  const currentLesson = lessonData || baseLesson || {
    title: lessonTopic,
    theory: `# ${lessonTopic}\n\n–ó–∞–≥—Ä—É–∂–∞–µ–º –∫–æ–Ω—Ç–µ–Ω—Ç —É—Ä–æ–∫–∞...`,
    examples: []
  };

  // Static AI avatar position
  useEffect(() => {
    // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—É—é –ø–æ–∑–∏—Ü–∏—é –¥–ª—è –∞–≤–∞—Ç–∞—Ä–∞
    setAiAvatarPosition(50); // –¶–µ–Ω—Ç—Ä —ç–∫—Ä–∞–Ω–∞
  }, []);

  // Track lesson start time
  useEffect(() => {
    setLessonStartTime(new Date());
  }, [courseId, moduleId, lessonId]);

  // Track study time when leaving the lesson
  useEffect(() => {
    return () => {
      if (lessonStartTime && updatePerformanceMetrics) {
        const studyTimeMinutes = Math.round((new Date().getTime() - lessonStartTime.getTime()) / (1000 * 60));
        if (studyTimeMinutes > 0) {
          updatePerformanceMetrics({
            totalStudyTime: studyTimeMinutes
          });

          // Check for time-based achievements
          if (updateAchievementProgress) {
            if (studyTimeMinutes >= 10) {
              updateAchievementProgress('dedicated-student', studyTimeMinutes);
            }
            if (studyTimeMinutes >= 50) {
              updateAchievementProgress('marathon-runner', studyTimeMinutes);
            }
            if (studyTimeMinutes >= 100) {
              updateAchievementProgress('centurion', studyTimeMinutes);
            }
          }
        }
      }
    };
  }, [lessonStartTime, updatePerformanceMetrics, updateAchievementProgress]);

  // –ê–≤–∞—Ç–∞—Ä –Ω–µ–ø–æ–¥–≤–∏–∂–µ–Ω
  useEffect(() => {
    // –ê–≤–∞—Ç–∞—Ä –æ—Å—Ç–∞–µ—Ç—Å—è –≤ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –ø–æ–∑–∏—Ü–∏–∏
  }, []);

  // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∑–∞–ø—É—Å–∫ –≥–æ–ª–æ—Å–æ–≤–æ–≥–æ —á–∞—Ç–∞
  useEffect(() => {
    if (showChat && autoStartVoice && !isVoiceChatActive) {
      startLessonVoiceChat();
    }
  }, [showChat, autoStartVoice]);

  // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ–∑–≤—É—á–∫–∞ —É—Ä–æ–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
  useEffect(() => {
    if (currentLesson.theory && !isGeneratingContent && !isLessonPlaying) {
      // –û–∑–≤—É—á–∏–≤–∞–µ–º —É—Ä–æ–∫ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –ø–µ—Ä–≤–æ–π –∑–∞–≥—Ä—É–∑–∫–µ
      speakLesson();
    }
  }, [currentLesson.theory, isGeneratingContent]);

  // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–∑–≤—É—á–∫–∏ —É—Ä–æ–∫–∞
  const speakLesson = async () => {
    if (!currentLesson.theory || isLessonPlaying) return;

    try {
      setIsLessonPlaying(true);

      // –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º markdown –≤ —á–∏—Ç–∞–µ–º—ã–π —Ç–µ–∫—Å—Ç
      const cleanText = currentLesson.theory
        .replace(/#{1,6}\s+/g, '') // –£–±–∏—Ä–∞–µ–º –∑–∞–≥–æ–ª–æ–≤–∫–∏ markdown
        .replace(/\*\*(.*?)\*\*/g, '$1') // –£–±–∏—Ä–∞–µ–º –∂–∏—Ä–Ω—ã–π —Ç–µ–∫—Å—Ç
        .replace(/\*(.*?)\*/g, '$1') // –£–±–∏—Ä–∞–µ–º –∫—É—Ä—Å–∏–≤
        .replace(/```[\s\S]*?```/g, '') // –£–±–∏—Ä–∞–µ–º –∫–æ–¥–æ–≤—ã–µ –±–ª–æ–∫–∏
        .replace(/`([^`]+)`/g, '$1') // –£–±–∏—Ä–∞–µ–º –∏–Ω–ª–∞–π–Ω–æ–≤—ã–π –∫–æ–¥
        .replace(/!\[.*?\]\(.*?\)/g, '') // –£–±–∏—Ä–∞–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
        .replace(/\[.*?\]\(.*?\)/g, '') // –£–±–∏—Ä–∞–µ–º —Å—Å—ã–ª–∫–∏
        .replace(/\n+/g, ' ') // –ó–∞–º–µ–Ω—è–µ–º –ø–µ—Ä–µ–Ω–æ—Å—ã —Å—Ç—Ä–æ–∫ –Ω–∞ –ø—Ä–æ–±–µ–ª—ã
        .replace(/\s+/g, ' ') // –£–±–∏—Ä–∞–µ–º –ª–∏—à–Ω–∏–µ –ø—Ä–æ–±–µ–ª—ã
        .trim();

      if (cleanText.length > 50) { // –û–∑–≤—É—á–∏–≤–∞–µ–º —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ —Ç–µ–∫—Å—Ç –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–ª–∏–Ω–Ω—ã–π
        await OpenAITTS.speakText(cleanText, {
          voice: 'alloy', // alloy - —Ö–æ—Ä–æ—à–∏–π –Ω–µ–π—Ç—Ä–∞–ª—å–Ω—ã–π –≥–æ–ª–æ—Å –¥–ª—è –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
          speed: 1.0
        });
      }
    } catch (error) {
      console.error('–û—à–∏–±–∫–∞ –æ–∑–≤—É—á–∫–∏ —É—Ä–æ–∫–∞:', error);
    } finally {
      setIsLessonPlaying(false);
    }
  };

  // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –≥–æ–ª–æ—Å–æ–≤–æ–≥–æ –æ–±—â–µ–Ω–∏—è –≤ —É—Ä–æ–∫–µ
  const startLessonVoiceChat = async () => {
    try {
      // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å—Ç–∞—Ç—É—Å –≥–æ–ª–æ—Å–æ–≤–æ–≥–æ —á–∞—Ç–∞
      setIsVoiceChatActive(true);
      ttsContinueRef.current = true;

      // –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –æ–∑–≤—É—á–∫—É —É—Ä–æ–∫–∞, –µ—Å–ª–∏ –æ–Ω–∞ –∞–∫—Ç–∏–≤–Ω–∞
      if (isLessonPlaying) {
        OpenAITTS.stop();
        setIsLessonPlaying(false);
      }

      // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º Speech Recognition
      const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
      if (!SpeechRecognition) {
        alert('–í–∞—à –±—Ä–∞—É–∑–µ—Ä –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ —Ä–µ—á–∏');
        return;
      }

      recognitionRef.current = new SpeechRecognition();
      recognitionRef.current.continuous = false;
      recognitionRef.current.interimResults = true;
      recognitionRef.current.lang = 'ru-RU'; // –†—É—Å—Å–∫–∏–π —è–∑—ã–∫

      let interimTranscript = '';
      let finalTranscript = '';
      let isProcessing = false;

      recognitionRef.current.onstart = () => {
        setIsListening(true);
        console.log('üé§ –†–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ —Ä–µ—á–∏ –∑–∞–ø—É—â–µ–Ω–æ –≤ —É—Ä–æ–∫–µ');
      };

      recognitionRef.current.onresult = async (event) => {
        interimTranscript = '';
        finalTranscript = '';

        for (let i = event.resultIndex; i < event.results.length; i++) {
          const transcript = event.results[i][0].transcript;
          if (event.results[i].isFinal) {
            finalTranscript += transcript;
          } else {
            interimTranscript += transcript;
          }
        }

        console.log('üé§ Interim:', interimTranscript);
        console.log('üé§ Final:', finalTranscript);

        if (finalTranscript.trim() && !isProcessing) {
          // –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º TTS –ø—Ä–∏ –Ω–æ–≤–æ–º —Å–æ–æ–±—â–µ–Ω–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
          OpenAITTS.stop();
          ttsContinueRef.current = false;

          isProcessing = true;
          setIsListening(false);

          try {
            // –°–æ–∑–¥–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            const userMessage: Message = {
              id: Date.now().toString(),
              role: 'user',
              content: finalTranscript.trim(),
              timestamp: new Date(),
            };

            setMessages(prev => [...prev, userMessage]);

            // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∑–∞–ø—Ä–æ—Å –∫ AI
            const response = await fetch('https://api.openai.com/v1/chat/completions', {
              method: 'POST',
              headers: {
                'Content-Type': 'application/json',
                'Authorization': `Bearer ${import.meta.env.VITE_OPENAI_API_KEY}`,
              },
              body: JSON.stringify({
                model: 'gpt-4o-mini',
                messages: [
                  {
                    role: 'system',
                    content: `–¢—ã - –æ–ø—ã—Ç–Ω—ã–π –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—å. –°—Ç—É–¥–µ–Ω—Ç –∏–∑—É—á–∞–µ—Ç —Ç–µ–º—É —É—Ä–æ–∫–∞: "${currentLesson.title}".

–ö–æ–Ω—Å–ø–µ–∫—Ç —É—Ä–æ–∫–∞:
${currentLesson.theory}

–¢–≤–æ—è –∑–∞–¥–∞—á–∞:
- –û—Ç–≤–µ—á–∞—Ç—å –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã —Å—Ç—É–¥–µ–Ω—Ç–∞ –ø–æ –º–∞—Ç–µ—Ä–∏–∞–ª—É —É—Ä–æ–∫–∞
- –û–±—ä—è—Å–Ω—è—Ç—å —Å–ª–æ–∂–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã –ø—Ä–æ—Å—Ç—ã–º–∏ —Å–ª–æ–≤–∞–º–∏
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–∏–º–µ—Ä—ã –∏–∑ –∫–æ–Ω—Å–ø–µ–∫—Ç–∞
- –ü–æ–æ—â—Ä—è—Ç—å –æ–±—É—á–µ–Ω–∏–µ –∏ –∑–∞–¥–∞–≤–∞—Ç—å –Ω–∞–≤–æ–¥—è—â–∏–µ –≤–æ–ø—Ä–æ—Å—ã
- –ë—ã—Ç—å —Ç–µ—Ä–ø–µ–ª–∏–≤—ã–º –∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—â–∏–º –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª–µ–º

–û—Ç–≤–µ—á–∞–π –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ –∏ —Å—Å—ã–ª–∞–π—Å—è –Ω–∞ –º–∞—Ç–µ—Ä–∏–∞–ª—ã —É—Ä–æ–∫–∞.`,
                  },
                  ...messages.slice(-10).map(msg => ({
                    role: msg.role,
                    content: msg.content,
                  })),
                  {
                    role: 'user',
                    content: finalTranscript.trim(),
                  },
                ],
                max_tokens: 800,
                temperature: 0.7,
              }),
            });

            if (!response.ok) {
              throw new Error('Failed to get response from OpenAI');
            }

            const data = await response.json();
            const assistantMessage: Message = {
              id: (Date.now() + 1).toString(),
              role: 'assistant',
              content: data.choices[0].message.content,
              timestamp: new Date(),
            };

            setMessages(prev => [...prev, assistantMessage]);

            // –û–∑–≤—É—á–∏–≤–∞–µ–º –æ—Ç–≤–µ—Ç
            if (ttsContinueRef.current) {
              await OpenAITTS.speakText(assistantMessage.content, {
                voice: 'alloy',
                speed: 1.0
              });
            }

          } catch (error) {
            console.error('–û—à–∏–±–∫–∞ –≤ –≥–æ–ª–æ—Å–æ–≤–æ–º –æ–±—â–µ–Ω–∏–∏:', error);
            const errorMessage: Message = {
              id: (Date.now() + 1).toString(),
              role: 'assistant',
              content: '–ò–∑–≤–∏–Ω–∏—Ç–µ, –ø—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –≤–∞—à–µ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è.',
              timestamp: new Date(),
            };
            setMessages(prev => [...prev, errorMessage]);
          } finally {
            isProcessing = false;
            // –ü—Ä–æ–¥–æ–ª–∂–∞–µ–º —Å–ª—É—à–∞—Ç—å —á–µ—Ä–µ–∑ –Ω–µ–±–æ–ª—å—à—É—é –ø–∞—É–∑—É
            setTimeout(() => {
              if (isVoiceChatActive && recognitionRef.current) {
                setIsListening(true);
                recognitionRef.current.start();
              }
            }, 1000);
          }
        }
      };

      recognitionRef.current.onerror = (event) => {
        console.error('–û—à–∏–±–∫–∞ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è —Ä–µ—á–∏:', event.error);
        setIsListening(false);
      };

      recognitionRef.current.onend = () => {
        setIsListening(false);
        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ–º, –µ—Å–ª–∏ –≥–æ–ª–æ—Å–æ–≤–æ–π —á–∞—Ç –∞–∫—Ç–∏–≤–µ–Ω
        if (isVoiceChatActive) {
          setTimeout(() => {
            if (recognitionRef.current) {
              recognitionRef.current.start();
            }
          }, 500);
        }
      };

      // –ó–∞–ø—É—Å–∫–∞–µ–º —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ
      recognitionRef.current.start();

    } catch (error) {
      console.error('–û—à–∏–±–∫–∞ –∑–∞–ø—É—Å–∫–∞ –≥–æ–ª–æ—Å–æ–≤–æ–≥–æ –æ–±—â–µ–Ω–∏—è:', error);
      alert('–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–ø—É—Å—Ç–∏—Ç—å –≥–æ–ª–æ—Å–æ–≤–æ–µ –æ–±—â–µ–Ω–∏–µ');
    }
  };

  // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –≥–æ–ª–æ—Å–æ–≤–æ–≥–æ —á–∞—Ç–∞
  const stopVoiceChat = () => {
    setIsVoiceChatActive(false);
    setIsListening(false);
    if (recognitionRef.current) {
      recognitionRef.current.stop();
    }
    OpenAITTS.stop();
    ttsContinueRef.current = false;
  };

  const sendMessage = async () => {
    if (!inputMessage.trim() || isLoading) return;

    // –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º TTS –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ –Ω–æ–≤–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è
    OpenAITTS.stop();
    ttsContinueRef.current = false;

    const userMessage: Message = {
      id: Date.now().toString(),
      role: 'user',
      content: inputMessage,
      timestamp: new Date(),
    };

    setMessages(prev => [...prev, userMessage]);
    setInputMessage('');
    setIsLoading(true);

    try {
      const response = await fetch('https://api.openai.com/v1/chat/completions', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          'Authorization': `Bearer ${import.meta.env.VITE_OPENAI_API_KEY}`,
        },
        body: JSON.stringify({
          model: 'gpt-4o-mini',
          messages: [
            {
              role: 'system',
              content: `–¢—ã - –æ–ø—ã—Ç–Ω—ã–π –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—å —Ä—É—Å—Å–∫–æ–≥–æ —è–∑—ã–∫–∞. –°—Ç—É–¥–µ–Ω—Ç –∏–∑—É—á–∞–µ—Ç —Ç–µ–º—É: "${currentLesson.title}".

–¢–≤–æ—è –∑–∞–¥–∞—á–∞:
- –û–±—ä—è—Å–Ω—è—Ç—å –º–∞—Ç–µ—Ä–∏–∞–ª –ø–æ —ç—Ç–æ–π —Ç–µ–º–µ –∏—Å–ø–æ–ª—å–∑—É—è –∫–æ–Ω—Å–ø–µ–∫—Ç —É—Ä–æ–∫–∞
- –û—Ç–≤–µ—á–∞—Ç—å –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã —Å—Ç—É–¥–µ–Ω—Ç–∞ –ø–æ –º–∞—Ç–µ—Ä–∏–∞–ª–∞–º —É—Ä–æ–∫–∞
- –î–∞–≤–∞—Ç—å –ø—Ä–∏–º–µ—Ä—ã –∏ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è –∏–∑ –∫–æ–Ω—Å–ø–µ–∫—Ç–∞
- –ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –æ—à–∏–±–∫–∏ –∏ –æ–±—ä—è—Å–Ω—è—Ç—å –Ω—é–∞–Ω—Å—ã
- –ü–æ–æ—â—Ä—è—Ç—å –æ–±—É—á–µ–Ω–∏–µ –∏ –∑–∞–¥–∞–≤–∞—Ç—å –Ω–∞–≤–æ–¥—è—â–∏–µ –≤–æ–ø—Ä–æ—Å—ã

–ü–û–õ–ù–´–ô –ö–û–ù–°–ü–ï–ö–¢ –£–†–û–ö–ê:
${currentLesson.theory}

–ü–†–ê–í–ò–õ–ê –†–ê–ë–û–¢–´:
- –í—Å–µ–≥–¥–∞ —Å—Å—ã–ª–∞–π—Å—è –Ω–∞ –º–∞—Ç–µ—Ä–∏–∞–ª—ã –∫–æ–Ω—Å–ø–µ–∫—Ç–∞
- –û–±—ä—è—Å–Ω—è–π —Å–ª–æ–∂–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã –ø—Ä–æ—Å—Ç—ã–º–∏ —Å–ª–æ–≤–∞–º–∏
- –ò—Å–ø–æ–ª—å–∑—É–π –ø—Ä–∏–º–µ—Ä—ã –∏–∑ –∫–æ–Ω—Å–ø–µ–∫—Ç–∞
- –ï—Å–ª–∏ —Å—Ç—É–¥–µ–Ω—Ç —Å–ø—Ä–∞—à–∏–≤–∞–µ—Ç –æ —á–µ–º-—Ç–æ –Ω–µ –∏–∑ –∫–æ–Ω—Å–ø–µ–∫—Ç–∞, –Ω–∞–ø—Ä–∞–≤—å –µ–≥–æ –∫ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–º—É –º–∞—Ç–µ—Ä–∏–∞–ª—É
- –ë—É–¥—å —Ç–µ—Ä–ø–µ–ª–∏–≤—ã–º, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—â–∏–º –∏ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–º –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª–µ–º
- –û—Ç–≤–µ—á–∞–π –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ`,
            },
            ...messages.map(msg => ({
              role: msg.role,
              content: msg.content,
            })),
            {
              role: 'user',
              content: userMessage.content,
            },
          ],
          max_tokens: 800,
          temperature: 0.7,
        }),
      });

      if (!response.ok) {
        throw new Error('Failed to get response from OpenAI');
      }

      const data = await response.json();
      const assistantMessage: Message = {
        id: (Date.now() + 1).toString(),
        role: 'assistant',
        content: data.choices[0].message.content,
        timestamp: new Date(),
      };

      setMessages(prev => [...prev, assistantMessage]);

      // Track achievement progress for AI questions
      if (updateAchievementProgress) {
        updateAchievementProgress('chatty-student', 1); // Increment by 1 for each question
        updateAchievementProgress('ai-disciple', 1); // Increment by 1 for each question
        updateAchievementProgress('question-asker', 1); // Increment by 1 for each question
      }
    } catch (error) {
      console.error('Error sending message:', error);
      const errorMessage: Message = {
        id: (Date.now() + 1).toString(),
        role: 'assistant',
        content: '–ò–∑–≤–∏–Ω–∏—Ç–µ, –ø—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –≤–∞—à–µ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â–µ —Ä–∞–∑.',
        timestamp: new Date(),
      };
      setMessages(prev => [...prev, errorMessage]);
    } finally {
      setIsLoading(false);
    }
  };

  const handleKeyPress = (e: React.KeyboardEvent) => {
    if (e.key === 'Enter' && !e.shiftKey) {
      e.preventDefault();
      sendMessage();
    }
  };

  // –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–æ—Å—Ç—É–ø –∫ —É—Ä–æ–∫—É
  const hasAccessToLesson = () => {
    if (!user) return false;
    if (!isValidParams) return false;

    // –î–ª—è –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∫—É—Ä—Å–æ–≤ –ø—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –∫—É—Ä—Å —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –∏ –∏–Ω–¥–µ–∫—Å—ã –≤–∞–ª–∏–¥–Ω—ã
    if (user.personalizedCourse && courseId === user.personalizedCourse.id) {
      return moduleIndex < user.personalizedCourse.modules.length &&
             lessonIndex < user.personalizedCourse.modules[moduleIndex].lessons.length;
    }

    // –î–ª—è —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö —É—Ä–æ–∫–æ–≤ (–µ—Å–ª–∏ –æ–Ω–∏ –µ—Å—Ç—å)
    return !!baseLesson;
  };

  if (!hasAccessToLesson()) {
    // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ–º –∫ –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–º—É –∫—É—Ä—Å—É —á–µ—Ä–µ–∑ 2 —Å–µ–∫—É–Ω–¥—ã
    setTimeout(() => {
      navigate('/personalized-course');
    }, 2000);

    return (
      <div className="min-h-screen bg-gradient-to-br from-background via-secondary/30 to-background flex items-center justify-center">
        <Card className="w-full max-w-md text-center">
          <CardContent className="p-8">
            <BookOpen className="w-12 h-12 mx-auto mb-4 text-muted-foreground" />
            <h2 className="text-xl font-semibold mb-2">–£—Ä–æ–∫ –Ω–µ –Ω–∞–π–¥–µ–Ω</h2>
            <p className="text-muted-foreground mb-4">
              –í–æ–∑–≤—Ä–∞—â–∞–µ–º—Å—è –∫ –∫—É—Ä—Å—É...
            </p>
          </CardContent>
        </Card>
      </div>
    );
  }

  // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏ –≤–æ –≤—Ä–µ–º—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
  if (isGeneratingContent) {
    return (
      <div className="min-h-screen bg-gradient-to-br from-background via-secondary/30 to-background flex items-center justify-center">
        <Card className="w-full max-w-md text-center">
          <CardContent className="p-8">
            <div className="flex items-center justify-center mb-4">
              <div className="animate-spin rounded-full h-12 w-12 border-b-2 border-primary"></div>
            </div>
            <h2 className="text-xl font-semibold mb-2">–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–æ–≥–æ —É—Ä–æ–∫–∞</h2>
            <p className="text-muted-foreground mb-4">
              AI –∞–¥–∞–ø—Ç–∏—Ä—É–µ—Ç –∫–æ–Ω—Ç–µ–Ω—Ç –ø–æ–¥ –≤–∞—à —É—Ä–æ–≤–µ–Ω—å –∏ —Å–ª–∞–±—ã–µ –º–µ—Å—Ç–∞...
            </p>
            <div className="w-full bg-secondary rounded-full h-2">
              <div className="bg-primary h-2 rounded-full animate-pulse" style={{ width: '60%' }} />
            </div>
          </CardContent>
        </Card>
      </div>
    );
  }

  return (
    <div className="min-h-screen bg-gradient-to-br from-background via-secondary/30 to-background">
      {/* Header */}
      <header className="border-b border-border/50 bg-card/50 backdrop-blur-sm">
        <div className="container mx-auto px-4 py-4">
          <div className="flex items-center justify-between">
            {/* Left side - Back button */}
            <div className="flex items-center gap-3">
              <Button
                variant="ghost"
                onClick={() => navigate('/personalized-course')}
                className="flex items-center gap-2"
              >
                <ArrowLeft className="w-4 h-4" />
                –ù–∞–∑–∞–¥ –∫ –∫—É—Ä—Å—É
              </Button>
            </div>

            {/* Center - Lesson title */}
            <div className="text-center">
              <h1 className="text-lg font-semibold">
                {lessonType === 'test' ? '–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π —Ç–µ—Å—Ç' : currentLesson.title}
              </h1>
              <p className="text-sm text-muted-foreground">
                {lessonType === 'test' ? '–ü—Ä–∞–∫—Ç–∏–∫–∞ –∏ –∑–∞–∫—Ä–µ–ø–ª–µ–Ω–∏–µ' : `–£—Ä–æ–∫ ${parseInt(lessonId || '0') + 1}`}
              </p>
            </div>

            {/* Right side - Actions */}
            <div className="flex items-center gap-2">
              <Button
                onClick={() => setShowChat(!showChat)}
                variant={showChat ? "default" : "outline"}
                size="sm"
              >
                <MessageCircle className="w-4 h-4 mr-2" />
                –û–±—â–µ–Ω–∏–µ
              </Button>
            </div>
          </div>
        </div>
      </header>

      {/* Main Content */}
      <div className="container mx-auto px-4 py-6">
        {lessonType === 'test' ? (
          <div>–¢–µ—Å—Ç –≤—Ä–µ–º–µ–Ω–Ω–æ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω</div>
        ) : (
          <div className="grid lg:grid-cols-2 gap-6">
            {/* Left Side - Theory */}
            <Card className="flex flex-col">
            <CardHeader>
              <CardTitle className="flex items-center justify-between">
                <div className="flex items-center gap-2">
                  <BookOpen className="w-5 h-5 text-primary" />
                  –¢–µ–æ—Ä–∏—è –∏ –ø—Ä–∏–º–µ—Ä—ã
                </div>
                <Button
                  variant="outline"
                  size="sm"
                  onClick={speakLesson}
                  disabled={isLessonPlaying}
                  className="flex items-center gap-2"
                >
                  <Volume2 className={`w-4 h-4 ${isLessonPlaying ? 'animate-pulse' : ''}`} />
                  {isLessonPlaying ? '–û–∑–≤—É—á–∫–∞...' : '–ü—Ä–æ—Å–ª—É—à–∞—Ç—å'}
                </Button>
              </CardTitle>
              <CardDescription>
                –ò–∑—É—á–∏—Ç–µ –º–∞—Ç–µ—Ä–∏–∞–ª —É—Ä–æ–∫–∞
              </CardDescription>
            </CardHeader>

            <CardContent className="flex-1 overflow-hidden">
              <ScrollArea className="h-[60vh] pr-4">
                {/* Theory Content */}
                <div className="prose prose-sm max-w-none mb-6">
                  <LessonContent content={formatLessonContent(currentLesson.theory)} generatedImages={generatedImages} />
                </div>

                {/* Examples */}
                {currentLesson.examples && currentLesson.examples.length > 0 && (
                  <div className="border-t pt-4">
                    <h4 className="font-semibold mb-3">–ü—Ä–∏–º–µ—Ä—ã:</h4>
                    <div className="space-y-2">
                      {currentLesson.examples.map((example: string, index: number) => (
                        <div key={index} className="flex items-start gap-2 p-3 bg-muted/50 rounded-lg">
                          <CheckCircle className="w-4 h-4 text-green-500 flex-shrink-0 mt-0.5" />
                          <span className="text-sm">{example}</span>
                        </div>
                      ))}
                    </div>
                  </div>
                )}


                {/* Progress Indicator */}
                <div className="border-t pt-4 mt-6">
                  <div className="flex items-center justify-between text-sm text-muted-foreground mb-2">
                    <span>–ü—Ä–æ–≥—Ä–µ—Å—Å —É—Ä–æ–∫–∞</span>
                    <span>75%</span>
                  </div>
                  <div className="w-full bg-secondary rounded-full h-2">
                    <div className="bg-primary h-2 rounded-full transition-all duration-300" style={{ width: '75%' }} />
                  </div>
                  <p className="text-xs text-muted-foreground mt-1">
                    –ú–∞—Ç–µ—Ä–∏–∞–ª –∏–∑—É—á–µ–Ω, –º–æ–∂–Ω–æ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç—å –∫ –ø—Ä–∞–∫—Ç–∏–∫–µ!
                  </p>
                </div>

                {/* Complete Lesson Button */}
                <div className="border-t pt-4 mt-6">
                  <div className="flex justify-center">
                    <Button
                      onClick={() => {
                        completeLesson(parseInt(moduleId || '0'), parseInt(lessonId || '0'));
                        navigate('/personalized-course');
                      }}
                      className="flex items-center gap-2"
                      size="lg"
                    >
                      <CheckCircle className="w-4 h-4" />
                      –ó–∞–≤–µ—Ä—à–∏—Ç—å —É—Ä–æ–∫
                    </Button>
                  </div>
                </div>
              </ScrollArea>
            </CardContent>
          </Card>

          {/* Right Side - Communication */}
          {showChat ? (
            <Card className="flex flex-col">
              <CardHeader>
                <CardTitle className="flex items-center gap-2">
                  <Brain className="w-5 h-5 text-primary" />
                  AI –ü—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—å
                </CardTitle>
                <CardDescription>
                  –ó–∞–¥–∞–≤–∞–π—Ç–µ –≤–æ–ø—Ä–æ—Å—ã –ø–æ —Ç–µ–º–µ "{currentLesson.title}"
                </CardDescription>
              </CardHeader>

              <CardContent className="flex-1 flex flex-col relative">

              {/* Messages Container with Sticky Input */}
              <div className="flex flex-col min-h-0">
                <ScrollArea ref={chatScrollRef} className="max-h-96 pr-4 pl-16">
                  <div className="space-y-4 pb-20">
                    {messages.length === 0 && (
                      <div className="text-center py-8 text-muted-foreground">
                        <MessageCircle className="w-12 h-12 mx-auto mb-4 text-primary/50" />
                      <p className="text-lg mb-2">–ì–æ—Ç–æ–≤ –ø–æ–º–æ—á—å —Å —É—Ä–æ–∫–æ–º!</p>
                      <p className="text-sm">–ó–∞–¥–∞–π—Ç–µ –≤–æ–ø—Ä–æ—Å –æ —Ç–µ–º–µ "{currentLesson.title}"</p>
                        <div className="mt-4 space-y-2 text-xs">
                          <p><strong>–ü—Ä–∏–º–µ—Ä—ã –≤–æ–ø—Ä–æ—Å–æ–≤:</strong></p>
                          <div className="space-y-1 text-left max-w-xs mx-auto">
                            <p>‚Ä¢ "–û–±—ä—è—Å–Ω–∏—Ç–µ —ç—Ç–æ—Ç –ø–∞–¥–µ–∂ –ø–æ–¥—Ä–æ–±–Ω–µ–µ"</p>
                            <p>‚Ä¢ "–î–∞–π—Ç–µ –±–æ–ª—å—à–µ –ø—Ä–∏–º–µ—Ä–æ–≤"</p>
                            <p>‚Ä¢ "–ö–∞–∫ –∑–∞–ø–æ–º–Ω–∏—Ç—å –æ–∫–æ–Ω—á–∞–Ω–∏—è?"</p>
                          </div>
                        </div>
                      </div>
                    )}

                    {messages.map((message) => (
                      <div
                        key={message.id}
                        className={`flex gap-3 ${message.role === 'user' ? 'justify-end pr-4' : 'justify-start'}`}
                      >
                        <div
                          className={`max-w-[80%] rounded-lg px-4 py-2 ${
                            message.role === 'user'
                              ? 'bg-primary text-primary-foreground'
                              : 'bg-muted'
                          }`}
                        >
                          <p className="whitespace-pre-wrap text-sm">{message.content}</p>
                          <p className="text-xs opacity-70 mt-1">
                            {message.timestamp.toLocaleTimeString()}
                          </p>
                        </div>
                      </div>
                    ))}

                    {isLoading && (
                      <div className="flex gap-3 justify-start">
                        <div className="bg-muted rounded-lg px-4 py-2">
                          <div className="flex items-center gap-2">
                            <div className="flex gap-1">
                              <div className="w-2 h-2 bg-primary/50 rounded-full animate-bounce" />
                              <div className="w-2 h-2 bg-primary/50 rounded-full animate-bounce" style={{ animationDelay: '0.1s' }} />
                              <div className="w-2 h-2 bg-primary/50 rounded-full animate-bounce" style={{ animationDelay: '0.2s' }} />
                            </div>
                            <span className="text-sm text-muted-foreground">–ü—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—å –¥—É–º–∞–µ—Ç...</span>
                          </div>
                        </div>
                      </div>
                    )}
                  </div>
                </ScrollArea>

                {/* Voice Chat Status */}
                {isVoiceChatActive && (
                  <div className="px-4 py-2 border-t bg-blue-50 dark:bg-blue-950/20">
                    <div className="flex items-center justify-between text-sm text-blue-700 dark:text-blue-300">
                      <div className="flex items-center gap-2">
                        {isListening ? (
                          <>
                            <Mic className="w-4 h-4 animate-pulse text-green-600" />
                            <span>üé§ –°–ª—É—à–∞—é - –≥–æ–≤–æ—Ä–∏—Ç–µ –≤–∞—à –≤–æ–ø—Ä–æ—Å...</span>
                          </>
                        ) : (
                          <>
                            <MessageCircle className="w-4 h-4 animate-pulse text-blue-600" />
                            <span>üí¨ –ì–æ–ª–æ—Å–æ–≤–æ–π —á–∞—Ç –∞–∫—Ç–∏–≤–µ–Ω</span>
                          </>
                        )}
                      </div>
                      <Button
                        onClick={stopVoiceChat}
                        variant="outline"
                        size="sm"
                        className="text-red-600 hover:text-red-700 hover:bg-red-50"
                      >
                        –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å
                      </Button>
                    </div>
                  </div>
                )}

                {/* Sticky Input at Bottom */}
                <div className="sticky bottom-0 bg-card border-t border-border/50 p-4 -mx-6 -mb-6 mt-4">
                  <div className="flex gap-2">
                    <Input
                      value={inputMessage}
                      onChange={(e) => setInputMessage(e.target.value)}
                      onKeyPress={handleKeyPress}
                      placeholder={`–°–ø—Ä–æ—Å–∏—Ç–µ –æ —Ç–µ–º–µ "${currentLesson.title}"...`}
                      disabled={isLoading}
                      className="flex-1"
                    />
                    <Button
                      onClick={sendMessage}
                      disabled={!inputMessage.trim() || isLoading}
                      size="icon"
                    >
                      <Send className="w-4 h-4" />
                    </Button>
                  </div>
                </div>
              </div>
            </CardContent>
          </Card>
          ) : (
            <div className="flex flex-col">
              <AnimatedSphere
                onStartChat={() => {
                  setAutoStartVoice(false);
                  setShowChat(true);
                }}
                onStartVoiceChat={() => {
                  setAutoStartVoice(true);
                  setShowChat(true);
                }}
              />
            </div>
          )}
        </div>
      </div>
    </div>
  );
};

export default Lesson;
